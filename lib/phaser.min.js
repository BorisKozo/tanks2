!function(n,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():n.Phaser=t()}(this,function(){function i(n){return[(n>>16&255)/255,(n>>8&255)/255,(n&255)/255]}function r(){return t.Matrix=typeof Float32Array!="undefined"?Float32Array:Array,t.Matrix}function i(n){return[(n>>16&255)/255,(n>>8&255)/255,(n&255)/255]}var t=t||{},n=n||{VERSION:"1.1.2",DEV_VERSION:"1.1.2",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,SPRITE:0,BUTTON:1,BULLET:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4};return t.InteractionManager=function(){},n.Utils={shuffle:function(n){for(var i,r,t=n.length-1;t>0;t--)i=Math.floor(Math.random()*(t+1)),r=n[t],n[t]=n[i],n[i]=r;return n},pad:function(n,t,i,r){var t,i,r,u,f;if(typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=" "),typeof r=="undefined"&&(r=3),t+1>=n.length)switch(r){case 1:n=Array(t+1-n.length).join(i)+n;break;case 3:u=Math.ceil((padlen=t-n.length)/2),f=padlen-u,n=Array(f+1).join(i)+n+Array(u+1).join(i);break;default:n=n+Array(t+1-n.length).join(i)}return n},isPlainObject:function(n){if(typeof n!="object"||n.nodeType||n===n.window)return!1;try{if(n.constructor&&!hasOwn.call(n.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},extend:function(){var e,f,r,i,o,s,t=arguments[0]||{},u=1,c=arguments.length,h=!1;for(typeof t=="boolean"&&(h=t,t=arguments[1]||{},u=2),c===u&&(t=this,--u);u<c;u++)if((e=arguments[u])!=null)for(f in e)(r=t[f],i=e[f],t!==i)&&(h&&i&&(n.Utils.isPlainObject(i)||(o=Array.isArray(i)))?(o?(o=!1,s=r&&Array.isArray(r)?r:[]):s=r&&n.Utils.isPlainObject(r)?r:{},t[f]=n.Utils.extend(h,s,i)):i!==undefined&&(t[f]=i));return t}},typeof Function.prototype.bind!="function"&&(Function.prototype.bind=function(){var n=Array.prototype.slice;return function(t){function r(){var u=f.concat(n.call(arguments));i.apply(this instanceof r?this:t,u)}var i=this,f=n.call(arguments,1);if(typeof i!="function")throw new TypeError;return r.prototype=function u(n){return n&&(u.prototype=n),(this instanceof u)?void 0:new u}(i.prototype),r}}()),r(),t.mat3={},t.mat3.create=function(){var n=new t.Matrix(9);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},t.mat3.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},t.mat4={},t.mat4.create=function(){var n=new t.Matrix(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},t.mat3.multiply=function(n,t,i){i||(i=n);var r=n[0],u=n[1],f=n[2],e=n[3],o=n[4],s=n[5],h=n[6],c=n[7],l=n[8],a=t[0],v=t[1],y=t[2],p=t[3],w=t[4],b=t[5],k=t[6],d=t[7],g=t[8];return i[0]=a*r+v*e+y*h,i[1]=a*u+v*o+y*c,i[2]=a*f+v*s+y*l,i[3]=p*r+w*e+b*h,i[4]=p*u+w*o+b*c,i[5]=p*f+w*s+b*l,i[6]=k*r+d*e+g*h,i[7]=k*u+d*o+g*c,i[8]=k*f+d*s+g*l,i},t.mat3.clone=function(n){var i=new t.Matrix(9);return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i},t.mat3.transpose=function(n,t){if(!t||n===t){var i=n[1],r=n[2],u=n[5];return n[1]=n[3],n[2]=n[6],n[3]=i,n[5]=n[7],n[6]=r,n[7]=u,n}return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],t},t.mat3.toMat4=function(n,i){return i||(i=t.mat4.create()),i[15]=1,i[14]=0,i[13]=0,i[12]=0,i[11]=0,i[10]=n[8],i[9]=n[7],i[8]=n[6],i[7]=0,i[6]=n[5],i[5]=n[4],i[4]=n[3],i[3]=0,i[2]=n[2],i[1]=n[1],i[0]=n[0],i},t.mat4.create=function(){var n=new t.Matrix(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},t.mat4.transpose=function(n,t){if(!t||n===t){var i=n[1],r=n[2],u=n[3],f=n[6],e=n[7],o=n[11];return n[1]=n[4],n[2]=n[8],n[3]=n[12],n[4]=i,n[6]=n[9],n[7]=n[13],n[8]=r,n[9]=f,n[11]=n[14],n[12]=u,n[13]=e,n[14]=o,n}return t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15],t},t.mat4.multiply=function(n,t,i){i||(i=n);var o=n[0],s=n[1],h=n[2],c=n[3],l=n[4],a=n[5],v=n[6],y=n[7],p=n[8],w=n[9],b=n[10],k=n[11],d=n[12],g=n[13],nt=n[14],tt=n[15],r=t[0],u=t[1],f=t[2],e=t[3];return i[0]=r*o+u*l+f*p+e*d,i[1]=r*s+u*a+f*w+e*g,i[2]=r*h+u*v+f*b+e*nt,i[3]=r*c+u*y+f*k+e*tt,r=t[4],u=t[5],f=t[6],e=t[7],i[4]=r*o+u*l+f*p+e*d,i[5]=r*s+u*a+f*w+e*g,i[6]=r*h+u*v+f*b+e*nt,i[7]=r*c+u*y+f*k+e*tt,r=t[8],u=t[9],f=t[10],e=t[11],i[8]=r*o+u*l+f*p+e*d,i[9]=r*s+u*a+f*w+e*g,i[10]=r*h+u*v+f*b+e*nt,i[11]=r*c+u*y+f*k+e*tt,r=t[12],u=t[13],f=t[14],e=t[15],i[12]=r*o+u*l+f*p+e*d,i[13]=r*s+u*a+f*w+e*g,i[14]=r*h+u*v+f*b+e*nt,i[15]=r*c+u*y+f*k+e*tt,i},t.Point=function(n,t){this.x=n||0,this.y=t||0},t.Point.prototype.clone=function(){return new t.Point(this.x,this.y)},t.Point.prototype.constructor=t.Point,t.Rectangle=function(n,t,i,r){this.x=n||0,this.y=t||0,this.width=i||0,this.height=r||0},t.Rectangle.prototype.clone=function(){return new t.Rectangle(this.x,this.y,this.width,this.height)},t.Rectangle.prototype.contains=function(n,t){var i,r;return this.width<=0||this.height<=0?!1:(i=this.x,n>=i&&n<=i+this.width&&(r=this.y,t>=r&&t<=r+this.height))?!0:!1},t.Rectangle.prototype.constructor=t.Rectangle,t.DisplayObject=function(){this.last=this,this.first=this,this.position=new t.Point,this.scale=new t.Point(1,1),this.pivot=new t.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.worldTransform=t.mat3.create(),this.localTransform=t.mat3.create(),this.color=[],this.dynamic=!0,this._sr=0,this._cr=1},t.DisplayObject.prototype.constructor=t.DisplayObject,t.DisplayObject.prototype.setInteractive=function(n){this.interactive=n},Object.defineProperty(t.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(n){this._interactive=n,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(t.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(n){this._mask=n,n?this.addFilter(n):this.removeFilter()}}),t.DisplayObject.prototype.addFilter=function(n){var u,f,e,o,i,r,s,h;if(!this.filter){this.filter=!0,u=new t.FilterBlock,f=new t.FilterBlock,u.mask=n,f.mask=n,u.first=u.last=this,f.first=f.last=this,u.open=!0,e=u,o=u,r=this.first._iPrev,r?(i=r._iNext,e._iPrev=r,r._iNext=e):i=this,i&&(i._iPrev=o,o._iNext=i);var e=f,o=f,i=null,r=null;for(r=this.last,i=r._iNext,i&&(i._iPrev=o,o._iNext=i),e._iPrev=r,r._iNext=e,s=this,h=this.last;s;)s.last==h&&(s.last=f),s=s.parent;this.first=u,this.__renderGroup&&this.__renderGroup.addFilterBlocks(u,f),n.renderable=!1}},t.DisplayObject.prototype.removeFilter=function(){var f,i,e;if(this.filter){this.filter=!1;var r=this.first,n=r._iNext,t=r._iPrev;n&&(n._iPrev=t),t&&(t._iNext=n),this.first=r._iNext;var u=this.last,n=u._iNext,t=u._iPrev;for(n&&(n._iPrev=t),t._iNext=n,f=u._iPrev,i=this;i.last==u;)if(i.last=f,i=i.parent,!i)break;e=r.mask,e.renderable=!0,this.__renderGroup&&this.__renderGroup.removeFilterBlocks(r,u)}},t.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var n=this.localTransform,i=this.parent.worldTransform,r=this.worldTransform;n[0]=this._cr*this.scale.x,n[1]=-this._sr*this.scale.y,n[3]=this._sr*this.scale.x,n[4]=this._cr*this.scale.y;var c=this.pivot.x,l=this.pivot.y,a=n[0],v=n[1],u=this.position.x-n[0]*c-l*n[1],y=n[3],p=n[4],f=this.position.y-n[4]*l-c*n[3],e=i[0],o=i[1],w=i[2],s=i[3],h=i[4],b=i[5];n[2]=u,n[5]=f,r[0]=e*a+o*y,r[1]=e*v+o*p,r[2]=e*u+o*f+w,r[3]=s*a+h*y,r[4]=s*v+h*p,r[5]=s*u+h*f+b,this.worldAlpha=this.alpha*this.parent.worldAlpha,this.vcount=t.visibleCount},t.visibleCount=0,t.DisplayObjectContainer=function(){t.DisplayObject.call(this),this.children=[]},t.DisplayObjectContainer.prototype=Object.create(t.DisplayObject.prototype),t.DisplayObjectContainer.prototype.constructor=t.DisplayObjectContainer,t.DisplayObjectContainer.prototype.addChild=function(n){var t,f,e,u,r,i,o;if(n.parent!=undefined&&n.parent.removeChild(n),n.parent=this,this.children.push(n),this.stage){t=n;do t.interactive&&(this.stage.dirty=!0),t.stage=this.stage,t=t._iNext;while(t)}for(f=n.first,e=n.last,r=this.filter?this.last._iPrev:this.last,u=r._iNext,i=this,o=r;i;)i.last==o&&(i.last=n.last),i=i.parent;u&&(u._iPrev=e,e._iNext=u),f._iPrev=r,r._iNext=f,this.__renderGroup&&(n.__renderGroup&&n.__renderGroup.removeDisplayObjectAndChildren(n),this.__renderGroup.addDisplayObjectAndChildren(n))},t.DisplayObjectContainer.prototype.addChildAt=function(n,t){var i,e,o,f,u,r,s;if(t>=0&&t<=this.children.length){if(n.parent!=undefined&&n.parent.removeChild(n),n.parent=this,this.stage){i=n;do i.interactive&&(this.stage.dirty=!0),i.stage=this.stage,i=i._iNext;while(i)}if(e=n.first,o=n.last,t==this.children.length)for(u=this.last,r=this,s=this.last;r;)r.last==s&&(r.last=n.last),r=r.parent;else u=t==0?this:this.children[t-1].last;f=u._iNext,f&&(f._iPrev=o,o._iNext=f),e._iPrev=u,u._iNext=e,this.children.splice(t,0,n),this.__renderGroup&&(n.__renderGroup&&n.__renderGroup.removeDisplayObjectAndChildren(n),this.__renderGroup.addDisplayObjectAndChildren(n))}else throw new Error(n+" The index "+t+" supplied is out of bounds "+this.children.length);},t.DisplayObjectContainer.prototype.swapChildren=function(){return},t.DisplayObjectContainer.prototype.getChildAt=function(n){if(n>=0&&n<this.children.length)return this.children[n];throw new Error(child+" Both the supplied DisplayObjects must be a child of the caller "+this);},t.DisplayObjectContainer.prototype.removeChild=function(n){var e=this.children.indexOf(n),s,t,i;if(e!==-1){var u=n.first,r=n.last,f=r._iNext,o=u._iPrev;if(f&&(f._iPrev=o),o._iNext=f,this.last==r)for(s=u._iPrev,t=this;t.last==r.last;)if(t.last=s,t=t.parent,!t)break;if(r._iNext=null,u._iPrev=null,this.stage){i=n;do i.interactive&&(this.stage.dirty=!0),i.stage=null,i=i._iNext;while(i)}n.__renderGroup&&n.__renderGroup.removeDisplayObjectAndChildren(n),n.parent=undefined,this.children.splice(e,1)}else throw new Error(n+" The supplied DisplayObject must be a child of the caller "+this);},t.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){t.DisplayObject.prototype.updateTransform.call(this);for(var n=0,i=this.children.length;n<i;n++)this.children[n].updateTransform()}},t.blendModes={},t.blendModes.NORMAL=0,t.blendModes.SCREEN=1,t.Sprite=function(n){t.DisplayObjectContainer.call(this),this.anchor=new t.Point,this.texture=n,this.blendMode=t.blendModes.NORMAL,this._width=0,this._height=0,n.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},t.Sprite.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Sprite.prototype.constructor=t.Sprite,Object.defineProperty(t.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(n){this.scale.x=n/this.texture.frame.width,this._width=n}}),Object.defineProperty(t.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(n){this.scale.y=n/this.texture.frame.height,this._height=n}}),t.Sprite.prototype.setTexture=function(n){this.texture.baseTexture!=n.baseTexture?(this.textureChange=!0,this.texture=n,this.__renderGroup&&this.__renderGroup.updateTexture(this)):this.texture=n,this.updateFrame=!0},t.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},t.Sprite.fromFrame=function(n){var i=t.TextureCache[n];if(!i)throw new Error("The frameId '"+n+"' does not exist in the texture cache"+this);return new t.Sprite(i)},t.Sprite.fromImage=function(n){var i=t.Texture.fromImage(n);return new t.Sprite(i)},t.Stage=function(n,i){t.DisplayObjectContainer.call(this),this.worldTransform=t.mat3.create(),this.interactive=i,this.interactionManager=new t.InteractionManager(this),this.dirty=!0,this.__childrenAdded=[],this.__childrenRemoved=[],this.stage=this,this.stage.hitArea=new t.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(n),this.worldVisible=!0},t.Stage.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Stage.prototype.constructor=t.Stage,t.Stage.prototype.updateTransform=function(){this.worldAlpha=1,this.vcount=t.visibleCount;for(var n=0,i=this.children.length;n<i;n++)this.children[n].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},t.Stage.prototype.setBackgroundColor=function(n){this.backgroundColor=n||0,this.backgroundColorSplit=i(this.backgroundColor);var t=this.backgroundColor.toString(16);t="000000".substr(0,6-t.length)+t,this.backgroundColorString="#"+t},t.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},t.CustomRenderable=function(){t.DisplayObject.call(this)},t.CustomRenderable.prototype=Object.create(t.DisplayObject.prototype),t.CustomRenderable.prototype.constructor=t.CustomRenderable,t.CustomRenderable.prototype.renderCanvas=function(){},t.CustomRenderable.prototype.initWebGL=function(){},t.CustomRenderable.prototype.renderWebGL=function(){},t.Strip=function(n,i,r){t.DisplayObjectContainer.call(this),this.texture=n,this.blendMode=t.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(u){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=i,this.height=r,n.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},t.Strip.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Strip.prototype.constructor=t.Strip,t.Strip.prototype.setTexture=function(n){this.texture=n,this.width=n.frame.width,this.height=n.frame.height,this.updateFrame=!0},t.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},t.Rope=function(n,i){t.Strip.call(this,n),this.points=i;try{this.verticies=new Float32Array(i.length*4),this.uvs=new Float32Array(i.length*4),this.colors=new Float32Array(i.length*2),this.indices=new Uint16Array(i.length*2)}catch(r){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()},t.Rope.prototype=Object.create(t.Strip.prototype),t.Rope.prototype.constructor=t.Rope,t.Rope.prototype.refresh=function(){var r=this.points,o,i;if(!(r.length<1)){var t=this.uvs,u=this.indices,f=this.colors,h=r[0],s=r[0];for(this.count-=.2,t[0]=0,t[1]=1,t[2]=0,t[3]=1,f[0]=1,f[1]=1,u[0]=0,u[1]=1,o=r.length,i=1;i<o;i++){var s=r[i],n=i*4,e=i/(o-1);i%2?(t[n]=e,t[n+1]=0,t[n+2]=e,t[n+3]=1):(t[n]=e,t[n+1]=0,t[n+2]=e,t[n+3]=1),n=i*2,f[n]=1,f[n+1]=1,n=i*2,u[n]=n,u[n+1]=n+1,h=s}}},t.Rope.prototype.updateTransform=function(){var f=this.points,h,u,i,e,c,l,a;if(!(f.length<1)){var r=this.verticies,o=f[0],s,n={x:0,y:0},i=f[0];for(this.count-=.2,r[0]=i.x+n.x,r[1]=i.y+n.y,r[2]=i.x-n.x,r[3]=i.y-n.y,h=f.length,u=1;u<h;u++)i=f[u],e=u*4,s=u<f.length-1?f[u+1]:i,n.y=-(s.x-o.x),n.x=s.y-o.y,c=(1-u/(h-1))*10,c>1&&(c=1),l=Math.sqrt(n.x*n.x+n.y*n.y),a=this.texture.height/2,n.x/=l,n.y/=l,n.x*=a,n.y*=a,r[e]=i.x+n.x,r[e+1]=i.y+n.y,r[e+2]=i.x-n.x,r[e+3]=i.y-n.y,o=i;t.DisplayObjectContainer.prototype.updateTransform.call(this)}},t.Rope.prototype.setTexture=function(n){this.texture=n,this.updateFrame=!0},t.TilingSprite=function(n,i,r){t.DisplayObjectContainer.call(this),this.texture=n,this.width=i,this.height=r,this.tileScale=new t.Point(1,1),this.tilePosition=new t.Point(0,0),this.renderable=!0,this.blendMode=t.blendModes.NORMAL},t.TilingSprite.prototype=Object.create(t.DisplayObjectContainer.prototype),t.TilingSprite.prototype.constructor=t.TilingSprite,t.TilingSprite.prototype.setTexture=function(n){this.texture=n,this.updateFrame=!0},t.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},t.FilterBlock=function(n){this.graphics=n,this.visible=!0,this.renderable=!0},t.MaskFilter=function(){this.graphics},t.Graphics=function(){t.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.currentPath={points:[]}},t.Graphics.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Graphics.prototype.constructor=t.Graphics,t.Graphics.prototype.lineStyle=function(n,i,r){this.currentPath.points.length==0&&this.graphicsData.pop(),this.lineWidth=n||0,this.lineColor=i||0,this.lineAlpha=r==undefined?1:r,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:t.Graphics.POLY},this.graphicsData.push(this.currentPath)},t.Graphics.prototype.moveTo=function(n,i){this.currentPath.points.length==0&&this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:t.Graphics.POLY},this.currentPath.points.push(n,i),this.graphicsData.push(this.currentPath)},t.Graphics.prototype.lineTo=function(n,t){this.currentPath.points.push(n,t),this.dirty=!0},t.Graphics.prototype.beginFill=function(n,t){this.filling=!0,this.fillColor=n||0,this.fillAlpha=t==undefined?1:t},t.Graphics.prototype.endFill=function(){this.filling=!1,this.fillColor=null,this.fillAlpha=1},t.Graphics.prototype.drawRect=function(n,i,r,u){this.currentPath.points.length==0&&this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[n,i,r,u],type:t.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0},t.Graphics.prototype.drawCircle=function(n,i,r){this.currentPath.points.length==0&&this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[n,i,r,r],type:t.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0},t.Graphics.prototype.drawElipse=function(n,i,r,u){this.currentPath.points.length==0&&this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[n,i,r,u],type:t.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0},t.Graphics.prototype.clear=function(){this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[]},t.Graphics.POLY=0,t.Graphics.RECT=1,t.Graphics.CIRC=2,t.Graphics.ELIP=3,t.CanvasGraphics=function(){},t.CanvasGraphics.renderGraphics=function(n,i){for(var f=n.worldAlpha,r,u,h,l=0;l<n.graphicsData.length;l++)if(r=n.graphicsData[l],u=r.points,i.strokeStyle=color="#"+("00000"+(r.lineColor|0).toString(16)).substr(-6),i.lineWidth=r.lineWidth,r.type==t.Graphics.POLY){for(i.beginPath(),i.moveTo(u[0],u[1]),h=1;h<u.length/2;h++)i.lineTo(u[h*2],u[h*2+1]);u[0]==u[u.length-2]&&u[1]==u[u.length-1]&&i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=color="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.stroke())}else if(r.type==t.Graphics.RECT)r.fillColor&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=color="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fillRect(u[0],u[1],u[2],u[3])),r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.strokeRect(u[0],u[1],u[2],u[3]));else if(r.type==t.Graphics.CIRC)i.beginPath(),i.arc(u[0],u[1],u[2],0,2*Math.PI),i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=color="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.stroke());else if(r.type==t.Graphics.ELIP){var a=r.points,v=a[2]*2,y=a[3]*2,o=a[0]-v/2,c=a[1]-y/2;i.beginPath();var d=.5522848,p=v/2*d,w=y/2*d,b=o+v,k=c+y,s=o+v/2,e=c+y/2;i.moveTo(o,e),i.bezierCurveTo(o,e-w,s-p,c,s,c),i.bezierCurveTo(s+p,c,b,e-w,b,e),i.bezierCurveTo(b,e+w,s+p,k,s,k),i.bezierCurveTo(s-p,k,o,e+w,o,e),i.closePath(),r.fill&&(i.globalAlpha=r.fillAlpha*f,i.fillStyle=color="#"+("00000"+(r.fillColor|0).toString(16)).substr(-6),i.fill()),r.lineWidth&&(i.globalAlpha=r.lineAlpha*f,i.stroke())}},t.CanvasGraphics.renderGraphicsMask=function(n,i){var g=n.worldAlpha,k=n.graphicsData.length,c,u,r,s;for(k>1&&(k=1,console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object")),c=0;c<1;c++)if(u=n.graphicsData[c],r=u.points,u.type==t.Graphics.POLY){for(i.beginPath(),i.moveTo(r[0],r[1]),s=1;s<r.length/2;s++)i.lineTo(r[s*2],r[s*2+1]);r[0]==r[r.length-2]&&r[1]==r[r.length-1]&&i.closePath()}else if(u.type==t.Graphics.RECT)i.beginPath(),i.rect(r[0],r[1],r[2],r[3]),i.closePath();else if(u.type==t.Graphics.CIRC)i.beginPath(),i.arc(r[0],r[1],r[2],0,2*Math.PI),i.closePath();else if(u.type==t.Graphics.ELIP){var l=u.points,a=l[2]*2,v=l[3]*2,e=l[0]-a/2,h=l[1]-v/2;i.beginPath();var d=.5522848,y=a/2*d,p=v/2*d,w=e+a,b=h+v,o=e+a/2,f=h+v/2;i.moveTo(e,f),i.bezierCurveTo(e,f-p,o-y,h,o,h),i.bezierCurveTo(o+y,h,w,f-p,w,f),i.bezierCurveTo(w,f+p,o+y,b,o,b),i.bezierCurveTo(o-y,b,e,f+p,e,f),i.closePath()}},t.CanvasRenderer=function(n,t,i,r){this.transparent=r,this.width=n||800,this.height=t||600,this.view=i||document.createElement("canvas"),this.context=this.view.getContext("2d"),this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0},t.CanvasRenderer.prototype.constructor=t.CanvasRenderer,t.CanvasRenderer.prototype.render=function(n){t.texturesToUpdate=[],t.texturesToDestroy=[],t.visibleCount++,n.updateTransform(),this.view.style.backgroundColor==n.backgroundColorString||this.transparent||(this.view.style.backgroundColor=n.backgroundColorString),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(n),n.interactive&&(n._interactiveEventsAdded||(n._interactiveEventsAdded=!0,n.interactionManager.setTarget(this))),t.Texture.frameUpdates.length>0&&(t.Texture.frameUpdates=[])},t.CanvasRenderer.prototype.resize=function(n,t){this.width=n,this.height=t,this.view.width=n,this.view.height=t},t.CanvasRenderer.prototype.renderDisplayObject=function(n){var i,r=this.context,e,u,o,f;r.globalCompositeOperation="source-over",e=n.last._iNext,n=n.first;do{if(i=n.worldTransform,!n.visible){n=n.last._iNext;continue}if(!n.renderable){n=n._iNext;continue}n instanceof t.Sprite?(u=n.texture.frame,u&&(r.globalAlpha=n.worldAlpha,r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),r.drawImage(n.texture.baseTexture.source,u.x,u.y,u.width,u.height,n.anchor.x*-u.width,n.anchor.y*-u.height,u.width,u.height))):n instanceof t.Strip?(r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),this.renderStrip(n)):n instanceof t.TilingSprite?(r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),this.renderTilingSprite(n)):n instanceof t.CustomRenderable?n.renderCanvas(this):n instanceof t.Graphics?(r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),t.CanvasGraphics.renderGraphics(n,r)):n instanceof t.FilterBlock&&(n.open?(r.save(),o=n.mask.alpha,f=n.mask.worldTransform,r.setTransform(f[0],f[3],f[1],f[4],f[2],f[5]),n.mask.worldAlpha=.5,r.worldAlpha=0,t.CanvasGraphics.renderGraphicsMask(n.mask,r),r.clip(),n.mask.worldAlpha=o):r.restore()),n=n._iNext}while(n!=e)},t.CanvasRenderer.prototype.renderStripFlat=function(n){var t=this.context,i=n.verticies,a=n.uvs,f=i.length/2,u;for(this.count++,t.beginPath(),u=1;u<f-2;u++){var r=u*2,e=i[r],o=i[r+2],s=i[r+4],h=i[r+1],c=i[r+3],l=i[r+5];t.moveTo(e,h),t.lineTo(o,c),t.lineTo(s,l)}t.fillStyle="#FF0000",t.fill(),t.closePath()},t.CanvasRenderer.prototype.renderTilingSprite=function(n){var t=this.context,i,r;t.globalAlpha=n.worldAlpha,n.__tilePattern||(n.__tilePattern=t.createPattern(n.texture.baseTexture.source,"repeat")),t.beginPath(),i=n.tilePosition,r=n.tileScale,t.scale(r.x,r.y),t.translate(i.x,i.y),t.fillStyle=n.__tilePattern,t.fillRect(-i.x,-i.y,n.width/r.x,n.height/r.y),t.scale(1/r.x,1/r.y),t.translate(-i.x,-i.y),t.closePath()},t.CanvasRenderer.prototype.renderStrip=function(n){var i=this.context,h=n.verticies,w=n.uvs,d=h.length/2,k;for(this.count++,k=1;k<d-2;k++){var t=k*2,c=h[t],l=h[t+2],a=h[t+4],v=h[t+1],y=h[t+3],p=h[t+5],r=w[t]*n.texture.width,u=w[t+2]*n.texture.width,f=w[t+4]*n.texture.width,e=w[t+1]*n.texture.height,o=w[t+3]*n.texture.height,s=w[t+5]*n.texture.height;i.save(),i.beginPath(),i.moveTo(c,v),i.lineTo(l,y),i.lineTo(a,p),i.closePath(),i.clip();var b=r*o+e*f+u*s-o*f-e*u-r*s,g=c*o+e*a+l*s-o*a-e*l-c*s,nt=r*l+c*f+u*a-l*f-c*u-r*a,tt=r*o*a+e*l*f+c*u*s-c*o*f-e*u*a-r*l*s,it=v*o+e*p+y*s-o*p-e*y-v*s,rt=r*y+v*f+u*p-y*f-v*u-r*p,ut=r*o*p+e*y*f+v*u*s-v*o*f-e*u*p-r*y*s;i.transform(g/b,it/b,nt/b,rt/b,tt/b,ut/b),i.drawImage(n.texture.baseTexture.source,0,0),i.restore()}},t._batchs=[],t._getBatch=function(n){return t._batchs.length==0?new t.WebGLBatch(n):t._batchs.pop()},t._returnBatch=function(n){n.clean(),t._batchs.push(n)},t._restoreBatchs=function(n){for(var i=0;i<t._batchs.length;i++)t._batchs[i].restoreLostContext(n)},t.WebGLBatch=function(n){this.gl=n,this.size=0,this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),this.uvBuffer=n.createBuffer(),this.colorBuffer=n.createBuffer(),this.blendMode=t.blendModes.NORMAL,this.dynamicSize=1},t.WebGLBatch.prototype.constructor=t.WebGLBatch,t.WebGLBatch.prototype.clean=function(){this.verticies=[],this.uvs=[],this.indices=[],this.colors=[],this.dynamicSize=1,this.texture=null,this.last=null,this.size=0,this.head,this.tail},t.WebGLBatch.prototype.restoreLostContext=function(n){this.gl=n,this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),this.uvBuffer=n.createBuffer(),this.colorBuffer=n.createBuffer()},t.WebGLBatch.prototype.init=function(n){n.batch=this,this.dirty=!0,this.blendMode=n.blendMode,this.texture=n.texture.baseTexture,this.head=n,this.tail=n,this.size=1,this.growBatch()},t.WebGLBatch.prototype.insertBefore=function(n,t){this.size++,n.batch=this,this.dirty=!0;var i=t.__prev;t.__prev=n,n.__next=t,i?(n.__prev=i,i.__next=n):this.head=n},t.WebGLBatch.prototype.insertAfter=function(n,t){this.size++,n.batch=this,this.dirty=!0;var i=t.__next;t.__next=n,n.__prev=t,i?(n.__next=i,i.__prev=n):this.tail=n},t.WebGLBatch.prototype.remove=function(n){if(this.size--,this.size==0){n.batch=null,n.__prev=null,n.__next=null;return}n.__prev?n.__prev.__next=n.__next:(this.head=n.__next,this.head.__prev=null),n.__next?n.__next.__prev=n.__prev:(this.tail=n.__prev,this.tail.__next=null),n.batch=null,n.__next=null,n.__prev=null,this.dirty=!0},t.WebGLBatch.prototype.split=function(n){var i,r;for(this.dirty=!0,i=new t.WebGLBatch(this.gl),i.init(n),i.texture=this.texture,i.tail=this.tail,this.tail=n.__prev,this.tail.__next=null,n.__prev=null,r=0;n;)r++,n.batch=i,n=n.__next;return i.size=r,this.size-=r,i},t.WebGLBatch.prototype.merge=function(n){this.dirty=!0,this.tail.__next=n.head,n.head.__prev=this.tail,this.size+=n.size,this.tail=n.tail;for(var t=n.head;t;)t.batch=this,t=t.__next},t.WebGLBatch.prototype.growBatch=function(){var n=this.gl,u,r,t,i;for(this.dynamicSize=this.size==1?1:this.size*1.5,this.verticies=new Float32Array(this.dynamicSize*8),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bufferData(n.ARRAY_BUFFER,this.verticies,n.DYNAMIC_DRAW),this.uvs=new Float32Array(this.dynamicSize*8),n.bindBuffer(n.ARRAY_BUFFER,this.uvBuffer),n.bufferData(n.ARRAY_BUFFER,this.uvs,n.DYNAMIC_DRAW),this.dirtyUVS=!0,this.colors=new Float32Array(this.dynamicSize*4),n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer),n.bufferData(n.ARRAY_BUFFER,this.colors,n.DYNAMIC_DRAW),this.dirtyColors=!0,this.indices=new Uint16Array(this.dynamicSize*6),u=this.indices.length/6,r=0;r<u;r++)t=r*6,i=r*4,this.indices[t+0]=i+0,this.indices[t+1]=i+1,this.indices[t+2]=i+2,this.indices[t+3]=i+0,this.indices[t+4]=i+2,this.indices[t+5]=i+3;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,this.indices,n.STATIC_DRAW)},t.WebGLBatch.prototype.refresh=function(){var o=this.gl,r,t,i;for(this.dynamicSize<this.size&&this.growBatch(),r=0,i=this.head;i;){t=r*8;var e=i.texture,n=e.frame,u=e.baseTexture.width,f=e.baseTexture.height;this.uvs[t+0]=n.x/u,this.uvs[t+1]=n.y/f,this.uvs[t+2]=(n.x+n.width)/u,this.uvs[t+3]=n.y/f,this.uvs[t+4]=(n.x+n.width)/u,this.uvs[t+5]=(n.y+n.height)/f,this.uvs[t+6]=n.x/u,this.uvs[t+7]=(n.y+n.height)/f,i.updateFrame=!1,colorIndex=r*4,this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=i.worldAlpha,i=i.__next,r++}this.dirtyUVS=!0,this.dirtyColors=!0},t.WebGLBatch.prototype.update=function(){for(var rt=this.gl,u,d,g,nt,tt,f,e,o,s,n,h,c,l,a,v,y,w=0,i=this.head,p;i;){if(i.vcount===t.visibleCount){if(d=i.texture.frame.width,g=i.texture.frame.height,nt=i.anchor.x,tt=i.anchor.y,f=d*(1-nt),e=d*-nt,o=g*(1-tt),s=g*-tt,n=w*8,u=i.worldTransform,h=u[0],c=u[3],l=u[1],a=u[4],v=u[2],y=u[5],this.verticies[n+0]=h*e+l*s+v,this.verticies[n+1]=a*s+c*e+y,this.verticies[n+2]=h*f+l*s+v,this.verticies[n+3]=a*s+c*f+y,this.verticies[n+4]=h*f+l*o+v,this.verticies[n+5]=a*o+c*f+y,this.verticies[n+6]=h*e+l*o+v,this.verticies[n+7]=a*o+c*e+y,i.updateFrame||i.texture.updateFrame){this.dirtyUVS=!0;var it=i.texture,r=it.frame,b=it.baseTexture.width,k=it.baseTexture.height;this.uvs[n+0]=r.x/b,this.uvs[n+1]=r.y/k,this.uvs[n+2]=(r.x+r.width)/b,this.uvs[n+3]=r.y/k,this.uvs[n+4]=(r.x+r.width)/b,this.uvs[n+5]=(r.y+r.height)/k,this.uvs[n+6]=r.x/b,this.uvs[n+7]=(r.y+r.height)/k,i.updateFrame=!1}i.cacheAlpha!=i.worldAlpha&&(i.cacheAlpha=i.worldAlpha,p=w*4,this.colors[p]=this.colors[p+1]=this.colors[p+2]=this.colors[p+3]=i.worldAlpha,this.dirtyColors=!0)}else n=w*8,this.verticies[n+0]=0,this.verticies[n+1]=0,this.verticies[n+2]=0,this.verticies[n+3]=0,this.verticies[n+4]=0,this.verticies[n+5]=0,this.verticies[n+6]=0,this.verticies[n+7]=0;w++,i=i.__next}},t.WebGLBatch.prototype.render=function(n,i){var r,u,f;(n=n||0,i==undefined&&(i=this.size),this.dirty&&(this.refresh(),this.dirty=!1),this.size!=0)&&(this.update(),r=this.gl,u=t.shaderProgram,r.useProgram(u),r.bindBuffer(r.ARRAY_BUFFER,this.vertexBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,this.verticies),r.vertexAttribPointer(u.vertexPositionAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.uvBuffer),this.dirtyUVS&&(this.dirtyUVS=!1,r.bufferSubData(r.ARRAY_BUFFER,0,this.uvs)),r.vertexAttribPointer(u.textureCoordAttribute,2,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.texture._glTexture),r.bindBuffer(r.ARRAY_BUFFER,this.colorBuffer),this.dirtyColors&&(this.dirtyColors=!1,r.bufferSubData(r.ARRAY_BUFFER,0,this.colors)),r.vertexAttribPointer(u.colorAttribute,1,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer),f=i-n,r.drawElements(r.TRIANGLES,f*6,r.UNSIGNED_SHORT,n*12))},t.WebGLGraphics=function(){},t.WebGLGraphics.renderGraphics=function(n,i){var r=t.gl,u;n._webGL||(n._webGL={points:[],indices:[],lastIndex:0,buffer:r.createBuffer(),indexBuffer:r.createBuffer()}),n.dirty&&(n.dirty=!1,n.clearDirty&&(n.clearDirty=!1,n._webGL.lastIndex=0,n._webGL.points=[],n._webGL.indices=[]),t.WebGLGraphics.updateGraphics(n)),t.activatePrimitiveShader(),u=t.mat3.clone(n.worldTransform),t.mat3.transpose(u),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.uniformMatrix3fv(t.primitiveProgram.translationMatrix,!1,u),r.uniform2f(t.primitiveProgram.projectionVector,i.x,i.y),r.uniform1f(t.primitiveProgram.alpha,n.worldAlpha),r.bindBuffer(r.ARRAY_BUFFER,n._webGL.buffer),r.vertexAttribPointer(t.shaderProgram.vertexPositionAttribute,2,r.FLOAT,!1,0,0),r.vertexAttribPointer(t.primitiveProgram.vertexPositionAttribute,2,r.FLOAT,!1,24,0),r.vertexAttribPointer(t.primitiveProgram.colorAttribute,4,r.FLOAT,!1,24,8),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n._webGL.indexBuffer),r.drawElements(r.TRIANGLE_STRIP,n._webGL.indices.length,r.UNSIGNED_SHORT,0),t.activateDefaultShader()},t.WebGLGraphics.updateGraphics=function(n){for(var i,r,u=n._webGL.lastIndex;u<n.graphicsData.length;u++)i=n.graphicsData[u],i.type==t.Graphics.POLY?(i.fill&&i.points.length>3&&t.WebGLGraphics.buildPoly(i,n._webGL),i.lineWidth>0&&t.WebGLGraphics.buildLine(i,n._webGL)):i.type==t.Graphics.RECT?t.WebGLGraphics.buildRectangle(i,n._webGL):(i.type==t.Graphics.CIRC||i.type==t.Graphics.ELIP)&&t.WebGLGraphics.buildCircle(i,n._webGL);n._webGL.lastIndex=n.graphicsData.length,r=t.gl,n._webGL.glPoints=new Float32Array(n._webGL.points),r.bindBuffer(r.ARRAY_BUFFER,n._webGL.buffer),r.bufferData(r.ARRAY_BUFFER,n._webGL.glPoints,r.STATIC_DRAW),n._webGL.glIndicies=new Uint16Array(n._webGL.indices),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n._webGL.indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,n._webGL.glIndicies,r.STATIC_DRAW)},t.WebGLGraphics.buildRectangle=function(n,r){var h=n.points,u=h[0],f=h[1],c=h[2],l=h[3];if(n.fill){var p=i(n.fillColor),o=n.fillAlpha,a=p[0]*o,v=p[1]*o,y=p[2]*o,e=r.points,w=r.indices,s=e.length/6;e.push(u,f),e.push(a,v,y,o),e.push(u+c,f),e.push(a,v,y,o),e.push(u,f+l),e.push(a,v,y,o),e.push(u+c,f+l),e.push(a,v,y,o),w.push(s,s,s+1,s+2,s+3,s+3)}n.lineWidth&&(n.points=[u,f,u+c,f,u+c,f+l,u,f+l,u,f],t.WebGLGraphics.buildLine(n,r))},t.WebGLGraphics.buildCircle=function(n,r){var e=n.points,h=e[0],c=e[1],p=e[2],w=e[3],l=40,o=Math.PI*2/l,u;if(n.fill){var a=i(n.fillColor),f=n.fillAlpha,b=a[0]*f,k=a[1]*f,d=a[2]*f,v=r.points,y=r.indices,s=v.length/6;for(y.push(s),u=0;u<l+1;u++)v.push(h,c,b,k,d,f),v.push(h+Math.sin(o*u)*p,c+Math.cos(o*u)*w,b,k,d,f),y.push(s++,s++);y.push(s-1)}if(n.lineWidth){for(n.points=[],u=0;u<l+1;u++)n.points.push(h+Math.sin(o*u)*p,c+Math.cos(o*u)*w);t.WebGLGraphics.buildLine(n,r)}},t.WebGLGraphics.buildLine=function(n,r){var u=n.points,rt,nt,st,ht,l;if(u.length!=0){rt=new t.Point(u[0],u[1]),nt=new t.Point(u[u.length-2],u[u.length-1]),rt.x==nt.x&&rt.y==nt.y&&(u.pop(),u.pop(),nt=new t.Point(u[u.length-2],u[u.length-1]),st=nt.x+(rt.x-nt.x)*.5,ht=nt.y+(rt.y-nt.y)*.5,u.unshift(st,ht),u.push(st,ht));var h=r.points,ct=r.indices,ut=u.length/2,dt=u.length,lt=h.length/6,v=n.lineWidth/2,at=i(n.lineColor),a=n.lineAlpha,k=at[0]*a,d=at[1]*a,g=at[2]*a,y,p,o,s,et,ot,f,e,w,b,tt,it,vt,yt,pt,wt,bt,kt,ft,gt,c;for(y=u[0],p=u[1],o=u[2],s=u[3],f=-(p-s),e=y-o,c=Math.sqrt(f*f+e*e),f/=c,e/=c,f*=v,e*=v,h.push(y-f,p-e,k,d,g,a),h.push(y+f,p+e,k,d,g,a),l=1;l<ut-1;l++)y=u[(l-1)*2],p=u[(l-1)*2+1],o=u[l*2],s=u[l*2+1],et=u[(l+1)*2],ot=u[(l+1)*2+1],f=-(p-s),e=y-o,c=Math.sqrt(f*f+e*e),f/=c,e/=c,f*=v,e*=v,w=-(s-ot),b=o-et,c=Math.sqrt(w*w+b*b),w/=c,b/=c,w*=v,b*=v,vt=-e+p-(-e+s),yt=-f+o-(-f+y),pt=(-f+y)*(-e+s)-(-f+o)*(-e+p),wt=-b+ot-(-b+s),bt=-w+o-(-w+et),kt=(-w+et)*(-b+s)-(-w+o)*(-b+ot),ft=vt*bt-wt*yt,ft==0&&(ft+=1),px=(yt*kt-bt*pt)/ft,py=(wt*pt-vt*kt)/ft,gt=(px-o)*(px-o)+(py-s)+(py-s),gt>19600?(tt=f-w,it=e-b,c=Math.sqrt(tt*tt+it*it),tt/=c,it/=c,tt*=v,it*=v,h.push(o-tt,s-it),h.push(k,d,g,a),h.push(o+tt,s+it),h.push(k,d,g,a),h.push(o-tt,s-it),h.push(k,d,g,a),dt++):(h.push(px,py),h.push(k,d,g,a),h.push(o-(px-o),s-(py-s)),h.push(k,d,g,a));for(y=u[(ut-2)*2],p=u[(ut-2)*2+1],o=u[(ut-1)*2],s=u[(ut-1)*2+1],f=-(p-s),e=y-o,c=Math.sqrt(f*f+e*e),f/=c,e/=c,f*=v,e*=v,h.push(o-f,s-e),h.push(k,d,g,a),h.push(o+f,s+e),h.push(k,d,g,a),ct.push(lt),l=0;l<dt;l++)ct.push(lt++);ct.push(lt-1)}},t.WebGLGraphics.buildPoly=function(n,r){var e=n.points,u;if(!(e.length<6)){var l=r.points,o=r.indices,a=e.length/2,c=i(n.fillColor),h=n.fillAlpha,v=c[0]*h,y=c[1]*h,p=c[2]*h,f=t.PolyK.Triangulate(e),s=l.length/6;for(u=0;u<f.length;u+=3)o.push(f[u]+s),o.push(f[u]+s),o.push(f[u+1]+s),o.push(f[u+2]+s),o.push(f[u+2]+s);for(u=0;u<a;u++)l.push(e[u*2],e[u*2+1],v,y,p,h)}},t._defaultFrame=new t.Rectangle(0,0,1,1),t.gl,t.WebGLRenderer=function(n,i,r,u,f){var o,e;this.transparent=!!u,this.width=n||800,this.height=i||600,this.view=r||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,o=this,this.view.addEventListener("webglcontextlost",function(n){o.handleContextLost(n)},!1),this.view.addEventListener("webglcontextrestored",function(n){o.handleContextRestored(n)},!1),this.batchs=[];try{t.gl=this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!!f,premultipliedAlpha:!1,stencil:!0})}catch(s){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this);}t.initPrimitiveShader(),t.initDefaultShader(),t.initDefaultStripShader(),t.activateDefaultShader(),e=this.gl,t.WebGLRenderer.gl=e,this.batch=new t.WebGLBatch(e),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.colorMask(!0,!0,!0,this.transparent),t.projection=new t.Point(400,300),this.resize(this.width,this.height),this.contextLost=!1,this.stageRenderGroup=new t.WebGLRenderGroup(this.gl)},t.WebGLRenderer.prototype.constructor=t.WebGLRenderer,t.WebGLRenderer.getBatch=function(){return t._batchs.length==0?new t.WebGLBatch(t.WebGLRenderer.gl):t._batchs.pop()},t.WebGLRenderer.returnBatch=function(n){n.clean(),t._batchs.push(n)},t.WebGLRenderer.prototype.render=function(n){var i,r;if(!this.contextLost&&(this.__stage!==n&&(this.__stage=n,this.stageRenderGroup.setRenderable(n)),t.WebGLRenderer.updateTextures(),t.visibleCount++,n.updateTransform(),i=this.gl,i.colorMask(!0,!0,!0,this.transparent),i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,null),i.clearColor(n.backgroundColorSplit[0],n.backgroundColorSplit[1],n.backgroundColorSplit[2],!this.transparent),i.clear(i.COLOR_BUFFER_BIT),this.stageRenderGroup.backgroundColor=n.backgroundColorSplit,this.stageRenderGroup.render(t.projection),n.interactive&&(n._interactiveEventsAdded||(n._interactiveEventsAdded=!0,n.interactionManager.setTarget(this))),t.Texture.frameUpdates.length>0)){for(r=0;r<t.Texture.frameUpdates.length;r++)t.Texture.frameUpdates[r].updateFrame=!1;t.Texture.frameUpdates=[]}},t.WebGLRenderer.updateTextures=function(){for(var n=0;n<t.texturesToUpdate.length;n++)t.WebGLRenderer.updateTexture(t.texturesToUpdate[n]);for(n=0;n<t.texturesToDestroy.length;n++)t.WebGLRenderer.destroyTexture(t.texturesToDestroy[n]);t.texturesToUpdate=[],t.texturesToDestroy=[]},t.WebGLRenderer.updateTexture=function(n){var i=t.gl;n._glTexture||(n._glTexture=i.createTexture()),n.hasLoaded&&(i.bindTexture(i.TEXTURE_2D,n._glTexture),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),n._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),i.bindTexture(i.TEXTURE_2D,null))},t.WebGLRenderer.destroyTexture=function(n){var i=t.gl;n._glTexture&&(n._glTexture=i.createTexture(),i.deleteTexture(i.TEXTURE_2D,n._glTexture))},t.WebGLRenderer.prototype.resize=function(n,i){this.width=n,this.height=i,this.view.width=n,this.view.height=i,this.gl.viewport(0,0,this.width,this.height),t.projection.x=this.width/2,t.projection.y=this.height/2},t.WebGLRenderer.prototype.handleContextLost=function(n){n.preventDefault(),this.contextLost=!0},t.WebGLRenderer.prototype.handleContextRestored=function(){var r,i,n;this.gl=this.view.getContext("experimental-webgl",{alpha:!0}),this.initShaders();for(r in t.TextureCache)i=t.TextureCache[r].baseTexture,i._glTexture=null,t.WebGLRenderer.updateTexture(i);for(n=0;n<this.batchs.length;n++)this.batchs[n].restoreLostContext(this.gl),this.batchs[n].dirty=!0;t._restoreBatchs(this.gl),this.contextLost=!1},t.WebGLRenderGroup=function(n){this.gl=n,this.root,this.backgroundColor,this.batchs=[],this.toRemove=[]},t.WebGLRenderGroup.prototype.constructor=t.WebGLRenderGroup,t.WebGLRenderGroup.prototype.setRenderable=function(n){this.root&&this.removeDisplayObjectAndChildren(this.root),n.worldVisible=n.visible,this.root=n,this.addDisplayObjectAndChildren(n)},t.WebGLRenderGroup.prototype.render=function(n){var i,r,u,f;for(t.WebGLRenderer.updateTextures(),i=this.gl,i.uniform2f(t.shaderProgram.projectionVector,n.x,n.y),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),u=0;u<this.batchs.length;u++){if(r=this.batchs[u],r instanceof t.WebGLBatch){this.batchs[u].render();continue}f=r.vcount===t.visibleCount,r instanceof t.TilingSprite?f&&this.renderTilingSprite(r,n):r instanceof t.Strip?f&&this.renderStrip(r,n):r instanceof t.Graphics?f&&r.renderable&&t.WebGLGraphics.renderGraphics(r,n):r instanceof t.FilterBlock&&(r.open?(i.enable(i.STENCIL_TEST),i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.ALWAYS,1,255),i.stencilOp(i.KEEP,i.KEEP,i.REPLACE),t.WebGLGraphics.renderGraphics(r.mask,n),i.colorMask(!0,!0,!0,!1),i.stencilFunc(i.NOTEQUAL,0,255),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)):i.disable(i.STENCIL_TEST))}},t.WebGLRenderGroup.prototype.handleFilter=function(){},t.WebGLRenderGroup.prototype.renderSpecific=function(n,i){var a,h,v,c,y,r,u,p,o,e,s,f,l;for(t.WebGLRenderer.updateTextures(),a=this.gl,a.uniform2f(t.shaderProgram.projectionVector,i.x,i.y),r=n.first;r._iNext;)if(r=r._iNext,r.renderable&&r.__renderGroup)break;if(u=r.batch,r instanceof t.Sprite)if(u=r.batch,f=u.head,p=f,f==r)h=0;else for(h=1;f.__next!=r;)h++,f=f.__next;else u=r;for(o=n,s=n;s.children.length>0;)s=s.children[s.children.length-1],s.renderable&&(o=s);if(o instanceof t.Sprite)if(e=o.batch,f=e.head,f==o)c=0;else for(c=1;f.__next!=o;)c++,f=f.__next;else e=o;if(u==e){u instanceof t.WebGLBatch?u.render(h,c+1):this.renderSpecial(u,i);return}for(v=this.batchs.indexOf(u),y=this.batchs.indexOf(e),u instanceof t.WebGLBatch?u.render(h):this.renderSpecial(u,i),l=v+1;l<y;l++)renderable=this.batchs[l],renderable instanceof t.WebGLBatch?this.batchs[l].render():this.renderSpecial(renderable,i);e instanceof t.WebGLBatch?e.render(0,c+1):this.renderSpecial(e,i)},t.WebGLRenderGroup.prototype.renderSpecial=function(n,i){var u=n.vcount===t.visibleCount,r;n instanceof t.TilingSprite?u&&this.renderTilingSprite(n,i):n instanceof t.Strip?u&&this.renderStrip(n,i):n instanceof t.CustomRenderable?u&&n.renderWebGL(this,i):n instanceof t.Graphics?u&&n.renderable&&t.WebGLGraphics.renderGraphics(n,i):n instanceof t.FilterBlock&&(r=t.gl,n.open?(r.enable(r.STENCIL_TEST),r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.ALWAYS,1,255),r.stencilOp(r.KEEP,r.KEEP,r.REPLACE),t.WebGLGraphics.renderGraphics(n.mask,i),r.colorMask(!0,!0,!0,!0),r.stencilFunc(r.NOTEQUAL,0,255),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)):r.disable(r.STENCIL_TEST))},t.WebGLRenderGroup.prototype.updateTexture=function(n){var t,i;for(this.removeObject(n),t=n.first;t!=this.root;)if(t=t._iPrev,t.renderable&&t.__renderGroup)break;for(i=n.last;i._iNext;)if(i=i._iNext,i.renderable&&i.__renderGroup)break;this.insertObject(n,t,i)},t.WebGLRenderGroup.prototype.addFilterBlocks=function(n,t){var i,r;for(n.__renderGroup=this,t.__renderGroup=this,i=n;i!=this.root;)if(i=i._iPrev,i.renderable&&i.__renderGroup)break;for(this.insertAfter(n,i),r=t;r!=this.root;)if(r=r._iPrev,r.renderable&&r.__renderGroup)break;this.insertAfter(t,r)},t.WebGLRenderGroup.prototype.removeFilterBlocks=function(n,t){this.removeObject(n),this.removeObject(t)},t.WebGLRenderGroup.prototype.addDisplayObjectAndChildren=function(n){var t,r,i,u;for(n.__renderGroup&&n.__renderGroup.removeDisplayObjectAndChildren(n),t=n.first;t!=this.root.first;)if(t=t._iPrev,t.renderable&&t.__renderGroup)break;for(r=n.last;r._iNext;)if(r=r._iNext,r.renderable&&r.__renderGroup)break;i=n.first,u=n.last._iNext;do i.__renderGroup=this,i.renderable&&(this.insertObject(i,t,r),t=i),i=i._iNext;while(i!=u)},t.WebGLRenderGroup.prototype.removeDisplayObjectAndChildren=function(n){if(n.__renderGroup==this){var t=n.last;do n.__renderGroup=null,n.renderable&&this.removeObject(n),n=n._iNext;while(n)}},t.WebGLRenderGroup.prototype.insertObject=function(n,i,r){var s=i,o=r,u,f,e,h;if(n instanceof t.Sprite){if(s instanceof t.Sprite){if(u=s.batch,u&&u.texture==n.texture.baseTexture&&u.blendMode==n.blendMode){u.insertAfter(n,s);return}}else u=s;if(o)if(o instanceof t.Sprite){if(f=o.batch,f){if(f.texture==n.texture.baseTexture&&f.blendMode==n.blendMode){f.insertBefore(n,o);return}if(f==u){var c=u.split(o),e=t.WebGLRenderer.getBatch(),h=this.batchs.indexOf(u);e.init(n),this.batchs.splice(h+1,0,e,c);return}}}else f=o;e=t.WebGLRenderer.getBatch(),e.init(n),u?(h=this.batchs.indexOf(u),this.batchs.splice(h+1,0,e)):this.batchs.push(e);return}n instanceof t.TilingSprite?this.initTilingSprite(n):n instanceof t.Strip?this.initStrip(n):n,this.insertAfter(n,s)},t.WebGLRenderGroup.prototype.insertAfter=function(n,i){var u,f,r;i instanceof t.Sprite?(u=i.batch,u?u.tail==i?(r=this.batchs.indexOf(u),this.batchs.splice(r+1,0,n)):(f=u.split(i.__next),r=this.batchs.indexOf(u),this.batchs.splice(r+1,0,n,f)):this.batchs.push(n)):(r=this.batchs.indexOf(i),this.batchs.splice(r+1,0,n))},t.WebGLRenderGroup.prototype.removeObject=function(n){var r,u,i;if(n instanceof t.Sprite){if(u=n.batch,!u)return;u.remove(n),u.size==0&&(r=u)}else r=n;if(r){if(i=this.batchs.indexOf(r),i==-1)return;if(i==0||i==this.batchs.length-1){this.batchs.splice(i,1),r instanceof t.WebGLBatch&&t.WebGLRenderer.returnBatch(r);return}if(this.batchs[i-1]instanceof t.WebGLBatch&&this.batchs[i+1]instanceof t.WebGLBatch&&this.batchs[i-1].texture==this.batchs[i+1].texture&&this.batchs[i-1].blendMode==this.batchs[i+1].blendMode){this.batchs[i-1].merge(this.batchs[i+1]),r instanceof t.WebGLBatch&&t.WebGLRenderer.returnBatch(r),t.WebGLRenderer.returnBatch(this.batchs[i+1]),this.batchs.splice(i,2);return}this.batchs.splice(i,1),r instanceof t.WebGLBatch&&t.WebGLRenderer.returnBatch(r)}},t.WebGLRenderGroup.prototype.initTilingSprite=function(n){var t=this.gl;n.verticies=new Float32Array([0,0,n.width,0,n.width,n.height,0,n.height]),n.uvs=new Float32Array([0,0,1,0,1,1,0,1]),n.colors=new Float32Array([1,1,1,1]),n.indices=new Uint16Array([0,1,3,2]),n._vertexBuffer=t.createBuffer(),n._indexBuffer=t.createBuffer(),n._uvBuffer=t.createBuffer(),n._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,n.verticies,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,n._uvBuffer),t.bufferData(t.ARRAY_BUFFER,n.uvs,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,n._colorBuffer),t.bufferData(t.ARRAY_BUFFER,n.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n.indices,t.STATIC_DRAW),n.texture.baseTexture._glTexture?(t.bindTexture(t.TEXTURE_2D,n.texture.baseTexture._glTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),n.texture.baseTexture._powerOf2=!0):n.texture.baseTexture._powerOf2=!0},t.WebGLRenderGroup.prototype.renderStrip=function(n,i){var r=this.gl,u=t.shaderProgram,f;r.useProgram(t.stripShaderProgram),f=t.mat3.clone(n.worldTransform),t.mat3.transpose(f),r.uniformMatrix3fv(t.stripShaderProgram.translationMatrix,!1,f),r.uniform2f(t.stripShaderProgram.projectionVector,i.x,i.y),r.uniform1f(t.stripShaderProgram.alpha,n.worldAlpha),n.dirty?(n.dirty=!1,r.bindBuffer(r.ARRAY_BUFFER,n._vertexBuffer),r.bufferData(r.ARRAY_BUFFER,n.verticies,r.STATIC_DRAW),r.vertexAttribPointer(u.vertexPositionAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,n._uvBuffer),r.bufferData(r.ARRAY_BUFFER,n.uvs,r.STATIC_DRAW),r.vertexAttribPointer(u.textureCoordAttribute,2,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.texture.baseTexture._glTexture),r.bindBuffer(r.ARRAY_BUFFER,n._colorBuffer),r.bufferData(r.ARRAY_BUFFER,n.colors,r.STATIC_DRAW),r.vertexAttribPointer(u.colorAttribute,1,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n._indexBuffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,n.indices,r.STATIC_DRAW)):(r.bindBuffer(r.ARRAY_BUFFER,n._vertexBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,n.verticies),r.vertexAttribPointer(u.vertexPositionAttribute,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,n._uvBuffer),r.vertexAttribPointer(u.textureCoordAttribute,2,r.FLOAT,!1,0,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.texture.baseTexture._glTexture),r.bindBuffer(r.ARRAY_BUFFER,n._colorBuffer),r.vertexAttribPointer(u.colorAttribute,1,r.FLOAT,!1,0,0),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n._indexBuffer)),r.drawElements(r.TRIANGLE_STRIP,n.indices.length,r.UNSIGNED_SHORT,0),r.useProgram(t.shaderProgram)},t.WebGLRenderGroup.prototype.renderTilingSprite=function(n,i){var r=this.gl,c=t.shaderProgram,e=n.tilePosition,o=n.tileScale,u=e.x/n.texture.baseTexture.width,f=e.y/n.texture.baseTexture.height,s=n.width/n.texture.baseTexture.width/o.x,h=n.height/n.texture.baseTexture.height/o.y;n.uvs[0]=0-u,n.uvs[1]=0-f,n.uvs[2]=1*s-u,n.uvs[3]=0-f,n.uvs[4]=1*s-u,n.uvs[5]=1*h-f,n.uvs[6]=0-u,n.uvs[7]=1*h-f,r.bindBuffer(r.ARRAY_BUFFER,n._uvBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,n.uvs),this.renderStrip(n,i)},t.WebGLRenderGroup.prototype.initStrip=function(n){var t=this.gl,i=this.shaderProgram;n._vertexBuffer=t.createBuffer(),n._indexBuffer=t.createBuffer(),n._uvBuffer=t.createBuffer(),n._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,n.verticies,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,n._uvBuffer),t.bufferData(t.ARRAY_BUFFER,n.uvs,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,n._colorBuffer),t.bufferData(t.ARRAY_BUFFER,n.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n.indices,t.STATIC_DRAW)},t.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"],t.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = vec4( aVertexPosition.x / projectionVector.x -1.0, aVertexPosition.y / -projectionVector.y + 1.0 , 0.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],t.stripShaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * alpha;","}"],t.stripShaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],t.primitiveShaderFragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"],t.primitiveShaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform float alpha;","varying vec4 vColor;","void main(void) {","vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","vColor = aColor  * alpha;","}"],t.initPrimitiveShader=function(){var i=t.gl,n=t.compileProgram(t.primitiveShaderVertexSrc,t.primitiveShaderFragmentSrc);i.useProgram(n),n.vertexPositionAttribute=i.getAttribLocation(n,"aVertexPosition"),n.colorAttribute=i.getAttribLocation(n,"aColor"),n.projectionVector=i.getUniformLocation(n,"projectionVector"),n.translationMatrix=i.getUniformLocation(n,"translationMatrix"),n.alpha=i.getUniformLocation(n,"alpha"),t.primitiveProgram=n},t.initDefaultShader=function(){var i=this.gl,n=t.compileProgram(t.shaderVertexSrc,t.shaderFragmentSrc);i.useProgram(n),n.vertexPositionAttribute=i.getAttribLocation(n,"aVertexPosition"),n.projectionVector=i.getUniformLocation(n,"projectionVector"),n.textureCoordAttribute=i.getAttribLocation(n,"aTextureCoord"),n.colorAttribute=i.getAttribLocation(n,"aColor"),n.samplerUniform=i.getUniformLocation(n,"uSampler"),t.shaderProgram=n},t.initDefaultStripShader=function(){var i=this.gl,n=t.compileProgram(t.stripShaderVertexSrc,t.stripShaderFragmentSrc);i.useProgram(n),n.vertexPositionAttribute=i.getAttribLocation(n,"aVertexPosition"),n.projectionVector=i.getUniformLocation(n,"projectionVector"),n.textureCoordAttribute=i.getAttribLocation(n,"aTextureCoord"),n.translationMatrix=i.getUniformLocation(n,"translationMatrix"),n.alpha=i.getUniformLocation(n,"alpha"),n.colorAttribute=i.getAttribLocation(n,"aColor"),n.projectionVector=i.getUniformLocation(n,"projectionVector"),n.samplerUniform=i.getUniformLocation(n,"uSampler"),t.stripShaderProgram=n},t.CompileVertexShader=function(n,i){return t._CompileShader(n,i,n.VERTEX_SHADER)},t.CompileFragmentShader=function(n,i){return t._CompileShader(n,i,n.FRAGMENT_SHADER)},t._CompileShader=function(n,t,i){var u=t.join("\n"),r=n.createShader(i);return(n.shaderSource(r,u),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))?(alert(n.getShaderInfoLog(r)),null):r},t.compileProgram=function(n,i){var r=t.gl,f=t.CompileFragmentShader(r,i),e=t.CompileVertexShader(r,n),u=r.createProgram();return r.attachShader(u,e),r.attachShader(u,f),r.linkProgram(u),r.getProgramParameter(u,r.LINK_STATUS)||alert("Could not initialise shaders"),u},t.activateDefaultShader=function(){var n=t.gl,i=t.shaderProgram;n.useProgram(i),n.enableVertexAttribArray(i.vertexPositionAttribute),n.enableVertexAttribArray(i.textureCoordAttribute),n.enableVertexAttribArray(i.colorAttribute)},t.activatePrimitiveShader=function(){var n=t.gl;n.disableVertexAttribArray(t.shaderProgram.textureCoordAttribute),n.disableVertexAttribArray(t.shaderProgram.colorAttribute),n.useProgram(t.primitiveProgram),n.enableVertexAttribArray(t.primitiveProgram.vertexPositionAttribute),n.enableVertexAttribArray(t.primitiveProgram.colorAttribute)},t.BitmapText=function(n,i){t.DisplayObjectContainer.call(this),this.setText(n),this.setStyle(i),this.updateText(),this.dirty=!1},t.BitmapText.prototype=Object.create(t.DisplayObjectContainer.prototype),t.BitmapText.prototype.constructor=t.BitmapText,t.BitmapText.prototype.setText=function(n){this.text=n||" ",this.dirty=!0},t.BitmapText.prototype.setStyle=function(n){n=n||{},n.align=n.align||"left",this.style=n;var i=n.font.split(" ");this.fontName=i[i.length-1],this.fontSize=i.length>=2?parseInt(i[i.length-2],10):t.BitmapText.fonts[this.fontName].size,this.dirty=!0},t.BitmapText.prototype.updateText=function(){for(var h=t.BitmapText.fonts[this.fontName],i=new t.Point,o=null,f=[],u=0,c=[],v=0,s=this.fontSize/h.size,l,r,y,a,e,n=0;n<this.text.length;n++){if(l=this.text.charCodeAt(n),/(?:\r\n|\r|\n)/.test(this.text.charAt(n))){c.push(i.x),u=Math.max(u,i.x),v++,i.x=0,i.y+=h.lineHeight,o=null;continue}(r=h.chars[l],r)&&(o&&r[o]&&(i.x+=r.kerning[o]),f.push({texture:r.texture,line:v,charCode:l,position:new t.Point(i.x+r.xOffset,i.y+r.yOffset)}),i.x+=r.xAdvance,o=l)}for(c.push(i.x),u=Math.max(u,i.x),y=[],n=0;n<=v;n++)a=0,this.style.align=="right"?a=u-c[n]:this.style.align=="center"&&(a=(u-c[n])/2),y.push(a);for(n=0;n<f.length;n++)e=new t.Sprite(f[n].texture),e.position.x=(f[n].position.x+y[f[n].line])*s,e.position.y=f[n].position.y*s,e.scale.x=e.scale.y=s,this.addChild(e);this.width=u*s,this.height=(i.y+h.lineHeight)*s},t.BitmapText.prototype.updateTransform=function(){if(this.dirty){while(this.children.length>0)this.removeChild(this.getChildAt(0));this.updateText(),this.dirty=!1}t.DisplayObjectContainer.prototype.updateTransform.call(this)},t.BitmapText.fonts={},t.Text=function(n,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),t.Sprite.call(this,t.Texture.fromCanvas(this.canvas)),this.setText(n),this.setStyle(i),this.updateText(),this.dirty=!1},t.Text.prototype=Object.create(t.Sprite.prototype),t.Text.prototype.constructor=t.Text,t.Text.prototype.setStyle=function(n){n=n||{},n.font=n.font||"bold 20pt Arial",n.fill=n.fill||"black",n.align=n.align||"left",n.stroke=n.stroke||"black",n.strokeThickness=n.strokeThickness||0,n.wordWrap=n.wordWrap||!1,n.wordWrapWidth=n.wordWrapWidth||100,this.style=n,this.dirty=!0},t.Sprite.prototype.setText=function(n){this.text=n.toString()||" ",this.dirty=!0},t.Text.prototype.updateText=function(){var f,n,o,s,i;this.context.font=this.style.font,f=this.text,this.style.wordWrap&&(f=this.wordWrap(this.text));var r=f.split(/(?:\r\n|\r|\n)/),e=[],u=0;for(n=0;n<r.length;n++)o=this.context.measureText(r[n]).width,e[n]=o,u=Math.max(u,o);for(this.canvas.width=u+this.style.strokeThickness,s=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,this.canvas.height=s*r.length,this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top",n=0;n<r.length;n++)i=new t.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+n*s),this.style.align=="right"?i.x+=u-e[n]:this.style.align=="center"&&(i.x+=(u-e[n])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(r[n],i.x,i.y),this.style.fill&&this.context.fillText(r[n],i.x,i.y);this.updateTexture()},t.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,t.texturesToUpdate.push(this.texture.baseTexture)},t.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),t.Sprite.prototype.updateTransform.call(this)},t.Text.prototype.determineFontHeight=function(n){var r=t.Text.heightCache[n];if(!r){var u=document.getElementsByTagName("body")[0],i=document.createElement("div"),f=document.createTextNode("M");i.appendChild(f),i.setAttribute("style",n+";position:absolute;top:0;left:0"),u.appendChild(i),r=i.offsetHeight,t.Text.heightCache[n]=r,u.removeChild(i)}return r},t.Text.prototype.wordWrap=function(n){for(var u=function(n,t,i,r,u){var f=Math.floor((r-i)/2)+i;return f==i?1:n.measureText(t.substring(0,f)).width<=u?n.measureText(t.substring(0,f+1)).width>u?f:arguments.callee(n,t,f,r,u):arguments.callee(n,t,i,f,u)},f=function(n,t,i){if(n.measureText(t).width<=i||t.length<1)return t;var r=u(n,t,0,t.length,i);return t.substring(0,r)+"\n"+arguments.callee(n,t.substring(r),i)},i="",r=n.split("\n"),t=0;t<r.length;t++)i+=f(this.context,r[t],this.style.wordWrapWidth)+"\n";return i},t.Text.prototype.destroy=function(n){n&&this.texture.destroy()},t.Text.heightCache={},t.BaseTextureCache={},t.texturesToUpdate=[],t.texturesToDestroy=[],t.BaseTexture=function(n){if(t.EventTarget.call(this),this.width=100,this.height=100,this.hasLoaded=!1,this.source=n,n){if(this.source instanceof Image||this.source instanceof HTMLImageElement)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,t.texturesToUpdate.push(this);else{var i=this;this.source.onload=function(){i.hasLoaded=!0,i.width=i.source.width,i.height=i.source.height,t.texturesToUpdate.push(i),i.dispatchEvent({type:"loaded",content:i})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,t.texturesToUpdate.push(this);this._powerOf2=!1}},t.BaseTexture.prototype.constructor=t.BaseTexture,t.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.source.src=null),this.source=null,t.texturesToDestroy.push(this)},t.BaseTexture.fromImage=function(n,i){var r=t.BaseTextureCache[n],u;return r||(u=new Image,i&&(u.crossOrigin=""),u.src=n,r=new t.BaseTexture(u),t.BaseTextureCache[n]=r),r},t.TextureCache={},t.FrameCache={},t.Texture=function(n,i){if(t.EventTarget.call(this),i||(this.noFrame=!0,i=new t.Rectangle(0,0,1,1)),n instanceof t.Texture&&(n=n.baseTexture),this.baseTexture=n,this.frame=i,this.trim=new t.Point,this.scope=this,n.hasLoaded)this.noFrame&&(i=new t.Rectangle(0,0,n.width,n.height)),this.setFrame(i);else{var r=this;n.addEventListener("loaded",function(){r.onBaseTextureLoaded()})}},t.Texture.prototype.constructor=t.Texture,t.Texture.prototype.onBaseTextureLoaded=function(){var n=this.baseTexture;n.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new t.Rectangle(0,0,n.width,n.height)),this.noFrame=!1,this.width=this.frame.width,this.height=this.frame.height,this.scope.dispatchEvent({type:"update",content:this})},t.Texture.prototype.destroy=function(n){n&&this.baseTexture.destroy()},t.Texture.prototype.setFrame=function(n){if(this.frame=n,this.width=n.width,this.height=n.height,n.x+n.width>this.baseTexture.width||n.y+n.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,t.Texture.frameUpdates.push(this)},t.Texture.fromImage=function(n,i){var r=t.TextureCache[n];return r||(r=new t.Texture(t.BaseTexture.fromImage(n,i)),t.TextureCache[n]=r),r},t.Texture.fromFrame=function(n){var i=t.TextureCache[n];if(!i)throw new Error("The frameId '"+n+"' does not exist in the texture cache "+this);return i},t.Texture.fromCanvas=function(n){var i=new t.BaseTexture(n);return new t.Texture(i)},t.Texture.addTextureToCache=function(n,i){t.TextureCache[i]=n},t.Texture.removeTextureFromCache=function(n){var i=t.TextureCache[n];return t.TextureCache[n]=null,i},t.Texture.frameUpdates=[],t.RenderTexture=function(n,i){t.EventTarget.call(this),this.width=n||100,this.height=i||100,this.indetityMatrix=t.mat3.create(),this.frame=new t.Rectangle(0,0,this.width,this.height),t.gl?this.initWebGL():this.initCanvas()},t.RenderTexture.prototype=Object.create(t.Texture.prototype),t.RenderTexture.prototype.constructor=t.RenderTexture,t.RenderTexture.prototype.initWebGL=function(){var n=t.gl;this.glFramebuffer=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,this.glFramebuffer),this.glFramebuffer.width=this.width,this.glFramebuffer.height=this.height,this.baseTexture=new t.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.baseTexture._glTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),this.baseTexture.isRender=!0,n.bindFramebuffer(n.FRAMEBUFFER,this.glFramebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.baseTexture._glTexture,0),this.projection=new t.Point(this.width/2,this.height/2),this.render=this.renderWebGL},t.RenderTexture.prototype.resize=function(n,i){if(this.width=n,this.height=i,t.gl){this.projection.x=this.width/2,this.projection.y=this.height/2;var r=t.gl;r.bindTexture(r.TEXTURE_2D,this.baseTexture._glTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null)}else this.frame.width=this.width,this.frame.height=this.height,this.renderer.resize(this.width,this.height)},t.RenderTexture.prototype.initCanvas=function(){this.renderer=new t.CanvasRenderer(this.width,this.height,null,0),this.baseTexture=new t.BaseTexture(this.renderer.view),this.frame=new t.Rectangle(0,0,this.width,this.height),this.render=this.renderCanvas},t.RenderTexture.prototype.renderWebGL=function(n,i,r){var u=t.gl,o,s,e,h,f;for(u.colorMask(!0,!0,!0,!0),u.viewport(0,0,this.width,this.height),u.bindFramebuffer(u.FRAMEBUFFER,this.glFramebuffer),r&&(u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT)),o=n.children,s=n.worldTransform,n.worldTransform=t.mat3.create(),n.worldTransform[4]=-1,n.worldTransform[5]=this.projection.y*2,i&&(n.worldTransform[2]=i.x,n.worldTransform[5]-=i.y),t.visibleCount++,n.vcount=t.visibleCount,e=0,h=o.length;e<h;e++)o[e].updateTransform();f=n.__renderGroup,f?n==f.root?f.render(this.projection):f.renderSpecific(n,this.projection):(this.renderGroup||(this.renderGroup=new t.WebGLRenderGroup(u)),this.renderGroup.setRenderable(n),this.renderGroup.render(this.projection)),n.worldTransform=s},t.RenderTexture.prototype.renderCanvas=function(n,i,r){var f=n.children,u,e;for(n.worldTransform=t.mat3.create(),i&&(n.worldTransform[2]=i.x,n.worldTransform[5]=i.y),u=0,e=f.length;u<e;u++)f[u].updateTransform();r&&this.renderer.context.clearRect(0,0,this.width,this.height),this.renderer.renderDisplayObject(n),this.renderer.context.setTransform(1,0,0,1,0,0)},t.EventTarget=function(){var n={};this.addEventListener=this.on=function(t,i){n[t]===undefined&&(n[t]=[]),n[t].indexOf(i)===-1&&n[t].push(i)},this.dispatchEvent=this.emit=function(t){for(var i in n[t.type])n[t.type][i](t)},this.removeEventListener=this.off=function(t,i){var r=n[t].indexOf(i);r!==-1&&n[t].splice(r,1)}},t.PolyK={},t.PolyK.Triangulate=function(n){var a=!0,o=n.length>>1,r,u,l,e,f,i;if(o<3)return[];for(f=[],r=[],i=0;i<o;i++)r.push(i);for(i=0,u=o;u>3;){var s=r[(i+0)%u],h=r[(i+1)%u],c=r[(i+2)%u],y=n[2*s],p=n[2*s+1],w=n[2*h],b=n[2*h+1],k=n[2*c],d=n[2*c+1],v=!1;if(t.PolyK._convex(y,p,w,b,k,d,a))for(v=!0,l=0;l<u;l++)if((e=r[l],e!=s&&e!=h&&e!=c)&&t.PolyK._PointInTriangle(n[2*e],n[2*e+1],y,p,w,b,k,d)){v=!1;break}if(v)f.push(s,h,c),r.splice((i+1)%u,1),u--,i=0;else if(i++>3*u)if(a){for(f=[],r=[],i=0;i<o;i++)r.push(i);i=0,u=o,a=!1}else return console.log("PIXI Warning: shape too complex to fill"),[]}return f.push(r[0],r[1],r[2]),f},t.PolyK._PointInTriangle=function(n,t,i,r,u,f,e,o){var s=e-i,h=o-r,c=u-i,l=f-r,v=n-i,y=t-r,p=s*s+h*h,a=s*c+h*l,w=s*v+h*y,b=c*c+l*l,k=c*v+l*y,d=1/(p*b-a*a),g=(b*w-a*k)*d,nt=(p*k-a*w)*d;return g>=0&&nt>=0&&g+nt<1},t.PolyK._convex=function(n,t,i,r,u,f,e){return(t-r)*(u-i)+(i-n)*(f-r)>=0==e},n.Camera=function(t,i,r,u,f,e){this.game=t,this.world=t.world,this.id=0,this.view=new n.Rectangle(r,u,f,e),this.screenView=new n.Rectangle(r,u,f,e),this.bounds=new n.Rectangle(r,u,f,e),this.deadzone=null,this.visible=!0,this.atLimit={x:!1,y:!1},this.target=null,this._edge=0,this.displayObject=null},n.Camera.FOLLOW_LOCKON=0,n.Camera.FOLLOW_PLATFORMER=1,n.Camera.FOLLOW_TOPDOWN=2,n.Camera.FOLLOW_TOPDOWN_TIGHT=3,n.Camera.prototype={follow:function(t,i){var r,f,u;typeof i=="undefined"&&(i=n.Camera.FOLLOW_LOCKON),this.target=t;switch(i){case n.Camera.FOLLOW_PLATFORMER:f=this.width/8,u=this.height/3,this.deadzone=new n.Rectangle((this.width-f)/2,(this.height-u)/2-u*.25,f,u);break;case n.Camera.FOLLOW_TOPDOWN:r=Math.max(this.width,this.height)/4,this.deadzone=new n.Rectangle((this.width-r)/2,(this.height-r)/2,r,r);break;case n.Camera.FOLLOW_TOPDOWN_TIGHT:r=Math.max(this.width,this.height)/8,this.deadzone=new n.Rectangle((this.width-r)/2,(this.height-r)/2,r,r);break;case n.Camera.FOLLOW_LOCKON:default:this.deadzone=null}},focusOn:function(n){this.setPosition(Math.round(n.x-this.view.halfWidth),Math.round(n.y-this.view.halfHeight))},focusOnXY:function(n,t){this.setPosition(Math.round(n-this.view.halfWidth),Math.round(t-this.view.halfHeight))},update:function(){this.target&&this.updateTarget(),this.bounds&&this.checkBounds(),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},updateTarget:function(){this.deadzone?(this._edge=this.target.x-this.deadzone.x,this.view.x>this._edge&&(this.view.x=this._edge),this._edge=this.target.x+this.target.width-this.deadzone.x-this.deadzone.width,this.view.x<this._edge&&(this.view.x=this._edge),this._edge=this.target.y-this.deadzone.y,this.view.y>this._edge&&(this.view.y=this._edge),this._edge=this.target.y+this.target.height-this.deadzone.y-this.deadzone.height,this.view.y<this._edge&&(this.view.y=this._edge)):this.focusOnXY(this.target.x,this.target.y)},setBoundsToWorld:function(){this.bounds.setTo(this.game.world.x,this.game.world.y,this.game.world.width,this.game.world.height)},checkBounds:function(){this.atLimit.x=!1,this.atLimit.y=!1,this.view.x<this.bounds.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x),this.view.x>this.bounds.right-this.width&&(this.atLimit.x=!0,this.view.x=this.bounds.right-this.width+1),this.view.y<this.bounds.top&&(this.atLimit.y=!0,this.view.y=this.bounds.top),this.view.y>this.bounds.bottom-this.height&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom-this.height+1),this.view.floor()},setPosition:function(n,t){this.view.x=n,this.view.y=t,this.bounds&&this.checkBounds()},setSize:function(n,t){this.view.width=n,this.view.height=t}},Object.defineProperty(n.Camera.prototype,"x",{get:function(){return this.view.x},set:function(n){this.view.x=n,this.bounds&&this.checkBounds()}}),Object.defineProperty(n.Camera.prototype,"y",{get:function(){return this.view.y},set:function(n){this.view.y=n,this.bounds&&this.checkBounds()}}),Object.defineProperty(n.Camera.prototype,"width",{get:function(){return this.view.width},set:function(n){this.view.width=n}}),Object.defineProperty(n.Camera.prototype,"height",{get:function(){return this.view.height},set:function(n){this.view.height=n}}),n.State=function(){this.game=null,this.add=null,this.camera=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.particles=null,this.physics=null},n.State.prototype={preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},render:function(){},paused:function(){},destroy:function(){}},n.StateManager=function(n,t){this.game=n,this.states={},t!==null&&(this._pendingState=t)},n.StateManager.prototype={game:null,_pendingState:null,_created:!1,states:{},current:"",onInitCallback:null,onPreloadCallback:null,onCreateCallback:null,onUpdateCallback:null,onRenderCallback:null,onPreRenderCallback:null,onLoadUpdateCallback:null,onLoadRenderCallback:null,onPausedCallback:null,onShutDownCallback:null,boot:function(){this._pendingState!==null&&(typeof this._pendingState=="string"?this.start(this._pendingState,!1,!1):this.add("default",this._pendingState,!0))},add:function(t,i,r){typeof r=="undefined"&&(r=!1);var u;return i instanceof n.State?u=i:typeof i=="object"?(u=i,u.game=this.game):typeof i=="function"&&(u=new i(this.game)),this.states[t]=u,r&&(this.game.isBooted?this.start(t):this._pendingState=t),u},remove:function(n){this.current==n&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onDestroyCallback=null),delete this.states[n]},start:function(n,t,i){if(typeof t=="undefined"&&(t=!0),typeof i=="undefined"&&(i=!1),this.game.isBooted==!1){this._pendingState=n;return}this.checkState(n)!=!1&&(this.current&&this.onShutDownCallback.call(this.callbackContext,this.game),t&&(this.game.tweens.removeAll(),this.game.world.destroy(),i==!0&&this.game.cache.destroy()),this.setCurrentState(n),this.onPreloadCallback?(this.game.load.reset(),this.onPreloadCallback.call(this.callbackContext,this.game),this.game.load.queueSize==0?this.game.loadComplete():this.game.load.start()):this.game.loadComplete())},dummy:function(){},checkState:function(n){if(this.states[n]){var t=!1;return(this.states[n].preload&&(t=!0),t==!1&&this.states[n].loadRender&&(t=!0),t==!1&&this.states[n].loadUpdate&&(t=!0),t==!1&&this.states[n].create&&(t=!0),t==!1&&this.states[n].update&&(t=!0),t==!1&&this.states[n].preRender&&(t=!0),t==!1&&this.states[n].render&&(t=!0),t==!1&&this.states[n].paused&&(t=!0),t==!1)?(console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions."),!1):!0}return console.warn("Phaser.StateManager - No state found with the key: "+n),!1},link:function(n){this.states[n].game=this.game,this.states[n].add=this.game.add,this.states[n].camera=this.game.camera,this.states[n].cache=this.game.cache,this.states[n].input=this.game.input,this.states[n].load=this.game.load,this.states[n].math=this.game.math,this.states[n].sound=this.game.sound,this.states[n].stage=this.game.stage,this.states[n].time=this.game.time,this.states[n].tweens=this.game.tweens,this.states[n].world=this.game.world,this.states[n].particles=this.game.particles,this.states[n].physics=this.game.physics,this.states[n].rnd=this.game.rnd},setCurrentState:function(n){this.callbackContext=this.states[n],this.link(n),this.onInitCallback=this.states[n].init||this.dummy,this.onPreloadCallback=this.states[n].preload||null,this.onLoadRenderCallback=this.states[n].loadRender||null,this.onLoadUpdateCallback=this.states[n].loadUpdate||null,this.onCreateCallback=this.states[n].create||null,this.onUpdateCallback=this.states[n].update||null,this.onPreRenderCallback=this.states[n].preRender||null,this.onRenderCallback=this.states[n].render||null,this.onPausedCallback=this.states[n].paused||null,this.onShutDownCallback=this.states[n].shutdown||this.dummy,this.current=n,this._created=!1,this.onInitCallback.call(this.callbackContext,this.game)},loadComplete:function(){this._created==!1&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},update:function(){this._created&&this.onUpdateCallback?this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(){this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game)},render:function(){this._created&&this.onRenderCallback?this.onRenderCallback.call(this.callbackContext,this.game):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onDestroyCallback=null,this.game=null,this.states={},this._pendingState=null}},n.LinkedList=function(){this.next=null,this.prev=null,this.first=null,this.last=null,this.total=0},n.LinkedList.prototype={add:function(n){return this.total==0&&this.first==null&&this.last==null?(this.first=n,this.last=n,this.next=n,n.prev=this,this.total++,n):(this.last.next=n,n.prev=this.last,this.last=n,this.total++,n)},remove:function(n){n==this.first?this.first=this.first.next:n==this.last&&(this.last=this.last.prev),n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n.next=n.prev=null,this.first==null&&(this.last=null),this.total--},callAll:function(n){if(this.first&&this.last){var t=this.first;do t&&t[n]&&t[n].call(t),t=t.next;while(t!=this.last.next)}}},n.Signal=function(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){n.Signal.prototype.dispatch.apply(t,arguments)}},n.Signal.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(n,t){if(typeof n!="function")throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t));},_registerListener:function(t,i,r,u){var e=this._indexOfListener(t,r),f;if(e!==-1){if(f=this._bindings[e],f.isOnce()!==i)throw new Error("You cannot add"+(i?"":"Once")+"() then add"+(i?"Once":"")+"() the same listener without removing the relationship first.");}else f=new n.SignalBinding(this,t,i,r,u),this._addBinding(f);return this.memorize&&this._prevParams&&f.execute(this._prevParams),f},_addBinding:function(n){var t=this._bindings.length;do--t;while(this._bindings[t]&&n._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,n)},_indexOfListener:function(n,t){for(var i=this._bindings.length,r;i--;)if(r=this._bindings[i],r._listener===n&&r.context===t)return i;return-1},has:function(n,t){return this._indexOfListener(n,t)!==-1},add:function(n,t,i){return this.validateListener(n,"add"),this._registerListener(n,!1,t,i)},addOnce:function(n,t,i){return this.validateListener(n,"addOnce"),this._registerListener(n,!0,t,i)},remove:function(n,t){this.validateListener(n,"remove");var i=this._indexOfListener(n,t);return i!==-1&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),n},removeAll:function(){for(var n=this._bindings.length;n--;)this._bindings[n]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var i=Array.prototype.slice.call(arguments),n=this._bindings.length,t;if(this.memorize&&(this._prevParams=i),n){t=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(t[n]&&this._shouldPropagate&&t[n].execute(i)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},n.SignalBinding=function(n,t,i,r,u){this._listener=t,this._isOnce=i,this.context=r,this._signal=n,this._priority=u||0},n.SignalBinding.prototype={active:!0,params:null,execute:function(n){var t,i;return this.active&&!!this._listener&&(i=this.params?this.params.concat(n):n,t=this._listener.apply(this.context,i),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},n.Plugin=function(n,t){typeof t=="undefined"&&(t=null),this.game=n,this.parent=t,this.active=!1,this.visible=!1,this.hasPreUpdate=!1,this.hasUpdate=!1,this.hasRender=!1,this.hasPostRender=!1},n.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null,this.parent=null,this.active=!1,this.visible=!1}},n.PluginManager=function(n,t){this.game=n,this._parent=t,this.plugins=[],this._pluginsLength=0},n.PluginManager.prototype={add:function(n){var t=!1;return typeof n=="function"?n=new n(this.game,this._parent):(n.game=this.game,n.parent=this._parent),typeof n.preUpdate=="function"&&(n.hasPreUpdate=!0,t=!0),typeof n.update=="function"&&(n.hasUpdate=!0,t=!0),typeof n.render=="function"&&(n.hasRender=!0,t=!0),typeof n.postRender=="function"&&(n.hasPostRender=!0,t=!0),t?((n.hasPreUpdate||n.hasUpdate)&&(n.active=!0),(n.hasRender||n.hasPostRender)&&(n.visible=!0),this._pluginsLength=this.plugins.push(n),typeof n.init=="function"&&n.init(),n):null},remove:function(){this._pluginsLength--},preUpdate:function(){if(this._pluginsLength!=0)for(this._p=0;this._p<this._pluginsLength;this._p++)this.plugins[this._p].active&&this.plugins[this._p].hasPreUpdate&&this.plugins[this._p].preUpdate()},update:function(){if(this._pluginsLength!=0)for(this._p=0;this._p<this._pluginsLength;this._p++)this.plugins[this._p].active&&this.plugins[this._p].hasUpdate&&this.plugins[this._p].update()},render:function(){if(this._pluginsLength!=0)for(this._p=0;this._p<this._pluginsLength;this._p++)this.plugins[this._p].visible&&this.plugins[this._p].hasRender&&this.plugins[this._p].render()},postRender:function(){if(this._pluginsLength!=0)for(this._p=0;this._p<this._pluginsLength;this._p++)this.plugins[this._p].visible&&this.plugins[this._p].hasPostRender&&this.plugins[this._p].postRender()},destroy:function(){this.plugins.length=0,this._pluginsLength=0,this.game=null,this._parent=null}},n.Stage=function(i,r,u){this.game=i,this._backgroundColor="rgb(0,0,0)",this.offset=new n.Point,this.canvas=n.Canvas.create(r,u),this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%",this._stage=new t.Stage(0,!1),this._stage.name="_stage_root",this.scaleMode=n.StageScaleMode.NO_SCALE,this.scale=new n.StageScaleMode(this.game,r,u),this.aspectRatio=r/u,this._nextOffsetCheck=0,this.checkOffsetInterval=2500},n.Stage.prototype={boot:function(){n.Canvas.getOffset(this.canvas,this.offset),this.bounds=new n.Rectangle(this.offset.x,this.offset.y,this.game.width,this.game.height);var t=this;this._onChange=function(n){return t.visibilityChange(n)},n.Canvas.setUserSelect(this.canvas,"none"),n.Canvas.setTouchAction(this.canvas,"none"),document.addEventListener("visibilitychange",this._onChange,!1),document.addEventListener("webkitvisibilitychange",this._onChange,!1),document.addEventListener("pagehide",this._onChange,!1),document.addEventListener("pageshow",this._onChange,!1),window.onblur=this._onChange,window.onfocus=this._onChange},update:function(){this.checkOffsetInterval!==!1&&this.game.time.now>this._nextOffsetCheck&&(n.Canvas.getOffset(this.canvas,this.offset),this._nextOffsetCheck=this.game.time.now+this.checkOffsetInterval)},visibilityChange:function(n){this.disableVisibilityChange||(this.game.paused=n.type=="pagehide"||n.type=="blur"||document.hidden==!0||document.webkitHidden==!0?!0:!1)}},Object.defineProperty(n.Stage.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.game.renderType==n.CANVAS?this._stage.backgroundColorString=t:(typeof t=="string"&&(t=n.Color.hexToRGB(t)),this._stage.setBackgroundColor(t))}}),n.Group=function(i,r,u,f){typeof r=="undefined"&&(r=i.world),typeof f=="undefined"&&(f=!1),this.game=i,this.name=u||"group",f?this._container=this.game.stage._stage:(this._container=new t.DisplayObjectContainer,this._container.name=this.name,r?r instanceof n.Group?(r._container.addChild(this._container),r._container.updateTransform()):(r.addChild(this._container),r.updateTransform()):(this.game.stage._stage.addChild(this._container),this.game.stage._stage.updateTransform())),this.type=n.GROUP,this.exists=!0,this.scale=new n.Point(1,1),this.cursor=null},n.Group.prototype={add:function(n){return n.group!==this&&(n.group=this,n.events&&n.events.onAddedToGroup.dispatch(n,this),this._container.addChild(n),n.updateTransform(),this.cursor===null&&(this.cursor=n)),n},addAt:function(n,t){return n.group!==this&&(n.group=this,n.events&&n.events.onAddedToGroup.dispatch(n,this),this._container.addChildAt(n,t),n.updateTransform(),this.cursor===null&&(this.cursor=n)),n},getAt:function(n){return this._container.getChildAt(n)},create:function(t,i,r,u,f){typeof f=="undefined"&&(f=!0);var e=new n.Sprite(this.game,t,i,r,u);return e.group=this,e.exists=f,e.visible=f,e.alive=f,e.events&&e.events.onAddedToGroup.dispatch(e,this),this._container.addChild(e),e.updateTransform(),this.cursor===null&&(this.cursor=e),e},createMultiple:function(t,i,r,u){var e,f;for(typeof u=="undefined"&&(u=!1),e=0;e<t;e++)f=new n.Sprite(this.game,0,0,i,r),f.group=this,f.exists=u,f.visible=u,f.alive=u,f.events&&f.events.onAddedToGroup.dispatch(f,this),this._container.addChild(f),f.updateTransform(),this.cursor===null&&(this.cursor=f)},next:function(){this.cursor&&(this.cursor=this.cursor==this._container.last?this._container._iNext:this.cursor._iNext)},previous:function(){this.cursor&&(this.cursor=this.cursor==this._container._iNext?this._container.last:this.cursor._iPrev)},swap:function(n,t){if(n===t||!n.parent||!t.parent)return console.warn("You cannot swap a child with itself or swap un-parented children"),!1;var u=n._iPrev,e=n._iNext,f=t._iPrev,r=t._iNext,o=this._container.last._iNext,i=this.game.stage._stage;do i!==n&&i!==t&&(i.first===n?i.first=t:i.first===t&&(i.first=n),i.last===n?i.last=t:i.last===t&&(i.last=n)),i=i._iNext;while(i!=o);return n._iNext==t?(n._iNext=r,n._iPrev=t,t._iNext=n,t._iPrev=u,u&&(u._iNext=t),r&&(r._iPrev=n),n.__renderGroup&&n.__renderGroup.updateTexture(n),t.__renderGroup&&t.__renderGroup.updateTexture(t),!0):t._iNext==n?(n._iNext=t,n._iPrev=f,t._iNext=e,t._iPrev=n,f&&(f._iNext=n),e&&(r._iPrev=t),n.__renderGroup&&n.__renderGroup.updateTexture(n),t.__renderGroup&&t.__renderGroup.updateTexture(t),!0):(n._iNext=r,n._iPrev=f,t._iNext=e,t._iPrev=u,u&&(u._iNext=t),e&&(e._iPrev=t),f&&(f._iNext=n),r&&(r._iPrev=n),n.__renderGroup&&n.__renderGroup.updateTexture(n),t.__renderGroup&&t.__renderGroup.updateTexture(t),!0)},bringToTop:function(n){return n.group===this&&(this.remove(n),this.add(n)),n},getIndex:function(n){return this._container.children.indexOf(n)},replace:function(n,t){if(this._container.first._iNext){var i=this.getIndex(n);i!=-1&&(t.parent!=undefined&&(t.events.onRemovedFromGroup.dispatch(t,this),t.parent.removeChild(t)),this._container.removeChild(n),this._container.addChildAt(t,i),t.events.onAddedToGroup.dispatch(t,this),t.updateTransform(),this.cursor==n&&(this.cursor=this._container._iNext))}},setProperty:function(n,t,i,r){r=r||0;var u=t.length;u==1?r==0?n[t[0]]=i:r==1?n[t[0]]+=i:r==2?n[t[0]]-=i:r==3?n[t[0]]*=i:r==4&&(n[t[0]]/=i):u==2?r==0?n[t[0]][t[1]]=i:r==1?n[t[0]][t[1]]+=i:r==2?n[t[0]][t[1]]-=i:r==3?n[t[0]][t[1]]*=i:r==4&&(n[t[0]][t[1]]/=i):u==3?r==0?n[t[0]][t[1]][t[2]]=i:r==1?n[t[0]][t[1]][t[2]]+=i:r==2?n[t[0]][t[1]][t[2]]-=i:r==3?n[t[0]][t[1]][t[2]]*=i:r==4&&(n[t[0]][t[1]][t[2]]/=i):u==4&&(r==0?n[t[0]][t[1]][t[2]][t[3]]=i:r==1?n[t[0]][t[1]][t[2]][t[3]]+=i:r==2?n[t[0]][t[1]][t[2]][t[3]]-=i:r==3?n[t[0]][t[1]][t[2]][t[3]]*=i:r==4&&(n[t[0]][t[1]][t[2]][t[3]]/=i))},setAll:function(n,t,i,r,u){if(n=n.split("."),typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r=!1),u=u||0,this._container.children.length>0&&this._container.first._iNext){var f=this._container.first._iNext;do(i==!1||i&&f.alive)&&(r==!1||r&&f.visible)&&this.setProperty(f,n,t,u),f=f._iNext;while(f!=this._container.last._iNext)}},addAll:function(n,t,i,r){this.setAll(n,t,i,r,1)},subAll:function(n,t,i,r){this.setAll(n,t,i,r,2)},multiplyAll:function(n,t,i,r){this.setAll(n,t,i,r,3)},divideAll:function(n,t,i,r){this.setAll(n,t,i,r,4)},callAllExists:function(n,t){var r=Array.prototype.splice.call(arguments,2),i;if(this._container.children.length>0&&this._container.first._iNext){i=this._container.first._iNext;do i.exists==t&&i[n]&&i[n].apply(i,r),i=i._iNext;while(i!=this._container.last._iNext)}},callbackFromArray:function(n,t,i){if(i==1){if(n[t[0]])return n[t[0]]}else if(i==2){if(n[t[0]][t[1]])return n[t[0]][t[1]]}else if(i==3){if(n[t[0]][t[1]][t[2]])return n[t[0]][t[1]][t[2]]}else if(i==4){if(n[t[0]][t[1]][t[2]][t[3]])return n[t[0]][t[1]][t[2]][t[3]]}else if(n[t])return n[t];return!1},callAll:function(n,t){var f,e,u,i,r;if(typeof n!="undefined"&&(n=n.split("."),f=n.length,typeof t=="undefined"?t=null:typeof t=="string"&&(t=t.split("."),e=t.length),u=Array.prototype.splice.call(arguments,2),i=null,this._container.children.length>0&&this._container.first._iNext)){r=this._container.first._iNext;do i=this.callbackFromArray(r,n,f),t&&i?(callbackContext=this.callbackFromArray(r,t,e),i&&i.apply(callbackContext,u)):i&&i.apply(r,u),r=r._iNext;while(r!=this._container.last._iNext)}},forEach:function(n,t,i){var u,r;if(typeof i=="undefined"&&(i=!1),u=Array.prototype.splice.call(arguments,3),u.unshift(null),this._container.children.length>0&&this._container.first._iNext){r=this._container.first._iNext;do(i==!1||i&&r.exists)&&(u[0]=r,n.apply(t,u)),r=r._iNext;while(r!=this._container.last._iNext)}},forEachAlive:function(n,t){var r=Array.prototype.splice.call(arguments,2),i;if(r.unshift(null),this._container.children.length>0&&this._container.first._iNext){i=this._container.first._iNext;do i.alive&&(r[0]=i,n.apply(t,r)),i=i._iNext;while(i!=this._container.last._iNext)}},forEachDead:function(n,t){var r=Array.prototype.splice.call(arguments,2),i;if(r.unshift(null),this._container.children.length>0&&this._container.first._iNext){i=this._container.first._iNext;do i.alive==!1&&(r[0]=i,n.apply(t,r)),i=i._iNext;while(i!=this._container.last._iNext)}},getFirstExists:function(n){if(typeof n!="boolean"&&(n=!0),this._container.children.length>0&&this._container.first._iNext){var t=this._container.first._iNext;do{if(t.exists===n)return t;t=t._iNext}while(t!=this._container.last._iNext)}return null},getFirstAlive:function(){if(this._container.children.length>0&&this._container.first._iNext){var n=this._container.first._iNext;do{if(n.alive)return n;n=n._iNext}while(n!=this._container.last._iNext)}return null},getFirstDead:function(){if(this._container.children.length>0&&this._container.first._iNext){var n=this._container.first._iNext;do{if(!n.alive)return n;n=n._iNext}while(n!=this._container.last._iNext)}return null},countLiving:function(){var t=0,n;if(this._container.children.length>0&&this._container.first._iNext){n=this._container.first._iNext;do n.alive&&t++,n=n._iNext;while(n!=this._container.last._iNext)}else t=-1;return t},countDead:function(){var t=0,n;if(this._container.children.length>0&&this._container.first._iNext){n=this._container.first._iNext;do n.alive||t++,n=n._iNext;while(n!=this._container.last._iNext)}else t=-1;return t},getRandom:function(n,t){return this._container.children.length==0?null:(n=n||0,t=t||this._container.children.length,this.game.math.getRandom(this._container.children,n,t))},remove:function(n){n.events&&n.events.onRemovedFromGroup.dispatch(n,this),this._container.removeChild(n),this.cursor==n&&(this.cursor=this._container._iNext?this._container._iNext:null),n.group=null},removeAll:function(){if(this._container.children.length!=0){do this._container.children[0].events&&this._container.children[0].events.onRemovedFromGroup.dispatch(this._container.children[0],this),this._container.removeChild(this._container.children[0]);while(this._container.children.length>0);this.cursor=null}},removeBetween:function(n,t){var r,i;if(this._container.children.length!=0){if(n>t||n<0||t>this._container.children.length)return!1;for(r=n;r<t;r++)i=this._container.children[r],i.events.onRemovedFromGroup.dispatch(i,this),this._container.removeChild(i),this.cursor==i&&(this.cursor=this._container._iNext?this._container._iNext:null)}},destroy:function(){this.removeAll(),this._container.parent.removeChild(this._container),this._container=null,this.game=null,this.exists=!1,this.cursor=null},dump:function(t){var i,e,r,f,u;typeof t=="undefined"&&(t=!1),i=20,u="\n"+n.Utils.pad("Node",i)+"|"+n.Utils.pad("Next",i)+"|"+n.Utils.pad("Previous",i)+"|"+n.Utils.pad("First",i)+"|"+n.Utils.pad("Last",i),console.log(u),u=n.Utils.pad("----------",i)+"|"+n.Utils.pad("----------",i)+"|"+n.Utils.pad("----------",i)+"|"+n.Utils.pad("----------",i)+"|"+n.Utils.pad("----------",i),console.log(u),t?(e=this.game.stage._stage.last._iNext,r=this.game.stage._stage):(e=this._container.last._iNext,r=this._container);do{f=r.name||"*",this.cursor==r&&(f="> "+f);var o="-",s="-",h="-",c="-";r._iNext&&(o=r._iNext.name),r._iPrev&&(s=r._iPrev.name),r.first&&(h=r.first.name),r.last&&(c=r.last.name),typeof o=="undefined"&&(o="-"),typeof s=="undefined"&&(s="-"),typeof h=="undefined"&&(h="-"),typeof c=="undefined"&&(c="-"),u=n.Utils.pad(f,i)+"|"+n.Utils.pad(o,i)+"|"+n.Utils.pad(s,i)+"|"+n.Utils.pad(h,i)+"|"+n.Utils.pad(c,i),console.log(u),r=r._iNext}while(r!=e)}},Object.defineProperty(n.Group.prototype,"total",{get:function(){return this._container.children.length}}),Object.defineProperty(n.Group.prototype,"length",{get:function(){return this._container.children.length}}),Object.defineProperty(n.Group.prototype,"x",{get:function(){return this._container.position.x},set:function(n){this._container.position.x=n}}),Object.defineProperty(n.Group.prototype,"y",{get:function(){return this._container.position.y},set:function(n){this._container.position.y=n}}),Object.defineProperty(n.Group.prototype,"angle",{get:function(){return n.Math.radToDeg(this._container.rotation)},set:function(t){this._container.rotation=n.Math.degToRad(t)}}),Object.defineProperty(n.Group.prototype,"rotation",{get:function(){return this._container.rotation},set:function(n){this._container.rotation=n}}),Object.defineProperty(n.Group.prototype,"visible",{get:function(){return this._container.visible},set:function(n){this._container.visible=n}}),Object.defineProperty(n.Group.prototype,"alpha",{get:function(){return this._container.alpha},set:function(n){this._container.alpha=n}}),n.World=function(t){n.Group.call(this,t,null,"__world",!1),this.scale=new n.Point(1,1),this.bounds=new n.Rectangle(0,0,t.width,t.height),this.camera=null,this.currentRenderOrderID=0},n.World.prototype=Object.create(n.Group.prototype),n.World.prototype.constructor=n.World,n.World.prototype.boot=function(){this.camera=new n.Camera(this.game,0,0,0,this.game.width,this.game.height),this.camera.displayObject=this._container,this.game.camera=this.camera},n.World.prototype.update=function(){if(this.currentRenderOrderID=0,this.game.stage._stage.first._iNext){var n=this.game.stage._stage.first._iNext;do n.preUpdate&&n.preUpdate(),n.update&&n.update(),n=n._iNext;while(n!=this.game.stage._stage.last._iNext)}},n.World.prototype.postUpdate=function(){if(this.camera.update(),this.game.stage._stage.first._iNext){var n=this.game.stage._stage.first._iNext;do n.postUpdate&&n.postUpdate(),n=n._iNext;while(n!=this.game.stage._stage.last._iNext)}},n.World.prototype.setBounds=function(n,t,i,r){this.bounds.setTo(n,t,i,r),this.camera.bounds&&this.camera.bounds.setTo(n,t,i,r)},n.World.prototype.destroy=function(){this.camera.x=0,this.camera.y=0,this.game.input.reset(!0),this.removeAll()},Object.defineProperty(n.World.prototype,"width",{get:function(){return this.bounds.width},set:function(n){this.bounds.width=n}}),Object.defineProperty(n.World.prototype,"height",{get:function(){return this.bounds.height},set:function(n){this.bounds.height=n}}),Object.defineProperty(n.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth}}),Object.defineProperty(n.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight}}),Object.defineProperty(n.World.prototype,"randomX",{get:function(){return this.bounds.x<0?this.game.rnd.integerInRange(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.integerInRange(this.bounds.x,this.bounds.width)}}),Object.defineProperty(n.World.prototype,"randomY",{get:function(){return this.bounds.y<0?this.game.rnd.integerInRange(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.integerInRange(this.bounds.y,this.bounds.height)}}),n.Game=function(t,i,r,u,f,e,o){t=t||800,i=i||600,r=r||n.AUTO,u=u||"",f=f||null,typeof e=="undefined"&&(e=!1),typeof o=="undefined"&&(o=!0),this.id=n.GAMES.push(this)-1,this.parent=u,this.width=t,this.height=i,this.transparent=e,this.antialias=o,this.renderer=null,this.state=new n.StateManager(this,f),this._paused=!1,this.renderType=r,this._loadComplete=!1,this.isBooted=!1,this.isRunning=!1,this.raf=null,this.add=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.net=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.physics=null,this.rnd=null,this.device=null,this.camera=null,this.canvas=null,this.context=null,this.debug=null,this.particles=null;var s=this;return this._onBoot=function(){return s.boot()},document.readyState==="complete"||document.readyState==="interactive"?window.setTimeout(this._onBoot,0):(document.addEventListener("DOMContentLoaded",this._onBoot,!1),window.addEventListener("load",this._onBoot,!1)),this},n.Game.prototype={boot:function(){this.isBooted||(document.body?(document.removeEventListener("DOMContentLoaded",this._onBoot),window.removeEventListener("load",this._onBoot),this.onPause=new n.Signal,this.onResume=new n.Signal,this.isBooted=!0,this.device=new n.Device,this.math=n.Math,this.rnd=new n.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.stage=new n.Stage(this,this.width,this.height),this.setUpRenderer(),this.world=new n.World(this),this.add=new n.GameObjectFactory(this),this.cache=new n.Cache(this),this.load=new n.Loader(this),this.time=new n.Time(this),this.tweens=new n.TweenManager(this),this.input=new n.Input(this),this.sound=new n.SoundManager(this),this.physics=new n.Physics.Arcade(this),this.particles=new n.Particles(this),this.plugins=new n.PluginManager(this,this),this.net=new n.Net(this),this.debug=new n.Utils.Debug(this),this.stage.boot(),this.world.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.load.onLoadComplete.add(this.loadComplete,this),this.showDebugHeader(),this.isRunning=!0,this._loadComplete=!1,this.raf=new n.RequestAnimationFrame(this),this.raf.start()):window.setTimeout(this._onBoot,20))},showDebugHeader:function(){var r=n.DEV_VERSION,t="Canvas",i="HTML Audio",u;this.renderType==n.WEBGL&&(t="WebGL"),this.device.webAudio&&(i="WebAudio"),this.device.chrome?(u=["%c %c %c  Phaser v"+r+" - Renderer: "+t+" - Audio: "+i+"  %c %c ","background: #00bff3","background: #0072bc","color: #ffffff; background: #003471","background: #0072bc","background: #00bff3"],console.log.apply(console,u)):console.log("Phaser v"+r+" - Renderer: "+t+" - Audio: "+i)},setUpRenderer:function(){if(this.renderType===n.CANVAS||this.renderType===n.AUTO&&this.device.webGL==!1)if(this.device.canvas)this.renderType=n.CANVAS,this.renderer=new t.CanvasRenderer(this.width,this.height,this.stage.canvas,this.transparent),n.Canvas.setSmoothingEnabled(this.renderer.context,this.antialias),this.canvas=this.renderer.view,this.context=this.renderer.context;else throw new Error("Phaser.Game - cannot create Canvas or WebGL context, aborting.");else this.renderType=n.WEBGL,this.renderer=new t.WebGLRenderer(this.width,this.height,this.stage.canvas,this.transparent,this.antialias),this.canvas=this.renderer.view,this.context=null;n.Canvas.addToDOM(this.renderer.view,this.parent,!0),n.Canvas.setTouchAction(this.renderer.view)},loadComplete:function(){this._loadComplete=!0,this.state.loadComplete()},update:function(n){this.time.update(n),this._paused||(this.plugins.preUpdate(),this.physics.preUpdate(),this.stage.update(),this.input.update(),this.tweens.update(),this.sound.update(),this.world.update(),this.particles.update(),this.state.update(),this.plugins.update(),this.world.postUpdate(),this.renderer.render(this.stage._stage),this.plugins.render(),this.state.render(),this.plugins.postRender())},destroy:function(){this.raf.stop(),this.input.destroy(),this.state.destroy(),this.state=null,this.cache=null,this.input=null,this.load=null,this.sound=null,this.stage=null,this.time=null,this.world=null,this.isBooted=!1}},Object.defineProperty(n.Game.prototype,"paused",{get:function(){return this._paused},set:function(n){n===!0?this._paused==!1&&(this._paused=!0,this.onPause.dispatch(this)):this._paused&&(this._paused=!1,this.onResume.dispatch(this))}}),n.Input=function(n){this.game=n,this.hitCanvas=null,this.hitContext=null},n.Input.MOUSE_OVERRIDES_TOUCH=0,n.Input.TOUCH_OVERRIDES_MOUSE=1,n.Input.MOUSE_TOUCH_COMBINE=2,n.Input.prototype={game:null,pollRate:0,_pollCounter:0,_oldPosition:null,_x:0,_y:0,disabled:!1,multiInputOverride:n.Input.MOUSE_TOUCH_COMBINE,position:null,speed:null,circle:null,scale:null,maxPointers:10,currentPointers:0,tapRate:200,doubleTapRate:300,holdRate:2e3,justPressedRate:200,justReleasedRate:200,recordPointerHistory:!1,recordRate:100,recordLimit:100,pointer1:null,pointer2:null,pointer3:null,pointer4:null,pointer5:null,pointer6:null,pointer7:null,pointer8:null,pointer9:null,pointer10:null,activePointer:null,mousePointer:null,mouse:null,keyboard:null,touch:null,mspointer:null,onDown:null,onUp:null,onTap:null,onHold:null,interactiveItems:new n.LinkedList,boot:function(){this.mousePointer=new n.Pointer(this.game,0),this.pointer1=new n.Pointer(this.game,1),this.pointer2=new n.Pointer(this.game,2),this.mouse=new n.Mouse(this.game),this.keyboard=new n.Keyboard(this.game),this.touch=new n.Touch(this.game),this.mspointer=new n.MSPointer(this.game),this.onDown=new n.Signal,this.onUp=new n.Signal,this.onTap=new n.Signal,this.onHold=new n.Signal,this.scale=new n.Point(1,1),this.speed=new n.Point,this.position=new n.Point,this._oldPosition=new n.Point,this.circle=new n.Circle(0,0,44),this.activePointer=this.mousePointer,this.currentPointers=0,this.hitCanvas=document.createElement("canvas"),this.hitCanvas.width=1,this.hitCanvas.height=1,this.hitContext=this.hitCanvas.getContext("2d"),this.mouse.start(),this.keyboard.start(),this.touch.start(),this.mspointer.start(),this.mousePointer.active=!0},destroy:function(){this.mouse.stop(),this.keyboard.stop(),this.touch.stop(),this.mspointer.stop()},addPointer:function(){for(var t=0,i=10;i>0;i--)this["pointer"+i]===null&&(t=i);return t==0?(console.warn("You can only have 10 Pointer objects"),null):(this["pointer"+t]=new n.Pointer(this.game,t),this["pointer"+t])},update:function(){if(this.pollRate>0&&this._pollCounter<this.pollRate){this._pollCounter++;return}this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.pointer1.update(),this.pointer2.update(),this.pointer3&&this.pointer3.update(),this.pointer4&&this.pointer4.update(),this.pointer5&&this.pointer5.update(),this.pointer6&&this.pointer6.update(),this.pointer7&&this.pointer7.update(),this.pointer8&&this.pointer8.update(),this.pointer9&&this.pointer9.update(),this.pointer10&&this.pointer10.update(),this._pollCounter=0},reset:function(t){if(this.game.isBooted!=!1){typeof t=="undefined"&&(t=!1),this.keyboard.reset(),this.mousePointer.reset();for(var i=1;i<=10;i++)this["pointer"+i]&&this["pointer"+i].reset();this.currentPointers=0,this.game.stage.canvas.style.cursor="default",t==!0&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new n.Signal,this.onUp=new n.Signal,this.onTap=new n.Signal,this.onHold=new n.Signal,this.interactiveItems.callAll("reset")),this._pollCounter=0}},resetSpeed:function(n,t){this._oldPosition.setTo(n,t),this.speed.setTo(0,0)},startPointer:function(n){if(this.maxPointers<10&&this.totalActivePointers==this.maxPointers)return null;if(this.pointer1.active==!1)return this.pointer1.start(n);if(this.pointer2.active==!1)return this.pointer2.start(n);for(var t=3;t<=10;t++)if(this["pointer"+t]&&this["pointer"+t].active==!1)return this["pointer"+t].start(n);return null},updatePointer:function(n){if(this.pointer1.active&&this.pointer1.identifier==n.identifier)return this.pointer1.move(n);if(this.pointer2.active&&this.pointer2.identifier==n.identifier)return this.pointer2.move(n);for(var t=3;t<=10;t++)if(this["pointer"+t]&&this["pointer"+t].active&&this["pointer"+t].identifier==n.identifier)return this["pointer"+t].move(n);return null},stopPointer:function(n){if(this.pointer1.active&&this.pointer1.identifier==n.identifier)return this.pointer1.stop(n);if(this.pointer2.active&&this.pointer2.identifier==n.identifier)return this.pointer2.stop(n);for(var t=3;t<=10;t++)if(this["pointer"+t]&&this["pointer"+t].active&&this["pointer"+t].identifier==n.identifier)return this["pointer"+t].stop(n);return null},getPointer:function(n){if(n=n||!1,this.pointer1.active==n)return this.pointer1;if(this.pointer2.active==n)return this.pointer2;for(var t=3;t<=10;t++)if(this["pointer"+t]&&this["pointer"+t].active==n)return this["pointer"+t];return null},getPointerFromIdentifier:function(n){if(this.pointer1.identifier==n)return this.pointer1;if(this.pointer2.identifier==n)return this.pointer2;for(var t=3;t<=10;t++)if(this["pointer"+t]&&this["pointer"+t].identifier==n)return this["pointer"+t];return null}},Object.defineProperty(n.Input.prototype,"x",{get:function(){return this._x},set:function(n){this._x=Math.floor(n)}}),Object.defineProperty(n.Input.prototype,"y",{get:function(){return this._y},set:function(n){this._y=Math.floor(n)}}),Object.defineProperty(n.Input.prototype,"pollLocked",{get:function(){return this.pollRate>0&&this._pollCounter<this.pollRate}}),Object.defineProperty(n.Input.prototype,"totalInactivePointers",{get:function(){return 10-this.currentPointers}}),Object.defineProperty(n.Input.prototype,"totalActivePointers",{get:function(){this.currentPointers=0;for(var n=1;n<=10;n++)this["pointer"+n]&&this["pointer"+n].active&&this.currentPointers++;return this.currentPointers}}),Object.defineProperty(n.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}}),Object.defineProperty(n.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}}),n.Key=function(t,i){this.game=t,this.isDown=!1,this.isUp=!1,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this.keyCode=i,this.onDown=new n.Signal,this.onUp=new n.Signal},n.Key.prototype={processKeyDown:function(n){this.altKey=n.altKey,this.ctrlKey=n.ctrlKey,this.shiftKey=n.shiftKey,this.isDown?(this.duration=n.timeStamp-this.timeDown,this.repeats++):(this.isDown=!0,this.isUp=!1,this.timeDown=n.timeStamp,this.duration=0,this.repeats=0,this.onDown.dispatch(this))},processKeyUp:function(n){this.isDown=!1,this.isUp=!0,this.timeUp=n.timeStamp,this.onUp.dispatch(this)},justPressed:function(n){return typeof n=="undefined"&&(n=250),this.isDown&&this.duration<n},justReleased:function(n){return typeof n=="undefined"&&(n=250),this.isDown==!1&&this.game.time.now-this.timeUp<n}},n.Keyboard=function(n){this.game=n,this._keys={},this._hotkeys={},this._capture={},this.disabled=!1,this._onKeyDown=null,this._onKeyUp=null,this.callbackContext=this,this.onDownCallback=null,this.onUpCallback=null},n.Keyboard.prototype={addCallbacks:function(n,t,i){this.callbackContext=n,this.onDownCallback=t,typeof i!="undefined"&&(this.onUpCallback=i)},addKey:function(t){return this._hotkeys[t]=new n.Key(this.game,t),this.addKeyCapture(t),this._hotkeys[t]},removeKey:function(n){delete this._hotkeys[n]},createCursorKeys:function(){return{up:this.addKey(n.Keyboard.UP),down:this.addKey(n.Keyboard.DOWN),left:this.addKey(n.Keyboard.LEFT),right:this.addKey(n.Keyboard.RIGHT)}},start:function(){var n=this;this._onKeyDown=function(t){return n.processKeyDown(t)},this._onKeyUp=function(t){return n.processKeyUp(t)},document.body.addEventListener("keydown",this._onKeyDown,!1),document.body.addEventListener("keyup",this._onKeyUp,!1)},stop:function(){document.body.removeEventListener("keydown",this._onKeyDown),document.body.removeEventListener("keyup",this._onKeyUp)},addKeyCapture:function(n){if(typeof n=="object")for(var t in n)this._capture[n[t]]=!0;else this._capture[n]=!0},removeKeyCapture:function(n){delete this._capture[n]},clearCaptures:function(){this._capture={}},processKeyDown:function(n){this.game.input.disabled||this.disabled||(this._capture[n.keyCode]&&n.preventDefault(),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,n),this._keys[n.keyCode]&&this._keys[n.keyCode].isDown?this._keys[n.keyCode].duration=this.game.time.now-this._keys[n.keyCode].timeDown:this._keys[n.keyCode]?(this._keys[n.keyCode].isDown=!0,this._keys[n.keyCode].timeDown=this.game.time.now,this._keys[n.keyCode].duration=0):this._keys[n.keyCode]={isDown:!0,timeDown:this.game.time.now,timeUp:0,duration:0},this._hotkeys[n.keyCode]&&this._hotkeys[n.keyCode].processKeyDown(n))},processKeyUp:function(n){this.game.input.disabled||this.disabled||(this._capture[n.keyCode]&&n.preventDefault(),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,n),this._hotkeys[n.keyCode]&&this._hotkeys[n.keyCode].processKeyUp(n),this._keys[n.keyCode]?(this._keys[n.keyCode].isDown=!1,this._keys[n.keyCode].timeUp=this.game.time.now):this._keys[n.keyCode]={isDown:!1,timeDown:this.game.time.now,timeUp:this.game.time.now,duration:0})},reset:function(){for(var n in this._keys)this._keys[n].isDown=!1},justPressed:function(n,t){return(typeof t=="undefined"&&(t=250),this._keys[n]&&this._keys[n].isDown&&this._keys[n].duration<t)?!0:!1},justReleased:function(n,t){return(typeof t=="undefined"&&(t=250),this._keys[n]&&this._keys[n].isDown===!1&&this.game.time.now-this._keys[n].timeUp<t)?!0:!1},isDown:function(n){return this._keys[n]?this._keys[n].isDown:!1}},n.Keyboard.A="A".charCodeAt(0),n.Keyboard.B="B".charCodeAt(0),n.Keyboard.C="C".charCodeAt(0),n.Keyboard.D="D".charCodeAt(0),n.Keyboard.E="E".charCodeAt(0),n.Keyboard.F="F".charCodeAt(0),n.Keyboard.G="G".charCodeAt(0),n.Keyboard.H="H".charCodeAt(0),n.Keyboard.I="I".charCodeAt(0),n.Keyboard.J="J".charCodeAt(0),n.Keyboard.K="K".charCodeAt(0),n.Keyboard.L="L".charCodeAt(0),n.Keyboard.M="M".charCodeAt(0),n.Keyboard.N="N".charCodeAt(0),n.Keyboard.O="O".charCodeAt(0),n.Keyboard.P="P".charCodeAt(0),n.Keyboard.Q="Q".charCodeAt(0),n.Keyboard.R="R".charCodeAt(0),n.Keyboard.S="S".charCodeAt(0),n.Keyboard.T="T".charCodeAt(0),n.Keyboard.U="U".charCodeAt(0),n.Keyboard.V="V".charCodeAt(0),n.Keyboard.W="W".charCodeAt(0),n.Keyboard.X="X".charCodeAt(0),n.Keyboard.Y="Y".charCodeAt(0),n.Keyboard.Z="Z".charCodeAt(0),n.Keyboard.ZERO="0".charCodeAt(0),n.Keyboard.ONE="1".charCodeAt(0),n.Keyboard.TWO="2".charCodeAt(0),n.Keyboard.THREE="3".charCodeAt(0),n.Keyboard.FOUR="4".charCodeAt(0),n.Keyboard.FIVE="5".charCodeAt(0),n.Keyboard.SIX="6".charCodeAt(0),n.Keyboard.SEVEN="7".charCodeAt(0),n.Keyboard.EIGHT="8".charCodeAt(0),n.Keyboard.NINE="9".charCodeAt(0),n.Keyboard.NUMPAD_0=96,n.Keyboard.NUMPAD_1=97,n.Keyboard.NUMPAD_2=98,n.Keyboard.NUMPAD_3=99,n.Keyboard.NUMPAD_4=100,n.Keyboard.NUMPAD_5=101,n.Keyboard.NUMPAD_6=102,n.Keyboard.NUMPAD_7=103,n.Keyboard.NUMPAD_8=104,n.Keyboard.NUMPAD_9=105,n.Keyboard.NUMPAD_MULTIPLY=106,n.Keyboard.NUMPAD_ADD=107,n.Keyboard.NUMPAD_ENTER=108,n.Keyboard.NUMPAD_SUBTRACT=109,n.Keyboard.NUMPAD_DECIMAL=110,n.Keyboard.NUMPAD_DIVIDE=111,n.Keyboard.F1=112,n.Keyboard.F2=113,n.Keyboard.F3=114,n.Keyboard.F4=115,n.Keyboard.F5=116,n.Keyboard.F6=117,n.Keyboard.F7=118,n.Keyboard.F8=119,n.Keyboard.F9=120,n.Keyboard.F10=121,n.Keyboard.F11=122,n.Keyboard.F12=123,n.Keyboard.F13=124,n.Keyboard.F14=125,n.Keyboard.F15=126,n.Keyboard.COLON=186,n.Keyboard.EQUALS=187,n.Keyboard.UNDERSCORE=189,n.Keyboard.QUESTION_MARK=191,n.Keyboard.TILDE=192,n.Keyboard.OPEN_BRACKET=219,n.Keyboard.BACKWARD_SLASH=220,n.Keyboard.CLOSED_BRACKET=221,n.Keyboard.QUOTES=222,n.Keyboard.BACKSPACE=8,n.Keyboard.TAB=9,n.Keyboard.CLEAR=12,n.Keyboard.ENTER=13,n.Keyboard.SHIFT=16,n.Keyboard.CONTROL=17,n.Keyboard.ALT=18,n.Keyboard.CAPS_LOCK=20,n.Keyboard.ESC=27,n.Keyboard.SPACEBAR=32,n.Keyboard.PAGE_UP=33,n.Keyboard.PAGE_DOWN=34,n.Keyboard.END=35,n.Keyboard.HOME=36,n.Keyboard.LEFT=37,n.Keyboard.UP=38,n.Keyboard.RIGHT=39,n.Keyboard.DOWN=40,n.Keyboard.INSERT=45,n.Keyboard.DELETE=46,n.Keyboard.HELP=47,n.Keyboard.NUM_LOCK=144,n.Mouse=function(n){this.game=n,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseMoveCallback=null,this.mouseUpCallback=null,this.disabled=!1,this.locked=!1},n.Mouse.LEFT_BUTTON=0,n.Mouse.MIDDLE_BUTTON=1,n.Mouse.RIGHT_BUTTON=2,n.Mouse.prototype={start:function(){var n=this;this.game.device.android&&this.game.device.chrome==!1||(this._onMouseDown=function(t){return n.onMouseDown(t)},this._onMouseMove=function(t){return n.onMouseMove(t)},this._onMouseUp=function(t){return n.onMouseUp(t)},this.game.renderer.view.addEventListener("mousedown",this._onMouseDown,!0),this.game.renderer.view.addEventListener("mousemove",this._onMouseMove,!0),this.game.renderer.view.addEventListener("mouseup",this._onMouseUp,!0))},onMouseDown:function(n){(n.preventDefault(),this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,n),this.game.input.disabled||this.disabled)||(n.identifier=0,this.game.input.mousePointer.start(n))},onMouseMove:function(n){(n.preventDefault(),this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,n),this.game.input.disabled||this.disabled)||(n.identifier=0,this.game.input.mousePointer.move(n))},onMouseUp:function(n){(n.preventDefault(),this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,n),this.game.input.disabled||this.disabled)||(n.identifier=0,this.game.input.mousePointer.stop(n))},requestPointerLock:function(){var n,t;this.game.device.pointerLock&&(n=this.game.stage.canvas,n.requestPointerLock=n.requestPointerLock||n.mozRequestPointerLock||n.webkitRequestPointerLock,n.requestPointerLock(),t=this,this._pointerLockChange=function(n){return t.pointerLockChange(n)},document.addEventListener("pointerlockchange",this._pointerLockChange,!1),document.addEventListener("mozpointerlockchange",this._pointerLockChange,!1),document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!1))},pointerLockChange:function(){var n=this.game.stage.canvas;this.locked=document.pointerLockElement===n||document.mozPointerLockElement===n||document.webkitPointerLockElement===n?!0:!1},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock(),document.removeEventListener("pointerlockchange",this._pointerLockChange),document.removeEventListener("mozpointerlockchange",this._pointerLockChange),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange)},stop:function(){this.game.stage.canvas.removeEventListener("mousedown",this._onMouseDown),this.game.stage.canvas.removeEventListener("mousemove",this._onMouseMove),this.game.stage.canvas.removeEventListener("mouseup",this._onMouseUp)}},n.MSPointer=function(n){this.game=n,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseMoveCallback=null,this.mouseUpCallback=null,this.disabled=!1,this._onMSPointerDown=null,this._onMSPointerMove=null,this._onMSPointerUp=null},n.MSPointer.prototype={start:function(){var n=this;this.game.device.mspointer==!0&&(this._onMSPointerDown=function(t){return n.onPointerDown(t)},this._onMSPointerMove=function(t){return n.onPointerMove(t)},this._onMSPointerUp=function(t){return n.onPointerUp(t)},this.game.renderer.view.addEventListener("MSPointerDown",this._onMSPointerDown,!1),this.game.renderer.view.addEventListener("MSPointerMove",this._onMSPointerMove,!1),this.game.renderer.view.addEventListener("MSPointerUp",this._onMSPointerUp,!1),this.game.renderer.view.style["-ms-content-zooming"]="none",this.game.renderer.view.style["-ms-touch-action"]="none")},onPointerDown:function(n){this.game.input.disabled||this.disabled||(n.preventDefault(),n.identifier=n.pointerId,this.game.input.startPointer(n))},onPointerMove:function(n){this.game.input.disabled||this.disabled||(n.preventDefault(),n.identifier=n.pointerId,this.game.input.updatePointer(n))},onPointerUp:function(n){this.game.input.disabled||this.disabled||(n.preventDefault(),n.identifier=n.pointerId,this.game.input.stopPointer(n))},stop:function(){this.game.stage.canvas.removeEventListener("MSPointerDown",this._onMSPointerDown),this.game.stage.canvas.removeEventListener("MSPointerMove",this._onMSPointerMove),this.game.stage.canvas.removeEventListener("MSPointerUp",this._onMSPointerUp)}},n.Pointer=function(t,i){this.game=t,this.id=i,this._holdSent=!1,this._history=[],this._nextDrop=0,this._stateReset=!1,this.positionDown=null,this.position=null,this.circle=null,this.withinGame=!1,this.clientX=-1,this.clientY=-1,this.pageX=-1,this.pageY=-1,this.screenX=-1,this.screenY=-1,this.x=-1,this.y=-1,this.isMouse=!1,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.previousTapTime=0,this.totalTouches=0,this.msSinceLastClick=Number.MAX_VALUE,this.targetObject=null,this.active=!1,this.position=new n.Point,this.positionDown=new n.Point,this.circle=new n.Circle(0,0,44),i==0&&(this.isMouse=!0)},n.Pointer.prototype={start:function(t){return(this.identifier=t.identifier,this.target=t.target,typeof t.button!="undefined"&&(this.button=t.button),this.game.paused==!0&&this.game.stage.scale.incorrectOrientation==!1)?(this.game.paused=!1,this):(this._history.length=0,this.active=!0,this.withinGame=!0,this.isDown=!0,this.isUp=!1,this.msSinceLastClick=this.game.time.now-this.timeDown,this.timeDown=this.game.time.now,this._holdSent=!1,this.move(t),this.positionDown.setTo(this.x,this.y),(this.game.input.multiInputOverride==n.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride==n.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride==n.Input.TOUCH_OVERRIDES_MOUSE&&this.game.input.currentPointers==0)&&(this.game.input.x=this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.x,this.y),this.game.input.onDown.dispatch(this,t),this.game.input.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,this.isMouse==!1&&this.game.input.currentPointers++,this.targetObject!==null&&this.targetObject._touchedHandler(this),this)},update:function(){this.active&&(this._holdSent==!1&&this.duration>=this.game.input.holdRate&&((this.game.input.multiInputOverride==n.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride==n.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride==n.Input.TOUCH_OVERRIDES_MOUSE&&this.game.input.currentPointers==0)&&this.game.input.onHold.dispatch(this),this._holdSent=!0),this.game.input.recordPointerHistory&&this.game.time.now>=this._nextDrop&&(this._nextDrop=this.game.time.now+this.game.input.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>this.game.input.recordLimit&&this._history.shift()))},move:function(t){if(!this.game.input.pollLocked){if(typeof t.button!="undefined"&&(this.button=t.button),this.clientX=t.clientX,this.clientY=t.clientY,this.pageX=t.pageX,this.pageY=t.pageY,this.screenX=t.screenX,this.screenY=t.screenY,this.x=(this.pageX-this.game.stage.offset.x)*this.game.input.scale.x,this.y=(this.pageY-this.game.stage.offset.y)*this.game.input.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(this.game.input.multiInputOverride==n.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride==n.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride==n.Input.TOUCH_OVERRIDES_MOUSE&&this.game.input.currentPointers==0)&&(this.game.input.activePointer=this,this.game.input.x=this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.game.input.x,this.game.input.y),this.game.input.circle.x=this.game.input.x,this.game.input.circle.y=this.game.input.y),this.game.paused)return this;if(this.targetObject!==null&&this.targetObject.isDragged==!0)return this.targetObject.update(this)==!1&&(this.targetObject=null),this;if(this._highestRenderOrderID=-1,this._highestRenderObject=null,this._highestInputPriorityID=-1,this.game.input.interactiveItems.total>0){var i=this.game.input.interactiveItems.next;do(i.pixelPerfect||i.priorityID>this._highestInputPriorityID||i.priorityID==this._highestInputPriorityID&&i.sprite.renderOrderID>this._highestRenderOrderID)&&i.checkPointerOver(this)&&(this._highestRenderOrderID=i.sprite.renderOrderID,this._highestInputPriorityID=i.priorityID,this._highestRenderObject=i),i=i.next;while(i!=null)}return this._highestRenderObject==null?this.targetObject&&(this.targetObject._pointerOutHandler(this),this.targetObject=null):this.targetObject==null?(this.targetObject=this._highestRenderObject,this._highestRenderObject._pointerOverHandler(this)):this.targetObject==this._highestRenderObject?this._highestRenderObject.update(this)==!1&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this),this.targetObject=this._highestRenderObject,this.targetObject._pointerOverHandler(this)),this}},leave:function(n){this.withinGame=!1,this.move(n)},stop:function(t){if(this._stateReset){t.preventDefault();return}if(this.timeUp=this.game.time.now,(this.game.input.multiInputOverride==n.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride==n.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride==n.Input.TOUCH_OVERRIDES_MOUSE&&this.game.input.currentPointers==0)&&(this.game.input.onUp.dispatch(this,t),this.duration>=0&&this.duration<=this.game.input.tapRate&&(this.timeUp-this.previousTapTime<this.game.input.doubleTapRate?this.game.input.onTap.dispatch(this,!0):this.game.input.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),this.id>0&&(this.active=!1),this.withinGame=!1,this.isDown=!1,this.isUp=!0,this.isMouse==!1&&this.game.input.currentPointers--,this.game.input.interactiveItems.total>0){var i=this.game.input.interactiveItems.next;do i&&i._releasedHandler(this),i=i.next;while(i!=null)}return this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null,this},justPressed:function(n){return n=n||this.game.input.justPressedRate,this.isDown===!0&&this.timeDown+n>this.game.time.now},justReleased:function(n){return n=n||this.game.input.justReleasedRate,this.isUp===!0&&this.timeUp+n>this.game.time.now},reset:function(){this.isMouse==!1&&(this.active=!1),this.identifier=null,this.isDown=!1,this.isUp=!0,this.totalTouches=0,this._holdSent=!1,this._history.length=0,this._stateReset=!0,this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null},toString:function(){return"[{Pointer (id="+this.id+" identifer="+this.identifier+" active="+this.active+" duration="+this.duration+" withinGame="+this.withinGame+" x="+this.x+" y="+this.y+" clientX="+this.clientX+" clientY="+this.clientY+" screenX="+this.screenX+" screenY="+this.screenY+" pageX="+this.pageX+" pageY="+this.pageY+")}]"}},Object.defineProperty(n.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.now-this.timeDown}}),Object.defineProperty(n.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}}),Object.defineProperty(n.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}}),n.Touch=function(n){this.game=n,this.disabled=!1,this.callbackContext=this.game,this.touchStartCallback=null,this.touchMoveCallback=null,this.touchEndCallback=null,this.touchEnterCallback=null,this.touchLeaveCallback=null,this.touchCancelCallback=null,this.preventDefault=!0,this._onTouchStart=null,this._onTouchMove=null,this._onTouchEnd=null,this._onTouchEnter=null,this._onTouchLeave=null,this._onTouchCancel=null,this._onTouchMove=null},n.Touch.prototype={start:function(){var n=this;this.game.device.touch&&(this._onTouchStart=function(t){return n.onTouchStart(t)},this._onTouchMove=function(t){return n.onTouchMove(t)},this._onTouchEnd=function(t){return n.onTouchEnd(t)},this._onTouchEnter=function(t){return n.onTouchEnter(t)},this._onTouchLeave=function(t){return n.onTouchLeave(t)},this._onTouchCancel=function(t){return n.onTouchCancel(t)},this.game.renderer.view.addEventListener("touchstart",this._onTouchStart,!1),this.game.renderer.view.addEventListener("touchmove",this._onTouchMove,!1),this.game.renderer.view.addEventListener("touchend",this._onTouchEnd,!1),this.game.renderer.view.addEventListener("touchenter",this._onTouchEnter,!1),this.game.renderer.view.addEventListener("touchleave",this._onTouchLeave,!1),this.game.renderer.view.addEventListener("touchcancel",this._onTouchCancel,!1))},consumeDocumentTouches:function(){this._documentTouchMove=function(n){n.preventDefault()},document.addEventListener("touchmove",this._documentTouchMove,!1)},onTouchStart:function(n){if(this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,n),!this.game.input.disabled&&!this.disabled){this.preventDefault&&n.preventDefault();for(var t=0;t<n.changedTouches.length;t++)this.game.input.startPointer(n.changedTouches[t])}},onTouchCancel:function(n){if(this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,n),!this.game.input.disabled&&!this.disabled){this.preventDefault&&n.preventDefault();for(var t=0;t<n.changedTouches.length;t++)this.game.input.stopPointer(n.changedTouches[t])}},onTouchEnter:function(n){if(this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,n),!this.game.input.disabled&&!this.disabled){this.preventDefault&&n.preventDefault();for(var t=0;t<n.changedTouches.length;t++);}},onTouchLeave:function(n){this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,n),this.preventDefault&&n.preventDefault();for(var t=0;t<n.changedTouches.length;t++);},onTouchMove:function(n){this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,n),this.preventDefault&&n.preventDefault();for(var t=0;t<n.changedTouches.length;t++)this.game.input.updatePointer(n.changedTouches[t])},onTouchEnd:function(n){this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,n),this.preventDefault&&n.preventDefault();for(var t=0;t<n.changedTouches.length;t++)this.game.input.stopPointer(n.changedTouches[t])},stop:function(){this.game.device.touch&&(this.game.stage.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.stage.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.stage.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.stage.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.stage.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.stage.canvas.removeEventListener("touchcancel",this._onTouchCancel))}},n.InputHandler=function(t){this.sprite=t,this.game=t.game,this.enabled=!1,this.parent=null,this.next=null,this.prev=null,this.last=this,this.first=this,this.priorityID=0,this.useHandCursor=!1,this.isDragged=!1,this.allowHorizontalDrag=!0,this.allowVerticalDrag=!0,this.bringToTop=!1,this.snapOffset=null,this.snapOnDrag=!1,this.snapOnRelease=!1,this.snapX=0,this.snapY=0,this.pixelPerfect=!1,this.pixelPerfectAlpha=255,this.draggable=!1,this.boundsRect=null,this.boundsSprite=null,this.consumePointerEvent=!1,this._tempPoint=new n.Point,this._pointerData=[],this._pointerData.push({id:0,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})},n.InputHandler.prototype={start:function(t,i){if(t=t||0,typeof i=="undefined"&&(i=!1),this.enabled==!1){this.game.input.interactiveItems.add(this),this.useHandCursor=i,this.priorityID=t;for(var r=0;r<10;r++)this._pointerData[r]={id:r,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new n.Point,this.enabled=!0,this.sprite.events&&this.sprite.events.onInputOver==null&&(this.sprite.events.onInputOver=new n.Signal,this.sprite.events.onInputOut=new n.Signal,this.sprite.events.onInputDown=new n.Signal,this.sprite.events.onInputUp=new n.Signal,this.sprite.events.onDragStart=new n.Signal,this.sprite.events.onDragStop=new n.Signal)}return this.sprite},reset:function(){this.enabled=!1;for(var n=0;n<10;n++)this._pointerData[n]={id:n,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){this.enabled!=!1&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this),this.stop(),this.sprite=null)},pointerX:function(n){return n=n||0,this._pointerData[n].x},pointerY:function(n){return n=n||0,this._pointerData[n].y},pointerDown:function(n){return n=n||0,this._pointerData[n].isDown},pointerUp:function(n){return n=n||0,this._pointerData[n].isUp},pointerTimeDown:function(n){return n=n||0,this._pointerData[n].timeDown},pointerTimeUp:function(n){return n=n||0,this._pointerData[n].timeUp},pointerOver:function(n){return n=n||0,this._pointerData[n].isOver},pointerOut:function(n){return n=n||0,this._pointerData[n].isOut},pointerTimeOver:function(n){return n=n||0,this._pointerData[n].timeOver},pointerTimeOut:function(n){return n=n||0,this._pointerData[n].timeOut},pointerDragged:function(n){return n=n||0,this._pointerData[n].isDragged},checkPointerOver:function(n){return this.enabled&&this.sprite.visible&&(this.sprite.getLocalUnmodifiedPosition(this._tempPoint,n.x,n.y),this._tempPoint.x>=0&&this._tempPoint.x<=this.sprite.currentFrame.width&&this._tempPoint.y>=0&&this._tempPoint.y<=this.sprite.currentFrame.height)?this.pixelPerfect?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0:!1},checkPixel:function(n,t){if(this.sprite.texture.baseTexture.source){this.game.input.hitContext.clearRect(0,0,1,1),n+=this.sprite.texture.frame.x,t+=this.sprite.texture.frame.y,this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,n,t,1,1,0,0,1,1);var i=this.game.input.hitContext.getImageData(0,0,1,1);if(i.data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(n){return this.enabled==!1||this.sprite.visible==!1||this.sprite.group&&this.sprite.group.visible==!1?(this._pointerOutHandler(n),!1):this.draggable&&this._draggedPointerID==n.id?this.updateDrag(n):this._pointerData[n.id].isOver==!0?this.checkPointerOver(n)?(this._pointerData[n.id].x=n.x-this.sprite.x,this._pointerData[n.id].y=n.y-this.sprite.y,!0):(this._pointerOutHandler(n),!1):void 0},_pointerOverHandler:function(n){this._pointerData[n.id].isOver==!1&&(this._pointerData[n.id].isOver=!0,this._pointerData[n.id].isOut=!1,this._pointerData[n.id].timeOver=this.game.time.now,this._pointerData[n.id].x=n.x-this.sprite.x,this._pointerData[n.id].y=n.y-this.sprite.y,this.useHandCursor&&this._pointerData[n.id].isDragged==!1&&(this.game.stage.canvas.style.cursor="pointer"),this.sprite.events.onInputOver.dispatch(this.sprite,n))},_pointerOutHandler:function(n){this._pointerData[n.id].isOver=!1,this._pointerData[n.id].isOut=!0,this._pointerData[n.id].timeOut=this.game.time.now,this.useHandCursor&&this._pointerData[n.id].isDragged==!1&&(this.game.stage.canvas.style.cursor="default"),this.sprite&&this.sprite.events&&this.sprite.events.onInputOut.dispatch(this.sprite,n)},_touchedHandler:function(n){return this._pointerData[n.id].isDown==!1&&this._pointerData[n.id].isOver==!0&&(this._pointerData[n.id].isDown=!0,this._pointerData[n.id].isUp=!1,this._pointerData[n.id].timeDown=this.game.time.now,this.sprite.events.onInputDown.dispatch(this.sprite,n),this.draggable&&this.isDragged==!1&&this.startDrag(n),this.bringToTop&&this.sprite.bringToTop()),this.consumePointerEvent},_releasedHandler:function(n){this._pointerData[n.id].isDown&&n.isUp&&(this._pointerData[n.id].isDown=!1,this._pointerData[n.id].isUp=!0,this._pointerData[n.id].timeUp=this.game.time.now,this._pointerData[n.id].downDuration=this._pointerData[n.id].timeUp-this._pointerData[n.id].timeDown,this.checkPointerOver(n)?this.sprite.events.onInputUp.dispatch(this.sprite,n):this.useHandCursor&&(this.game.stage.canvas.style.cursor="default"),this.draggable&&this.isDragged&&this._draggedPointerID==n.id&&this.stopDrag(n))},updateDrag:function(n){return n.isUp?(this.stopDrag(n),!1):(this.allowHorizontalDrag&&(this.sprite.x=n.x+this._dragPoint.x+this.dragOffset.x),this.allowVerticalDrag&&(this.sprite.y=n.y+this._dragPoint.y+this.dragOffset.y),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round(this.sprite.x/this.snapX)*this.snapX,this.sprite.y=Math.round(this.sprite.y/this.snapY)*this.snapY),!0)},justOver:function(n,t){return n=n||0,t=t||500,this._pointerData[n].isOver&&this.overDuration(n)<t},justOut:function(n,t){return n=n||0,t=t||500,this._pointerData[n].isOut&&this.game.time.now-this._pointerData[n].timeOut<t},justPressed:function(n,t){return n=n||0,t=t||500,this._pointerData[n].isDown&&this.downDuration(n)<t},justReleased:function(n,t){return n=n||0,t=t||500,this._pointerData[n].isUp&&this.game.time.now-this._pointerData[n].timeUp<t},overDuration:function(n){return(n=n||0,this._pointerData[n].isOver)?this.game.time.now-this._pointerData[n].timeOver:-1},downDuration:function(n){return(n=n||0,this._pointerData[n].isDown)?this.game.time.now-this._pointerData[n].timeDown:-1},enableDrag:function(t,i,r,u,f,e){typeof t=="undefined"&&(t=!1),typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r=!1),u=u||255,f=f||null,e=e||null,this._dragPoint=new n.Point,this.draggable=!0,this.bringToTop=i,this.dragOffset=new n.Point,this.dragFromCenter=t,this.pixelPerfect=r,this.pixelPerfectAlpha=u,f&&(this.boundsRect=f),e&&(this.boundsSprite=e)},disableDrag:function(){if(this._pointerData)for(var n=0;n<10;n++)this._pointerData[n].isDragged=!1;this.draggable=!1,this.isDragged=!1,this._draggedPointerID=-1},startDrag:function(n){this.isDragged=!0,this._draggedPointerID=n.id,this._pointerData[n.id].isDragged=!0,this.dragFromCenter?(this.sprite.centerOn(n.x,n.y),this._dragPoint.setTo(this.sprite.x-n.x,this.sprite.y-n.y)):this._dragPoint.setTo(this.sprite.x-n.x,this.sprite.y-n.y),this.updateDrag(n),this.bringToTop&&this.sprite.bringToTop(),this.sprite.events.onDragStart.dispatch(this.sprite,n)},stopDrag:function(n){this.isDragged=!1,this._draggedPointerID=-1,this._pointerData[n.id].isDragged=!1,this.snapOnRelease&&(this.sprite.x=Math.round(this.sprite.x/this.snapX)*this.snapX,this.sprite.y=Math.round(this.sprite.y/this.snapY)*this.snapY),this.sprite.events.onDragStop.dispatch(this.sprite,n),this.sprite.events.onInputUp.dispatch(this.sprite,n),this.checkPointerOver(n)==!1&&this._pointerOutHandler(n)},setDragLock:function(n,t){typeof n=="undefined"&&(n=!0),typeof t=="undefined"&&(t=!0),this.allowHorizontalDrag=n,this.allowVerticalDrag=t},enableSnap:function(n,t,i,r){typeof i=="undefined"&&(i=!0),typeof r=="undefined"&&(r=!1),this.snapX=n,this.snapY=t,this.snapOnDrag=i,this.snapOnRelease=r},disableSnap:function(){this.snapOnDrag=!1,this.snapOnRelease=!1},checkBoundsRect:function(){this.sprite.x<this.boundsRect.left?this.sprite.x=this.boundsRect.x:this.sprite.x+this.sprite.width>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-this.sprite.width),this.sprite.y<this.boundsRect.top?this.sprite.y=this.boundsRect.top:this.sprite.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-this.sprite.height)},checkBoundsSprite:function(){this.sprite.x<this.boundsSprite.x?this.sprite.x=this.boundsSprite.x:this.sprite.x+this.sprite.width>this.boundsSprite.x+this.boundsSprite.width&&(this.sprite.x=this.boundsSprite.x+this.boundsSprite.width-this.sprite.width),this.sprite.y<this.boundsSprite.y?this.sprite.y=this.boundsSprite.y:this.sprite.y+this.sprite.height>this.boundsSprite.y+this.boundsSprite.height&&(this.sprite.y=this.boundsSprite.y+this.boundsSprite.height-this.sprite.height)}},n.Events=function(t){this.parent=t,this.onAddedToGroup=new n.Signal,this.onRemovedFromGroup=new n.Signal,this.onKilled=new n.Signal,this.onRevived=new n.Signal,this.onOutOfBounds=new n.Signal,this.onInputOver=null,this.onInputOut=null,this.onInputDown=null,this.onInputUp=null,this.onDragStart=null,this.onDragStop=null,this.onAnimationStart=null,this.onAnimationComplete=null,this.onAnimationLoop=null},n.Events.prototype={destroy:function(){this.parent=null,this.onAddedToGroup.dispose(),this.onRemovedFromGroup.dispose(),this.onKilled.dispose(),this.onRevived.dispose(),this.onOutOfBounds.dispose(),this.onInputOver&&(this.onInputOver.dispose(),this.onInputOut.dispose(),this.onInputDown.dispose(),this.onInputUp.dispose(),this.onDragStart.dispose(),this.onDragStop.dispose()),this.onAnimationStart&&(this.onAnimationStart.dispose(),this.onAnimationComplete.dispose(),this.onAnimationLoop.dispose())}},n.GameObjectFactory=function(n){this.game=n,this.world=this.game.world},n.GameObjectFactory.prototype={existing:function(n){return this.world.add(n)},sprite:function(n,t,i,r){return this.world.create(n,t,i,r)},child:function(n,t,i,r,u){return n.create(t,i,r,u)},tween:function(n){return this.game.tweens.create(n)},group:function(t,i){return new n.Group(this.game,t,i)},audio:function(n,t,i){return this.game.sound.add(n,t,i)},tileSprite:function(t,i,r,u,f,e){return this.world.add(new n.TileSprite(this.game,t,i,r,u,f,e))},text:function(t,i,r,u){return this.world.add(new n.Text(this.game,t,i,r,u))},button:function(t,i,r,u,f,e,o,s){return this.world.add(new n.Button(this.game,t,i,r,u,f,e,o,s))},graphics:function(t,i){return this.world.add(new n.Graphics(this.game,t,i))},emitter:function(t,i,r){return this.game.particles.add(new n.Particles.Arcade.Emitter(this.game,t,i,r))},bitmapText:function(t,i,r,u){return this.world.add(new n.BitmapText(this.game,t,i,r,u))},tilemap:function(t){return new n.Tilemap(this.game,t)},tileset:function(n){return this.game.cache.getTileset(n)},tilemapLayer:function(t,i,r,u,f,e,o){return this.world.add(new n.TilemapLayer(this.game,t,i,r,u,f,e,o))},renderTexture:function(t,i,r){var u=new n.RenderTexture(this.game,t,i,r);return this.game.cache.addRenderTexture(t,u),u}},n.Sprite=function(i,r,u,f,e){r=r||0,u=u||0,f=f||null,e=e||null,this.game=i,this.exists=!0,this.alive=!0,this.group=null,this.name="",this.type=n.SPRITE,this.renderOrderID=-1,this.lifespan=0,this.events=new n.Events(this),this.animations=new n.AnimationManager(this),this.input=new n.InputHandler(this),this.key=f,this.currentFrame=null,f instanceof n.RenderTexture?(t.Sprite.call(this,f),this.currentFrame=this.game.cache.getTextureFrame(f.name)):f instanceof t.Texture?(t.Sprite.call(this,f),this.currentFrame=e):((f==null||this.game.cache.checkImageKey(f)==!1)&&(f="__default",this.key=f),t.Sprite.call(this,t.TextureCache[f]),this.game.cache.isSpriteSheet(f)?(this.animations.loadFrameData(this.game.cache.getFrameData(f)),e!==null&&(typeof e=="string"?this.frameName=e:this.frame=e)):this.currentFrame=this.game.cache.getFrame(f)),this.textureRegion=new n.Rectangle(this.texture.frame.x,this.texture.frame.y,this.texture.frame.width,this.texture.frame.height),this.anchor=new n.Point,this.x=r,this.y=u,this.position.x=r,this.position.y=u,this.world=new n.Point(r,u),this.autoCull=!1,this.scale=new n.Point(1,1),this._cache={dirty:!1,a00:-1,a01:-1,a02:-1,a10:-1,a11:-1,a12:-1,id:-1,i01:-1,i10:-1,idi:-1,left:null,right:null,top:null,bottom:null,prevX:r,prevY:u,x:-1,y:-1,scaleX:1,scaleY:1,width:this.currentFrame.sourceSizeW,height:this.currentFrame.sourceSizeH,halfWidth:Math.floor(this.currentFrame.sourceSizeW/2),halfHeight:Math.floor(this.currentFrame.sourceSizeH/2),calcWidth:-1,calcHeight:-1,frameID:-1,frameWidth:this.currentFrame.width,frameHeight:this.currentFrame.height,cameraVisible:!0,cropX:0,cropY:0,cropWidth:this.currentFrame.sourceSizeW,cropHeight:this.currentFrame.sourceSizeH},this.offset=new n.Point,this.center=new n.Point(r+Math.floor(this._cache.width/2),u+Math.floor(this._cache.height/2)),this.topLeft=new n.Point(r,u),this.topRight=new n.Point(r+this._cache.width,u),this.bottomRight=new n.Point(r+this._cache.width,u+this._cache.height),this.bottomLeft=new n.Point(r,u+this._cache.height),this.bounds=new n.Rectangle(r,u,this._cache.width,this._cache.height),this.body=new n.Physics.Arcade.Body(this),this.health=1,this.inWorld=n.Rectangle.intersects(this.bounds,this.game.world.bounds),this.inWorldThreshold=0,this.outOfBoundsKill=!1,this._outOfBoundsFired=!1,this.fixedToCamera=!1,this.cameraOffset=new n.Point,this.crop=new n.Rectangle(0,0,this._cache.width,this._cache.height),this.cropEnabled=!1,this.updateCache(),this.updateBounds()},n.Sprite.prototype=Object.create(t.Sprite.prototype),n.Sprite.prototype.constructor=n.Sprite,n.Sprite.prototype.preUpdate=function(){if(!this.exists){this.renderOrderID=-1;return}if(this.lifespan>0&&(this.lifespan-=this.game.time.elapsed,this.lifespan<=0)){this.kill();return}this._cache.dirty=!1,this.visible&&(this.renderOrderID=this.game.world.currentRenderOrderID++),this.updateCache(),this.updateAnimation(),this.updateCrop(),(this._cache.dirty||this.world.x!==this._cache.prevX||this.world.y!==this._cache.prevY)&&this.updateBounds(),this.body&&this.body.preUpdate()},n.Sprite.prototype.updateCache=function(){this._cache.prevX=this.world.x,this._cache.prevY=this.world.y,this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y),this.world.setTo(this.game.camera.x+this.worldTransform[2],this.game.camera.y+this.worldTransform[5]),(this.worldTransform[1]!=this._cache.i01||this.worldTransform[3]!=this._cache.i10||this.worldTransform[0]!=this._cache.a00||this.worldTransform[41]!=this._cache.a11)&&(this._cache.a00=this.worldTransform[0],this._cache.a01=this.worldTransform[1],this._cache.a10=this.worldTransform[3],this._cache.a11=this.worldTransform[4],this._cache.i01=this.worldTransform[1],this._cache.i10=this.worldTransform[3],this._cache.scaleX=Math.sqrt(this._cache.a00*this._cache.a00+this._cache.a01*this._cache.a01),this._cache.scaleY=Math.sqrt(this._cache.a10*this._cache.a10+this._cache.a11*this._cache.a11),this._cache.a01*=-1,this._cache.a10*=-1,this._cache.id=1/(this._cache.a00*this._cache.a11+this._cache.a01*-this._cache.a10),this._cache.idi=1/(this._cache.a00*this._cache.a11+this._cache.i01*-this._cache.i10),this._cache.dirty=!0),this._cache.a02=this.worldTransform[2],this._cache.a12=this.worldTransform[5]},n.Sprite.prototype.updateAnimation=function(){(this.animations.update()||this.currentFrame&&this.currentFrame.uuid!=this._cache.frameID)&&(this._cache.frameID=this.currentFrame.uuid,this._cache.frameWidth=this.texture.frame.width,this._cache.frameHeight=this.texture.frame.height,this._cache.width=this.currentFrame.width,this._cache.height=this.currentFrame.height,this._cache.halfWidth=Math.floor(this._cache.width/2),this._cache.halfHeight=Math.floor(this._cache.height/2),this._cache.dirty=!0)},n.Sprite.prototype.updateCrop=function(){this.cropEnabled&&(this.crop.width!=this._cache.cropWidth||this.crop.height!=this._cache.cropHeight||this.crop.x!=this._cache.cropX||this.crop.y!=this._cache.cropY)&&(this.crop.floorAll(),this._cache.cropX=this.crop.x,this._cache.cropY=this.crop.y,this._cache.cropWidth=this.crop.width,this._cache.cropHeight=this.crop.height,this.texture.frame=this.crop,this.texture.width=this.crop.width,this.texture.height=this.crop.height,this.texture.updateFrame=!0,t.Texture.frameUpdates.push(this.texture))},n.Sprite.prototype.updateBounds=function(){this.offset.setTo(this._cache.a02-this.anchor.x*this.width,this._cache.a12-this.anchor.y*this.height),this.getLocalPosition(this.center,this.offset.x+this.width/2,this.offset.y+this.height/2),this.getLocalPosition(this.topLeft,this.offset.x,this.offset.y),this.getLocalPosition(this.topRight,this.offset.x+this.width,this.offset.y),this.getLocalPosition(this.bottomLeft,this.offset.x,this.offset.y+this.height),this.getLocalPosition(this.bottomRight,this.offset.x+this.width,this.offset.y+this.height),this._cache.left=n.Math.min(this.topLeft.x,this.topRight.x,this.bottomLeft.x,this.bottomRight.x),this._cache.right=n.Math.max(this.topLeft.x,this.topRight.x,this.bottomLeft.x,this.bottomRight.x),this._cache.top=n.Math.min(this.topLeft.y,this.topRight.y,this.bottomLeft.y,this.bottomRight.y),this._cache.bottom=n.Math.max(this.topLeft.y,this.topRight.y,this.bottomLeft.y,this.bottomRight.y),this.bounds.setTo(this._cache.left,this._cache.top,this._cache.right-this._cache.left,this._cache.bottom-this._cache.top),this.updateFrame=!0,this.inWorld==!1?(this.inWorld=n.Rectangle.intersects(this.bounds,this.game.world.bounds,this.inWorldThreshold),this.inWorld&&(this._outOfBoundsFired=!1)):(this.inWorld=n.Rectangle.intersects(this.bounds,this.game.world.bounds,this.inWorldThreshold),this.inWorld==!1&&(this.events.onOutOfBounds.dispatch(this),this._outOfBoundsFired=!0,this.outOfBoundsKill&&this.kill())),this._cache.cameraVisible=n.Rectangle.intersects(this.game.world.camera.screenView,this.bounds,0),this.autoCull&&(this.renderable=this._cache.cameraVisible),this.body&&this.body.updateBounds(this.center.x,this.center.y,this._cache.scaleX,this._cache.scaleY)},n.Sprite.prototype.getLocalPosition=function(n,t,i){return n.x=(this._cache.a11*this._cache.id*t+-this._cache.a01*this._cache.id*i+(this._cache.a12*this._cache.a01-this._cache.a02*this._cache.a11)*this._cache.id)*this.scale.x+this._cache.a02,n.y=(this._cache.a00*this._cache.id*i+-this._cache.a10*this._cache.id*t+(-this._cache.a12*this._cache.a00+this._cache.a02*this._cache.a10)*this._cache.id)*this.scale.y+this._cache.a12,n},n.Sprite.prototype.getLocalUnmodifiedPosition=function(n,t,i){return n.x=this._cache.a11*this._cache.idi*t+-this._cache.i01*this._cache.idi*i+(this._cache.a12*this._cache.i01-this._cache.a02*this._cache.a11)*this._cache.idi+this.anchor.x*this._cache.width,n.y=this._cache.a00*this._cache.idi*i+-this._cache.i10*this._cache.idi*t+(-this._cache.a12*this._cache.a00+this._cache.a02*this._cache.i10)*this._cache.idi+this.anchor.y*this._cache.height,n},n.Sprite.prototype.resetCrop=function(){this.crop=new n.Rectangle(0,0,this._cache.width,this._cache.height),this.texture.setFrame(this.crop),this.cropEnabled=!1},n.Sprite.prototype.postUpdate=function(){this.exists&&(this.body&&this.body.postUpdate(),this.fixedToCamera?(this._cache.x=this.game.camera.view.x+this.cameraOffset.x,this._cache.y=this.game.camera.view.y+this.cameraOffset.y):(this._cache.x=this.x,this._cache.y=this.y),this.world.setTo(this.game.camera.x+this.worldTransform[2],this.game.camera.y+this.worldTransform[5]),this.position.x=this._cache.x,this.position.y=this._cache.y)},n.Sprite.prototype.loadTexture=function(i,r){this.key=i,i instanceof n.RenderTexture?this.currentFrame=this.game.cache.getTextureFrame(i.name):i instanceof t.Texture?this.currentFrame=r:((typeof i=="undefined"||this.game.cache.checkImageKey(i)===!1)&&(i="__default",this.key=i),this.game.cache.isSpriteSheet(i)?(this.animations.loadFrameData(this.game.cache.getFrameData(i)),typeof r!="undefined"&&(typeof r=="string"?this.frameName=r:this.frame=r)):(this.currentFrame=this.game.cache.getFrame(i),this.setTexture(t.TextureCache[i])))},n.Sprite.prototype.centerOn=function(n,t){return this.x=n+(this.x-this.center.x),this.y=t+(this.y-this.center.y),this},n.Sprite.prototype.revive=function(n){return typeof n=="undefined"&&(n=1),this.alive=!0,this.exists=!0,this.visible=!0,this.health=n,this.events&&this.events.onRevived.dispatch(this),this},n.Sprite.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled.dispatch(this),this},n.Sprite.prototype.destroy=function(){this.group&&this.group.remove(this),this.input&&this.input.destroy(),this.events&&this.events.destroy(),this.animations&&this.animations.destroy(),this.alive=!1,this.exists=!1,this.visible=!1,this.game=null},n.Sprite.prototype.damage=function(n){return this.alive&&(this.health-=n,this.health<0&&this.kill()),this},n.Sprite.prototype.reset=function(n,t,i){return typeof i=="undefined"&&(i=1),this.x=n,this.y=t,this.position.x=this.x,this.position.y=this.y,this.alive=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this._outOfBoundsFired=!1,this.health=i,this.body&&this.body.reset(),this},n.Sprite.prototype.bringToTop=function(){return this.group?this.group.bringToTop(this):this.game.world.bringToTop(this),this},n.Sprite.prototype.play=function(n,t,i,r){if(this.animations)return this.animations.play(n,t,i,r)},Object.defineProperty(n.Sprite.prototype,"angle",{get:function(){return n.Math.wrapAngle(n.Math.radToDeg(this.rotation))},set:function(t){this.rotation=n.Math.degToRad(n.Math.wrapAngle(t))}}),Object.defineProperty(n.Sprite.prototype,"frame",{get:function(){return this.animations.frame},set:function(n){this.animations.frame=n}}),Object.defineProperty(n.Sprite.prototype,"frameName",{get:function(){return this.animations.frameName},set:function(n){this.animations.frameName=n}}),Object.defineProperty(n.Sprite.prototype,"inCamera",{get:function(){return this._cache.cameraVisible}}),Object.defineProperty(n.Sprite.prototype,"width",{get:function(){return this.scale.x*this.currentFrame.width},set:function(n){this.scale.x=n/this.currentFrame.width,this._cache.scaleX=n/this.currentFrame.width,this._width=n}}),Object.defineProperty(n.Sprite.prototype,"height",{get:function(){return this.scale.y*this.currentFrame.height},set:function(n){this.scale.y=n/this.currentFrame.height,this._cache.scaleY=n/this.currentFrame.height,this._height=n}}),Object.defineProperty(n.Sprite.prototype,"inputEnabled",{get:function(){return this.input.enabled},set:function(n){n?this.input.enabled==!1&&this.input.start():this.input.enabled&&this.input.stop()}}),n.TileSprite=function(i,r,u,f,e,o,s){r=r||0,u=u||0,f=f||256,e=e||256,o=o||null,s=s||null,n.Sprite.call(this,i,r,u,o,s),this.texture=t.TextureCache[o],t.TilingSprite.call(this,this.texture,f,e),this.type=n.TILESPRITE,this.tileScale=new n.Point(1,1),this.tilePosition=new n.Point(0,0)},n.TileSprite.prototype=n.Utils.extend(!0,t.TilingSprite.prototype,n.Sprite.prototype),n.TileSprite.prototype.constructor=n.TileSprite,n.Text=function(i,r,u,f,e){r=r||0,u=u||0,f=f||"",e=e||"",this.exists=!0,this.alive=!0,this.group=null,this.name="",this.game=i,this._text=f,this._style=e,t.Text.call(this,f,e),this.type=n.TEXT,this.position.x=this.x=r,this.position.y=this.y=u,this.anchor=new n.Point,this.scale=new n.Point(1,1),this._cache={dirty:!1,a00:1,a01:0,a02:r,a10:0,a11:1,a12:u,id:1,x:-1,y:-1,scaleX:1,scaleY:1},this._cache.x=this.x,this._cache.y=this.y,this.renderable=!0},n.Text.prototype=Object.create(t.Text.prototype),n.Text.prototype.constructor=n.Text,n.Text.prototype.update=function(){this.exists&&(this._cache.dirty=!1,this._cache.x=this.x,this._cache.y=this.y,(this.position.x!=this._cache.x||this.position.y!=this._cache.y)&&(this.position.x=this._cache.x,this.position.y=this._cache.y,this._cache.dirty=!0))},n.Text.prototype.destroy=function(){this.group&&this.group.remove(this),this.canvas.parentNode?this.canvas.parentNode.removeChild(this.canvas):(this.canvas=null,this.context=null),this.exists=!1,this.group=null},Object.defineProperty(n.Text.prototype,"angle",{get:function(){return n.Math.radToDeg(this.rotation)},set:function(t){this.rotation=n.Math.degToRad(t)}}),Object.defineProperty(n.Text.prototype,"content",{get:function(){return this._text},set:function(n){n!==this._text&&(this._text=n,this.setText(n))}}),Object.defineProperty(n.Text.prototype,"font",{get:function(){return this._style},set:function(n){n!==this._style&&(this._style=n,this.setStyle(n))}}),n.BitmapText=function(i,r,u,f,e){r=r||0,u=u||0,f=f||"",e=e||"",this.exists=!0,this.alive=!0,this.group=null,this.name="",this.game=i,t.BitmapText.call(this,f,e),this.type=n.BITMAPTEXT,this.position.x=r,this.position.y=u,this.anchor=new n.Point,this.scale=new n.Point(1,1),this._cache={dirty:!1,a00:1,a01:0,a02:r,a10:0,a11:1,a12:u,id:1,x:-1,y:-1,scaleX:1,scaleY:1},this._cache.x=this.x,this._cache.y=this.y,this.renderable=!0},n.BitmapText.prototype=Object.create(t.BitmapText.prototype),n.BitmapText.prototype.constructor=n.BitmapText,n.BitmapText.prototype.update=function(){this.exists&&(this._cache.dirty=!1,this._cache.x=this.x,this._cache.y=this.y,(this.position.x!=this._cache.x||this.position.y!=this._cache.y)&&(this.position.x=this._cache.x,this.position.y=this._cache.y,this._cache.dirty=!0),this.pivot.x=this.anchor.x*this.width,this.pivot.y=this.anchor.y*this.height)},n.BitmapText.prototype.destroy=function(){this.group&&this.group.remove(this),this.canvas.parentNode?this.canvas.parentNode.removeChild(this.canvas):(this.canvas=null,this.context=null),this.exists=!1,this.group=null},Object.defineProperty(n.BitmapText.prototype,"angle",{get:function(){return n.Math.radToDeg(this.rotation)},set:function(t){this.rotation=n.Math.degToRad(t)}}),Object.defineProperty(n.BitmapText.prototype,"x",{get:function(){return this.position.x},set:function(n){this.position.x=n}}),Object.defineProperty(n.BitmapText.prototype,"y",{get:function(){return this.position.y},set:function(n){this.position.y=n}}),n.Button=function(t,i,r,u,f,e,o,s,h){i=i||0,r=r||0,u=u||null,f=f||null,e=e||this,n.Sprite.call(this,t,i,r,u,s),this.type=n.BUTTON,this._onOverFrameName=null,this._onOutFrameName=null,this._onDownFrameName=null,this._onUpFrameName=null,this._onOverFrameID=null,this._onOutFrameID=null,this._onDownFrameID=null,this._onUpFrameID=null,this.onOverSound=null,this.onOutSound=null,this.onDownSound=null,this.onUpSound=null,this.onOverSoundMarker="",this.onOutSoundMarker="",this.onDownSoundMarker="",this.onUpSoundMarker="",this.onInputOver=new n.Signal,this.onInputOut=new n.Signal,this.onInputDown=new n.Signal,this.onInputUp=new n.Signal,this.freezeFrames=!1,this.setFrames(o,s,h),f!==null&&this.onInputUp.add(f,e),this.input.start(0,!0),this.events.onInputOver.add(this.onInputOverHandler,this),this.events.onInputOut.add(this.onInputOutHandler,this),this.events.onInputDown.add(this.onInputDownHandler,this),this.events.onInputUp.add(this.onInputUpHandler,this)},n.Button.prototype=Object.create(n.Sprite.prototype),n.Button.prototype=n.Utils.extend(!0,n.Button.prototype,n.Sprite.prototype,t.Sprite.prototype),n.Button.prototype.constructor=n.Button,n.Button.prototype.setFrames=function(n,t,i){n!==null&&(typeof n=="string"?(this._onOverFrameName=n,this.input.pointerOver()&&(this.frameName=n)):(this._onOverFrameID=n,this.input.pointerOver()&&(this.frame=n))),t!==null&&(typeof t=="string"?(this._onOutFrameName=t,this._onUpFrameName=t,this.input.pointerOver()==!1&&(this.frameName=t)):(this._onOutFrameID=t,this._onUpFrameID=t,this.input.pointerOver()==!1&&(this.frame=t))),i!==null&&(typeof i=="string"?(this._onDownFrameName=i,this.input.pointerOver()&&(this.frameName=i)):(this._onDownFrameID=i,this.input.pointerOver()&&(this.frame=i)))},n.Button.prototype.setSounds=function(n,t,i,r,u,f,e,o){this.setOverSound(n,t),this.setOutSound(u,f),this.setUpSound(e,o),this.setDownSound(i,r)},n.Button.prototype.setOverSound=function(t,i){this.onOverSound=null,this.onOverSoundMarker="",t instanceof n.Sound&&(this.onOverSound=t),typeof i=="string"&&(this.onOverSoundMarker=i)},n.Button.prototype.setOutSound=function(t,i){this.onOutSound=null,this.onOutSoundMarker="",t instanceof n.Sound&&(this.onOutSound=t),typeof i=="string"&&(this.onOutSoundMarker=i)},n.Button.prototype.setUpSound=function(t,i){this.onUpSound=null,this.onUpSoundMarker="",t instanceof n.Sound&&(this.onUpSound=t),typeof i=="string"&&(this.onUpSoundMarker=i)},n.Button.prototype.setDownSound=function(t,i){this.onDownSound=null,this.onDownSoundMarker="",t instanceof n.Sound&&(this.onDownSound=t),typeof i=="string"&&(this.onDownSoundMarker=i)},n.Button.prototype.onInputOverHandler=function(n){this.freezeFrames==!1&&(this._onOverFrameName!=null?this.frameName=this._onOverFrameName:this._onOverFrameID!=null&&(this.frame=this._onOverFrameID)),this.onOverSound&&this.onOverSound.play(this.onOverSoundMarker),this.onInputOver&&this.onInputOver.dispatch(this,n)},n.Button.prototype.onInputOutHandler=function(n){this.freezeFrames==!1&&(this._onOutFrameName!=null?this.frameName=this._onOutFrameName:this._onOutFrameID!=null&&(this.frame=this._onOutFrameID)),this.onOutSound&&this.onOutSound.play(this.onOutSoundMarker),this.onInputOut&&this.onInputOut.dispatch(this,n)},n.Button.prototype.onInputDownHandler=function(n){this.freezeFrames==!1&&(this._onDownFrameName!=null?this.frameName=this._onDownFrameName:this._onDownFrameID!=null&&(this.frame=this._onDownFrameID)),this.onDownSound&&this.onDownSound.play(this.onDownSoundMarker),this.onInputDown&&this.onInputDown.dispatch(this,n)},n.Button.prototype.onInputUpHandler=function(n){this.freezeFrames==!1&&(this._onUpFrameName!=null?this.frameName=this._onUpFrameName:this._onUpFrameID!=null&&(this.frame=this._onUpFrameID)),this.onUpSound&&this.onUpSound.play(this.onUpSoundMarker),this.onInputUp&&this.onInputUp.dispatch(this,n)},n.Graphics=function(i,r,u){this.game=i,t.Graphics.call(this),this.type=n.GRAPHICS,this.position.x=r,this.position.y=u},n.Graphics.prototype=Object.create(t.Graphics.prototype),n.Graphics.prototype.constructor=n.Graphics,n.Graphics.prototype.destroy=function(){this.clear(),this.group&&this.group.remove(this),this.game=null},Object.defineProperty(n.Graphics.prototype,"angle",{get:function(){return n.Math.wrapAngle(n.Math.radToDeg(this.rotation))},set:function(t){this.rotation=n.Math.degToRad(n.Math.wrapAngle(t))}}),Object.defineProperty(n.Graphics.prototype,"x",{get:function(){return this.position.x},set:function(n){this.position.x=n}}),Object.defineProperty(n.Graphics.prototype,"y",{get:function(){return this.position.y},set:function(n){this.position.y=n}}),n.RenderTexture=function(i,r,u,f){this.game=i,this.name=r,t.EventTarget.call(this),this.width=u||100,this.height=f||100,this.indetityMatrix=t.mat3.create(),this.frame=new t.Rectangle(0,0,this.width,this.height),this.type=n.RENDERTEXTURE,t.gl?this.initWebGL():this.initCanvas()},n.RenderTexture.prototype=n.Utils.extend(!0,t.RenderTexture.prototype),n.RenderTexture.prototype.constructor=n.RenderTexture,n.Canvas={create:function(n,t){n=n||256,t=t||256;var i=document.createElement("canvas");return i.width=n,i.height=t,i.style.display="block",i},getOffset:function(t,i){i=i||new n.Point;var r=t.getBoundingClientRect(),u=t.clientTop||document.body.clientTop||0,f=t.clientLeft||document.body.clientLeft||0,e=window.pageYOffset||t.scrollTop||document.body.scrollTop,o=window.pageXOffset||t.scrollLeft||document.body.scrollLeft;return i.x=r.left+o-f,i.y=r.top+e-u,i},getAspectRatio:function(n){return n.width/n.height},setBackgroundColor:function(n,t){return t=t||"rgb(0,0,0)",n.style.backgroundColor=t,n},setTouchAction:function(n,t){return t=t||"none",n.style.msTouchAction=t,n.style["ms-touch-action"]=t,n.style["touch-action"]=t,n},setUserSelect:function(n,t){return t=t||"none",n.style["-webkit-touch-callout"]=t,n.style["-webkit-user-select"]=t,n.style["-khtml-user-select"]=t,n.style["-moz-user-select"]=t,n.style["-ms-user-select"]=t,n.style["user-select"]=t,n.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",n},addToDOM:function(n,t,i){return t=t||"",typeof i=="undefined"&&(i=!0),t!==""?document.getElementById(t)?(document.getElementById(t).appendChild(n),i&&(document.getElementById(t).style.overflow="hidden")):document.body.appendChild(n):document.body.appendChild(n),n},setTransform:function(n,t,i,r,u,f,e){return n.setTransform(r,f,e,u,t,i),n},setSmoothingEnabled:function(n,t){return n.imageSmoothingEnabled=t,n.mozImageSmoothingEnabled=t,n.oImageSmoothingEnabled=t,n.webkitImageSmoothingEnabled=t,n.msImageSmoothingEnabled=t,n},setImageRenderingCrisp:function(n){return n.style["image-rendering"]="crisp-edges",n.style["image-rendering"]="-moz-crisp-edges",n.style["image-rendering"]="-webkit-optimize-contrast",n.style.msInterpolationMode="nearest-neighbor",n},setImageRenderingBicubic:function(n){return n.style["image-rendering"]="auto",n.style.msInterpolationMode="bicubic",n}},n.StageScaleMode=function(t,i,r){this._startHeight=0,this.forceLandscape=!1,this.forcePortrait=!1,this.incorrectOrientation=!1,this.pageAlignHorizontally=!1,this.pageAlignVertically=!1,this.minWidth=null,this.maxWidth=null,this.minHeight=null,this.maxHeight=null,this.width=i,this.height=r,this._width=0,this._height=0,this.maxIterations=5,this.game=t,this.enterLandscape=new n.Signal,this.enterPortrait=new n.Signal,this.orientation=window.orientation?window.orientation:window.outerWidth>window.outerHeight?90:0,this.scaleFactor=new n.Point(1,1),this.aspectRatio=0;var u=this;window.addEventListener("orientationchange",function(n){return u.checkOrientation(n)},!1),window.addEventListener("resize",function(n){return u.checkResize(n)},!1),document.addEventListener("webkitfullscreenchange",function(n){return u.fullScreenChange(n)},!1),document.addEventListener("mozfullscreenchange",function(n){return u.fullScreenChange(n)},!1),document.addEventListener("fullscreenchange",function(n){return u.fullScreenChange(n)},!1)},n.StageScaleMode.EXACT_FIT=0,n.StageScaleMode.NO_SCALE=1,n.StageScaleMode.SHOW_ALL=2,n.StageScaleMode.prototype={startFullScreen:function(t){if(!this.isFullScreen){typeof t!="undefined"&&n.Canvas.setSmoothingEnabled(this.game.context,t);var i=this.game.canvas;this._width=this.width,this._height=this.height,console.log("startFullScreen",this._width,this._height),i.requestFullScreen?i.requestFullScreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullScreen&&i.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}},stopFullScreen:function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},fullScreenChange:function(){this.isFullScreen?(this.game.stage.canvas.style.width="100%",this.game.stage.canvas.style.height="100%",this.setMaximum(),this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height):(this.game.stage.canvas.style.width=this.game.width+"px",this.game.stage.canvas.style.height=this.game.height+"px",this.width=this._width,this.height=this._height,this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height)},checkOrientationState:function(){this.incorrectOrientation?(this.forceLandscape&&window.innerWidth>window.innerHeight||this.forcePortrait&&window.innerHeight>window.innerWidth)&&(this.game.paused=!1,this.incorrectOrientation=!1,this.refresh()):(this.forceLandscape&&window.innerWidth<window.innerHeight||this.forcePortrait&&window.innerHeight<window.innerWidth)&&(this.game.paused=!0,this.incorrectOrientation=!0,this.refresh())},checkOrientation:function(){this.orientation=window.orientation,this.isLandscape?this.enterLandscape.dispatch(this.orientation,!0,!1):this.enterPortrait.dispatch(this.orientation,!1,!0),this.game.stage.scaleMode!==n.StageScaleMode.NO_SCALE&&this.refresh()},checkResize:function(){this.orientation=window.outerWidth>window.outerHeight?90:0,this.isLandscape?this.enterLandscape.dispatch(this.orientation,!0,!1):this.enterPortrait.dispatch(this.orientation,!1,!0),this.game.stage.scaleMode!==n.StageScaleMode.NO_SCALE&&this.refresh()},refresh:function(){var n=this;this.game.device.iPad==!1&&this.game.device.webApp==!1&&this.game.device.desktop==!1&&(this.game.device.android&&this.game.device.chrome==!1?window.scrollTo(0,1):window.scrollTo(0,0)),this._check==null&&this.maxIterations>0&&(this._iterations=this.maxIterations,this._check=window.setInterval(function(){return n.setScreenSize()},10),this.setScreenSize())},setScreenSize:function(t){typeof t=="undefined"&&(t=!1),this.game.device.iPad==!1&&this.game.device.webApp==!1&&this.game.device.desktop==!1&&(this.game.device.android&&this.game.device.chrome==!1?window.scrollTo(0,1):window.scrollTo(0,0)),this._iterations--,(t||window.innerHeight>this._startHeight||this._iterations<0)&&(document.documentElement.style.minHeight=window.innerHeight+"px",this.incorrectOrientation==!0?this.setMaximum():this.game.stage.scaleMode==n.StageScaleMode.EXACT_FIT?this.setExactFit():this.game.stage.scaleMode==n.StageScaleMode.SHOW_ALL&&this.setShowAll(),this.setSize(),clearInterval(this._check),this._check=null)},setSize:function(){this.incorrectOrientation==!1&&(this.maxWidth&&this.width>this.maxWidth&&(this.width=this.maxWidth),this.maxHeight&&this.height>this.maxHeight&&(this.height=this.maxHeight),this.minWidth&&this.width<this.minWidth&&(this.width=this.minWidth),this.minHeight&&this.height<this.minHeight&&(this.height=this.minHeight)),this.game.canvas.style.width=this.width+"px",this.game.canvas.style.height=this.height+"px",this.game.input.scale.setTo(this.game.width/this.width,this.game.height/this.height),this.pageAlignHorizontally&&(this.game.canvas.style.marginLeft=this.width<window.innerWidth&&this.incorrectOrientation==!1?Math.round((window.innerWidth-this.width)/2)+"px":"0px"),this.pageAlignVertically&&(this.game.canvas.style.marginTop=this.height<window.innerHeight&&this.incorrectOrientation==!1?Math.round((window.innerHeight-this.height)/2)+"px":"0px"),n.Canvas.getOffset(this.game.canvas,this.game.stage.offset),this.aspectRatio=this.width/this.height,this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height},setMaximum:function(){this.width=window.innerWidth,this.height=window.innerHeight},setShowAll:function(){var n=Math.min(window.innerHeight/this.game.height,window.innerWidth/this.game.width);this.width=Math.round(this.game.width*n),this.height=Math.round(this.game.height*n)},setExactFit:function(){var n=window.innerWidth,t=window.innerHeight;this.width=this.maxWidth&&n>this.maxWidth?this.maxWidth:n,this.height=this.maxHeight&&t>this.maxHeight?this.maxHeight:t}},Object.defineProperty(n.StageScaleMode.prototype,"isFullScreen",{get:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(n.StageScaleMode.prototype,"isPortrait",{get:function(){return this.orientation==0||this.orientation==180}}),Object.defineProperty(n.StageScaleMode.prototype,"isLandscape",{get:function(){return this.orientation===90||this.orientation===-90}}),n.Device=function(){this.patchAndroidClearRectBug=!1,this.desktop=!1,this.iOS=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.canvas=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.webGL=!1,this.worker=!1,this.touch=!1,this.mspointer=!1,this.css3D=!1,this.pointerLock=!1,this.arora=!1,this.chrome=!1,this.epiphany=!1,this.firefox=!1,this.ie=!1,this.ieVersion=0,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.webApp=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this._checkAudio(),this._checkBrowser(),this._checkCSS3D(),this._checkDevice(),this._checkFeatures(),this._checkOS()},n.Device.prototype={_checkOS:function(){var n=navigator.userAgent;/Android/.test(n)?this.android=!0:/CrOS/.test(n)?this.chromeOS=!0:/iP[ao]d|iPhone/i.test(n)?this.iOS=!0:/Linux/.test(n)?this.linux=!0:/Mac OS/.test(n)?this.macOS=!0:/Windows/.test(n)&&(this.windows=!0),(this.windows||this.macOS||this.linux)&&(this.desktop=!0)},_checkFeatures:function(){this.canvas=!!window.CanvasRenderingContext2D;try{this.localStorage=!!localStorage.getItem}catch(n){this.localStorage=!1}this.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob,this.fileSystem=!!window.requestFileSystem,this.webGL=function(){try{var n=document.createElement("canvas");return!!window.WebGLRenderingContext&&(n.getContext("webgl")||n.getContext("experimental-webgl"))}catch(t){return!1}}(),this.webGL=this.webGL===null||this.webGL===!1?!1:!0,this.worker=!!window.Worker,("ontouchstart"in document.documentElement||window.navigator.msPointerEnabled)&&(this.touch=!0),window.navigator.msPointerEnabled&&(this.mspointer=!0),this.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},_checkBrowser:function(){var n=navigator.userAgent;/Arora/.test(n)?this.arora=!0:/Chrome/.test(n)?this.chrome=!0:/Epiphany/.test(n)?this.epiphany=!0:/Firefox/.test(n)?this.firefox=!0:/Mobile Safari/.test(n)?this.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(n)?(this.ie=!0,this.ieVersion=parseInt(RegExp.$1)):/Midori/.test(n)?this.midori=!0:/Opera/.test(n)?this.opera=!0:/Safari/.test(n)&&(this.safari=!0),navigator.standalone&&(this.webApp=!0)},_checkAudio:function(){this.audioData=!!window.Audio,this.webAudio=!!(window.webkitAudioContext||window.AudioContext);var n=document.createElement("audio"),t=!1;try{(t=!!n.canPlayType)&&(n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.ogg=!0),n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")&&(this.opus=!0),n.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.mp3=!0),n.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.wav=!0),(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/aac;").replace(/^no$/,""))&&(this.m4a=!0),n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.webm=!0))}catch(i){}},_checkDevice:function(){this.pixelRatio=window.devicePixelRatio||1,this.iPhone=navigator.userAgent.toLowerCase().indexOf("iphone")!=-1,this.iPhone4=this.pixelRatio==2&&this.iPhone,this.iPad=navigator.userAgent.toLowerCase().indexOf("ipad")!=-1},_checkCSS3D:function(){var n=document.createElement("p"),t,r={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"},i;document.body.insertBefore(n,null);for(i in r)n.style[i]!==undefined&&(n.style[i]="translate3d(1px,1px,1px)",t=window.getComputedStyle(n).getPropertyValue(r[i]));document.body.removeChild(n),this.css3D=t!==undefined&&t.length>0&&t!=="none"},canPlayAudio:function(n){return n=="mp3"&&this.mp3?!0:n=="ogg"&&(this.ogg||this.opus)||n=="m4a"&&this.m4a||n=="wav"&&this.wav||n=="webm"&&this.webm?!0:!1},isConsoleOpen:function(){return window.console&&window.console.firebug?!0:window.console?(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles.length>0):!1}},n.RequestAnimationFrame=function(n){var i,t;for(this.game=n,this._isSetTimeOut=!1,this.isRunning=!1,i=["ms","moz","webkit","o"],t=0;t<i.length&&!window.requestAnimationFrame;t++)window.requestAnimationFrame=window[i[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[t]+"CancelAnimationFrame"];this._onLoop=null},n.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var n=this;window.requestAnimationFrame?(this._isSetTimeOut=!1,this._onLoop=function(t){return n.updateRAF(t)},window.requestAnimationFrame(this._onLoop)):(this._isSetTimeOut=!0,this._onLoop=function(){return n.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0))},updateRAF:function(n){this.game.update(n),window.requestAnimationFrame(this._onLoop)},updateSetTimeout:function(){this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame,this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return this._isSetTimeOut===!1}},n.RandomDataGenerator=function(n){typeof n=="undefined"&&(n=[]),this.sow(n)},n.RandomDataGenerator.prototype={c:1,s0:0,s1:0,s2:0,rnd:function(){var n=2091639*this.s0+this.c*23283064365386963e-26;return this.c=n|0,this.s0=this.s1,this.s1=this.s2,this.s2=n-this.c,this.s2},sow:function(n){var t,i;for(typeof n=="undefined"&&(n=[]),this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1,i=0;t=n[i++];)this.s0-=this.hash(t),this.s0+=~~(this.s0<0),this.s1-=this.hash(t),this.s1+=~~(this.s1<0),this.s2-=this.hash(t),this.s2+=~~(this.s2<0)},hash:function(n){var i,r,t;for(t=4022871197,n=n.toString(),r=0;r<n.length;r++)t+=n.charCodeAt(r),i=.025196032824169379*t,t=i>>>0,i-=t,i*=t,t=i>>>0,i-=t,t+=i*4294967296;return(t>>>0)*23283064365386963e-26},integer:function(){return this.rnd.apply(this)*4294967296},frac:function(){return this.rnd.apply(this)+(this.rnd.apply(this)*2097152|0)*11102230246251565e-32},real:function(){return this.integer()+this.frac()},integerInRange:function(n,t){return Math.floor(this.realInRange(n,t))},realInRange:function(n,t){return this.frac()*(t-n)+n},normal:function(){return 1-2*this.frac()},uuid:function(){for(var n,t=n="";n++<36;t+=~n%5|n*3&4?(n^15?8^this.frac()*(n^20?16:4):4).toString(16):"-");return t},pick:function(n){return n[this.integerInRange(0,n.length)]},weightedPick:function(n){return n[~~(Math.pow(this.frac(),2)*n.length)]},timestamp:function(n,t){return this.realInRange(n||9466848e5,t||1577862e6)},angle:function(){return this.integerInRange(-180,180)}},n.Math={PI2:Math.PI*2,fuzzyEqual:function(n,t,i){return typeof i=="undefined"&&(i=.0001),Math.abs(n-t)<i},fuzzyLessThan:function(n,t,i){return typeof i=="undefined"&&(i=.0001),n<t+i},fuzzyGreaterThan:function(n,t,i){return typeof i=="undefined"&&(i=.0001),n>t-i},fuzzyCeil:function(n,t){return typeof t=="undefined"&&(t=.0001),Math.ceil(n-t)},fuzzyFloor:function(n,t){return typeof t=="undefined"&&(t=.0001),Math.floor(n+t)},average:function(){for(var t=[],r,i,n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];for(r=0,i=0;i<t.length;i++)r+=t[i];return r/t.length},truncate:function(n){return n>0?Math.floor(n):Math.ceil(n)},shear:function(n){return n%1},snapTo:function(n,t,i){return(typeof i=="undefined"&&(i=0),t==0)?n:(n-=i,n=t*Math.round(n/t),i+n)},snapToFloor:function(n,t,i){return(typeof i=="undefined"&&(i=0),t==0)?n:(n-=i,n=t*Math.floor(n/t),i+n)},snapToCeil:function(n,t,i){return(typeof i=="undefined"&&(i=0),t==0)?n:(n-=i,n=t*Math.ceil(n/t),i+n)},snapToInArray:function(n,t,i){var r,u,f;if(typeof i=="undefined"&&(i=!0),i&&t.sort(),n<t[0])return t[0];for(r=1;t[r]<n;)r++;return u=t[r-1],f=r<t.length?t[r]:Number.POSITIVE_INFINITY,f-n<=n-u?f:u},roundTo:function(n,t,i){typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=10);var r=Math.pow(i,-t);return Math.round(n*r)/r},floorTo:function(n,t,i){typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=10);var r=Math.pow(i,-t);return Math.floor(n*r)/r},ceilTo:function(n,t,i){typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=10);var r=Math.pow(i,-t);return Math.ceil(n*r)/r},interpolateFloat:function(n,t,i){return(t-n)*i+n},angleBetween:function(n,t,i,r){return Math.atan2(r-t,i-n)},normalizeAngle:function(n,t){typeof t=="undefined"&&(t=!0);var i=t?GameMath.PI:180;return this.wrap(n,i,-i)},nearestAngleBetween:function(n,t,i){typeof i=="undefined"&&(i=!0);var r=i?Math.PI:180;return n=this.normalizeAngle(n,i),t=this.normalizeAngle(t,i),n<-r/2&&t>r/2&&(n+=r*2),t<-r/2&&n>r/2&&(t+=r*2),t-n},interpolateAngles:function(n,t,i,r,u){return typeof r=="undefined"&&(r=!0),typeof u=="undefined"&&(u=null),n=this.normalizeAngle(n,r),t=this.normalizeAngleToAnother(t,n,r),typeof u=="function"?u(i,n,t-n,1):this.interpolateFloat(n,t,i)},chanceRoll:function(n){return typeof n=="undefined"&&(n=50),n<=0?!1:n>=100?!0:Math.random()*100>=n?!1:!0},numberArray:function(n,t){for(var r=[],i=n;i<=t;i++)r.push(i);return r},maxAdd:function(n,t,i){return n+=t,n>i&&(n=i),n},minSub:function(n,t,i){return n-=t,n<i&&(n=i),n},wrap:function(n,t,i){var u=i-t,r;return u<=0?0:(r=(n-t)%u,r<0&&(r+=u),r+t)},wrapValue:function(n,t,i){return n=Math.abs(n),t=Math.abs(t),i=Math.abs(i),(n+t)%i},randomSign:function(){return Math.random()>.5?1:-1},isOdd:function(n){return n&1},isEven:function(n){return n&1?!1:!0},max:function(){for(var n=1,t=0,i=arguments.length;n<i;n++)arguments[t]<arguments[n]&&(t=n);return arguments[t]},min:function(){for(var n=1,t=0,i=arguments.length;n<i;n++)arguments[n]<arguments[t]&&(t=n);return arguments[t]},wrapAngle:function(n){var t=n;return n>=-180&&n<=180?n:(t=(n+180)%360,t<0&&(t+=360),t-180)},angleLimit:function(n,t,i){var r=n;return n>i?r=i:n<t&&(r=t),r},linearInterpolation:function(n,t){var i=n.length-1,r=i*t,u=Math.floor(r);return t<0?this.linear(n[0],n[1],r):t>1?this.linear(n[i],n[i-1],i-r):this.linear(n[u],n[u+1>i?i:u+1],r-u)},bezierInterpolation:function(n,t){for(var u=0,r=n.length-1,i=0;i<=r;i++)u+=Math.pow(1-t,r-i)*Math.pow(t,i)*n[i]*this.bernstein(r,i);return u},catmullRomInterpolation:function(n,t){var i=n.length-1,u=i*t,r=Math.floor(u);return n[0]===n[i]?(t<0&&(r=Math.floor(u=i*(1+t))),this.catmullRom(n[(r-1+i)%i],n[r],n[(r+1)%i],n[(r+2)%i],u-r)):t<0?n[0]-(this.catmullRom(n[0],n[0],n[1],n[1],-u)-n[0]):t>1?n[i]-(this.catmullRom(n[i],n[i],n[i-1],n[i-1],u-i)-n[i]):this.catmullRom(n[r?r-1:0],n[r],n[i<r+1?i:r+1],n[i<r+2?i:r+2],u-r)},linear:function(n,t,i){return(t-n)*i+n},bernstein:function(n,t){return this.factorial(n)/this.factorial(t)/this.factorial(n-t)},catmullRom:function(n,t,i,r,u){var f=(i-n)*.5,e=(r-t)*.5,o=u*u,s=u*o;return(2*t-2*i+f+e)*s+(-3*t+3*i-2*f-e)*o+f*u+t},difference:function(n,t){return Math.abs(n-t)},getRandom:function(n,t,i){if(typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=0),n!=null){var r=i;if((r==0||r>n.length-t)&&(r=n.length-t),r>0)return n[t+Math.floor(Math.random()*r)]}return null},floor:function(n){var t=n|0;return n>0?t:t!=n?t-1:t},ceil:function(n){var t=n|0;return n>0?t!=n?t+1:t:t},sinCosGenerator:function(n,t,i,r){var u;typeof t=="undefined"&&(t=1),typeof i=="undefined"&&(i=1),typeof r=="undefined"&&(r=1);var f=t,e=i,o=r*Math.PI/n,s=[],h=[];for(u=0;u<n;u++)e-=f*o,f+=e*o,s[u]=e,h[u]=f;return{sin:h,cos:s}},shift:function(n){var t=n.shift();return n.push(t),t},shuffleArray:function(n){for(var i,r,t=n.length-1;t>0;t--)i=Math.floor(Math.random()*(t+1)),r=n[t],n[t]=n[i],n[i]=r;return n},distance:function(n,t,i,r){var u=n-i,f=t-r;return Math.sqrt(u*u+f*f)},distanceRounded:function(t,i,r,u){return Math.round(n.Math.distance(t,i,r,u))},clamp:function(n,t,i){return n<t?t:n>i?i:n},clampBottom:function(n,t){return n<t?t:n},within:function(n,t,i){return Math.abs(n-t)<=i},mapLinear:function(n,t,i,r,u){return r+(n-t)*(u-r)/(i-t)},smoothstep:function(n,t,i){return n<=t?0:n>=i?1:(n=(n-t)/(i-t),n*n*(3-2*n))},smootherstep:function(n,t,i){return n<=t?0:n>=i?1:(n=(n-t)/(i-t),n*n*n*(n*(n*6-15)+10))},sign:function(n){return n<0?-1:n>0?1:0},degToRad:function(){var n=Math.PI/180;return function(t){return t*n}}(),radToDeg:function(){var n=180/Math.PI;return function(t){return t*n}}()},n.QuadTree=function(n,t,i,r,u,f,e,o){this.physicsManager=n,this.ID=n.quadTreeID,n.quadTreeID++,this.maxObjects=f||10,this.maxLevels=e||4,this.level=o||0,this.bounds={x:Math.round(t),y:Math.round(i),width:r,height:u,subWidth:Math.floor(r/2),subHeight:Math.floor(u/2),right:Math.round(t)+Math.floor(r/2),bottom:Math.round(i)+Math.floor(u/2)},this.objects=[],this.nodes=[]},n.QuadTree.prototype={split:function(){this.level++,this.nodes[0]=new n.QuadTree(this.physicsManager,this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level),this.nodes[1]=new n.QuadTree(this.physicsManager,this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level),this.nodes[2]=new n.QuadTree(this.physicsManager,this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level),this.nodes[3]=new n.QuadTree(this.physicsManager,this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level)},insert:function(n){var i=0,t;if(this.nodes[0]!=null&&(t=this.getIndex(n),t!==-1)){this.nodes[t].insert(n);return}if(this.objects.push(n),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(this.nodes[0]==null&&this.split();i<this.objects.length;)t=this.getIndex(this.objects[i]),t!==-1?this.nodes[t].insert(this.objects.splice(i,1)[0]):i++},getIndex:function(n){var t=-1;return n.x<this.bounds.right&&n.right<this.bounds.right?n.y<this.bounds.bottom&&n.bottom<this.bounds.bottom?t=1:n.y>this.bounds.bottom&&(t=2):n.x>this.bounds.right&&(n.y<this.bounds.bottom&&n.bottom<this.bounds.bottom?t=0:n.y>this.bounds.bottom&&(t=3)),t},retrieve:function(n){var t=this.objects;return n.body.quadTreeIndex=this.getIndex(n.body),n.body.quadTreeIDs.push(this.ID),this.nodes[0]&&(n.body.quadTreeIndex!==-1?t=t.concat(this.nodes[n.body.quadTreeIndex].retrieve(n)):(t=t.concat(this.nodes[0].retrieve(n)),t=t.concat(this.nodes[1].retrieve(n)),t=t.concat(this.nodes[2].retrieve(n)),t=t.concat(this.nodes[3].retrieve(n)))),t},clear:function(){this.objects=[];for(var n=0,t=this.nodes.length;n<t;n++)this.nodes[n]&&(this.nodes[n].clear(),delete this.nodes[n])}},n.Circle=function(n,t,i){n=n||0,t=t||0,i=i||0,this.x=n,this.y=t,this._diameter=i,this._radius=i>0?i*.5:0},n.Circle.prototype={circumference:function(){return 2*Math.PI*this._radius},setTo:function(n,t,i){return this.x=n,this.y=t,this._diameter=i,this._radius=i*.5,this},copyFrom:function(n){return this.setTo(n.x,n.y,n.diameter)},copyTo:function(n){return n[x]=this.x,n[y]=this.y,n[diameter]=this._diameter,n},distance:function(t,i){return typeof i=="undefined"&&(i=!1),i?n.Math.distanceRound(this.x,this.y,t.x,t.y):n.Math.distance(this.x,this.y,t.x,t.y)},clone:function(t){return typeof t=="undefined"&&(t=new n.Circle),t.setTo(a.x,a.y,a.diameter)},contains:function(t,i){return n.Circle.contains(this,t,i)},circumferencePoint:function(t,i,r){return n.Circle.circumferencePoint(this,t,i,r)},offset:function(n,t){return this.x+=n,this.y+=t,this},offsetPoint:function(n){return this.offset(n.x,n.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}},Object.defineProperty(n.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(n){n>0&&(this._diameter=n,this._radius=n*.5)}}),Object.defineProperty(n.Circle.prototype,"radius",{get:function(){return this._radius},set:function(n){n>0&&(this._radius=n,this._diameter=n*2)}}),Object.defineProperty(n.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(n){n>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-n}}),Object.defineProperty(n.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(n){n<this.x?(this._radius=0,this._diameter=0):this.radius=n-this.x}}),Object.defineProperty(n.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(n){n>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-n}}),Object.defineProperty(n.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(n){n<this.y?(this._radius=0,this._diameter=0):this.radius=n-this.y}}),Object.defineProperty(n.Circle.prototype,"area",{get:function(){return this._radius>0?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(n.Circle.prototype,"empty",{get:function(){return this._diameter==0},set:function(){this.setTo(0,0,0)}}),n.Circle.contains=function(n,t,i){if(t>=n.left&&t<=n.right&&i>=n.top&&i<=n.bottom){var r=(n.x-t)*(n.x-t),u=(n.y-i)*(n.y-i);return r+u<=n.radius*n.radius}return!1},n.Circle.equals=function(n,t){return n.x==t.x&&n.y==t.y&&n.diameter==t.diameter},n.Circle.intersects=function(t,i){return n.Math.distance(t.x,t.y,i.x,i.y)<=t.radius+i.radius},n.Circle.circumferencePoint=function(t,i,r,u){return typeof r=="undefined"&&(r=!1),typeof u=="undefined"&&(u=new n.Point),r===!0&&(i=n.Math.radToDeg(i)),u.x=t.x+t.radius*Math.cos(i),u.y=t.y+t.radius*Math.sin(i),u},n.Circle.intersectsRectangle=function(n,t){var r=Math.abs(n.x-t.x-t.halfWidth),o=t.halfWidth+n.radius,i,u;if(r>o||(i=Math.abs(n.y-t.y-t.halfHeight),u=t.halfHeight+n.radius,i>u))return!1;if(r<=t.halfWidth||i<=t.halfHeight)return!0;var f=r-t.halfWidth,e=i-t.halfHeight,s=f*f,h=e*e,c=n.radius*n.radius;return s+h<=c},n.Point=function(n,t){n=n||0,t=t||0,this.x=n,this.y=t},n.Point.prototype={copyFrom:function(n){return this.setTo(n.x,n.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(n,t){return this.x=n,this.y=t,this},add:function(n,t){return this.x+=n,this.y+=t,this},subtract:function(n,t){return this.x-=n,this.y-=t,this},multiply:function(n,t){return this.x*=n,this.y*=t,this},divide:function(n,t){return this.x/=n,this.y/=t,this},clampX:function(t,i){return this.x=n.Math.clamp(this.x,t,i),this},clampY:function(t,i){return this.y=n.Math.clamp(this.y,t,i),this},clamp:function(t,i){return this.x=n.Math.clamp(this.x,t,i),this.y=n.Math.clamp(this.y,t,i),this},clone:function(t){return typeof t=="undefined"&&(t=new n.Point),t.setTo(this.x,this.y)},copyFrom:function(n){return this.setTo(n.x,n.y)},copyTo:function(n){return n[x]=this.x,n[y]=this.y,n},distance:function(t,i){return n.Point.distance(this,t,i)},equals:function(n){return n.x==this.x&&n.y==this.y},rotate:function(t,i,r,u,f){return n.Point.rotate(this,t,i,r,u,f)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setMagnitude:function(n){return this.normalize().multiply(n,n)},normalize:function(){if(!this.isZero()){var n=this.getMagnitude();this.x/=n,this.y/=n}return this},isZero:function(){return this.x===0&&this.y===0},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}},n.Point.add=function(t,i,r){return typeof r=="undefined"&&(r=new n.Point),r.x=t.x+i.x,r.y=t.y+i.y,r},n.Point.subtract=function(t,i,r){return typeof r=="undefined"&&(r=new n.Point),r.x=t.x-i.x,r.y=t.y-i.y,r},n.Point.multiply=function(t,i,r){return typeof r=="undefined"&&(r=new n.Point),r.x=t.x*i.x,r.y=t.y*i.y,r},n.Point.divide=function(t,i,r){return typeof r=="undefined"&&(r=new n.Point),r.x=t.x/i.x,r.y=t.y/i.y,r},n.Point.equals=function(n,t){return n.x==t.x&&n.y==t.y},n.Point.distance=function(t,i,r){return typeof r=="undefined"&&(r=!1),r?n.Math.distanceRound(t.x,t.y,i.x,i.y):n.Math.distance(t.x,t.y,i.x,i.y)},n.Point.rotate=function(t,i,r,u,f,e){return f=f||!1,e=e||null,f&&(u=n.Math.degToRad(u)),e===null&&(e=Math.sqrt((i-t.x)*(i-t.x)+(r-t.y)*(r-t.y))),t.setTo(i+e*Math.cos(u),r+e*Math.sin(u))},n.Rectangle=function(n,t,i,r){n=n||0,t=t||0,i=i||0,r=r||0,this.x=n,this.y=t,this.width=i,this.height=r},n.Rectangle.prototype={offset:function(n,t){return this.x+=n,this.y+=t,this},offsetPoint:function(n){return this.offset(n.x,n.y)},setTo:function(n,t,i,r){return this.x=n,this.y=t,this.width=i,this.height=r,this},floor:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.floor(this.width),this.height=Math.floor(this.height)},copyFrom:function(n){return this.setTo(n.x,n.y,n.width,n.height)},copyTo:function(n){return n.x=this.x,n.y=this.y,n.width=this.width,n.height=this.height,n},inflate:function(t,i){return n.Rectangle.inflate(this,t,i)},size:function(t){return n.Rectangle.size(this,t)},clone:function(t){return n.Rectangle.clone(this,t)},contains:function(t,i){return n.Rectangle.contains(this,t,i)},containsRect:function(t){return n.Rectangle.containsRect(this,t)},equals:function(t){return n.Rectangle.equals(this,t)},intersection:function(t){return n.Rectangle.intersection(this,t,output)},intersects:function(t,i){return n.Rectangle.intersects(this,t,i)},intersectsRaw:function(t,i,r,u,f){return n.Rectangle.intersectsRaw(this,t,i,r,u,f)},union:function(t,i){return n.Rectangle.union(this,t,i)},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(n.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(n.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),Object.defineProperty(n.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(n){this.height=n<=this.y?0:this.y-n}}),Object.defineProperty(n.Rectangle.prototype,"bottomRight",{get:function(){return new n.Point(this.right,this.bottom)},set:function(n){this.right=n.x,this.bottom=n.y}}),Object.defineProperty(n.Rectangle.prototype,"left",{get:function(){return this.x},set:function(n){this.width=n>=this.right?0:this.right-n,this.x=n}}),Object.defineProperty(n.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(n){this.width=n<=this.x?0:this.x+n}}),Object.defineProperty(n.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Object.defineProperty(n.Rectangle.prototype,"perimeter",{get:function(){return this.width*2+this.height*2}}),Object.defineProperty(n.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(n){this.x=n-this.halfWidth}}),Object.defineProperty(n.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(n){this.y=n-this.halfHeight}}),Object.defineProperty(n.Rectangle.prototype,"top",{get:function(){return this.y},set:function(n){n>=this.bottom?(this.height=0,this.y=n):this.height=this.bottom-n}}),Object.defineProperty(n.Rectangle.prototype,"topLeft",{get:function(){return new n.Point(this.x,this.y)},set:function(n){this.x=n.x,this.y=n.y}}),Object.defineProperty(n.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(){this.setTo(0,0,0,0)}}),n.Rectangle.inflate=function(n,t,i){return n.x-=t,n.width+=2*t,n.y-=i,n.height+=2*i,n},n.Rectangle.inflatePoint=function(t,i){return n.Rectangle.inflate(t,i.x,i.y)},n.Rectangle.size=function(t,i){return typeof i=="undefined"&&(i=new n.Point),i.setTo(t.width,t.height)},n.Rectangle.clone=function(t,i){return typeof i=="undefined"&&(i=new n.Rectangle),i.setTo(t.x,t.y,t.width,t.height)},n.Rectangle.contains=function(n,t,i){return t>=n.x&&t<=n.right&&i>=n.y&&i<=n.bottom},n.Rectangle.containsRaw=function(n,t,i,r,u,f){return u>=n&&u<=n+i&&f>=t&&f<=t+r},n.Rectangle.containsPoint=function(t,i){return n.Rectangle.contains(t,i.x,i.y)},n.Rectangle.containsRect=function(n,t){return n.volume>t.volume?!1:n.x>=t.x&&n.y>=t.y&&n.right<=t.right&&n.bottom<=t.bottom},n.Rectangle.equals=function(n,t){return n.x==t.x&&n.y==t.y&&n.width==t.width&&n.height==t.height},n.Rectangle.intersection=function(t,i,r){return r=r||new n.Rectangle,n.Rectangle.intersects(t,i)&&(r.x=Math.max(t.x,i.x),r.y=Math.max(t.y,i.y),r.width=Math.min(t.right,i.right)-r.x,r.height=Math.min(t.bottom,i.bottom)-r.y),r},n.Rectangle.intersects=function(n,t){return n.x<t.right&&t.x<n.right&&n.y<t.bottom&&t.y<n.bottom},n.Rectangle.intersectsRaw=function(n,t,i,r,u,f){return typeof f=="undefined"&&(f=0),!(t>n.right+f||i<n.left-f||r>n.bottom+f||u<n.top-f)},n.Rectangle.union=function(t,i,r){return typeof r=="undefined"&&(r=new n.Rectangle),r.setTo(Math.min(t.x,i.x),Math.min(t.y,i.y),Math.max(t.right,i.right)-Math.min(t.left,i.left),Math.max(t.bottom,i.bottom)-Math.min(t.top,i.top))},n.Net=function(n){this.game=n},n.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(n){return window.location.hostname.indexOf(n)!==-1},updateQueryString:function(n,t,i,r){var u,f,o,e;if(typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r=""),r==""&&(r=window.location.href),u="",f=new RegExp("([?|&])"+n+"=.*?(&|#|$)(.*)","gi"),f.test(r)?u=typeof t!="undefined"&&t!==null?r.replace(f,"$1"+n+"="+t+"$2$3"):r.replace(f,"$1$3").replace(/(&|\?)$/,""):typeof t!="undefined"&&t!==null?(o=r.indexOf("?")!==-1?"&":"?",e=r.split("#"),r=e[0]+o+n+"="+t,e[1]&&(r+="#"+e[1]),u=r):u=r,i)window.location.href=u;else return u},getQueryString:function(n){var i,r,u,t;typeof n=="undefined"&&(n=""),i={},r=location.search.substring(1).split("&");for(u in r)if(t=r[u].split("="),t.length>1){if(n&&n==this.decodeURI(t[0]))return this.decodeURI(t[1]);i[this.decodeURI(t[0])]=this.decodeURI(t[1])}return i},decodeURI:function(n){return decodeURIComponent(n.replace(/\+/g," "))}},n.TweenManager=function(n){this.game=n,this._tweens=[],this._add=[],this.game.onPause.add(this.pauseAll,this),this.game.onResume.add(this.resumeAll,this)},n.TweenManager.prototype={REVISION:"11dev",getAll:function(){return this._tweens},removeAll:function(){this._tweens=[]},add:function(n){this._add.push(n)},create:function(t){return new n.Tween(t,this.game)},remove:function(n){var t=this._tweens.indexOf(n);t!==-1&&(this._tweens[t].pendingDelete=!0)},update:function(){if(this._tweens.length===0&&this._add.length===0)return!1;for(var n=0,t=this._tweens.length;n<t;)this._tweens[n].update(this.game.time.now)?n++:(this._tweens.splice(n,1),t--);return this._add.length>0&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(n){return this._tweens.some(function(t){return t._object===n})},pauseAll:function(){for(var n=this._tweens.length-1;n>=0;n--)this._tweens[n].pause()},resumeAll:function(){for(var n=this._tweens.length-1;n>=0;n--)this._tweens[n].resume()}},n.Tween=function(t,i){this._object=t,this.game=i,this._manager=this.game.tweens,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._yoyo=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=n.Easing.Linear.None,this._interpolationFunction=n.Math.linearInterpolation,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._pausedTime=0,this.pendingDelete=!1;for(var r in t)this._valuesStart[r]=parseFloat(t[r],10);this.onStart=new n.Signal,this.onComplete=new n.Signal,this.isRunning=!1},n.Tween.prototype={to:function(n,t,i,r,u,f,e){t=t||1e3,i=i||null,r=r||!1,u=u||0,f=f||0,e=e||!1;var o;return this._parent?(o=this._manager.create(this._object),this._lastChild.chain(o),this._lastChild=o):(o=this,this._parent=this,this._lastChild=this),o._repeat=f,o._duration=t,o._valuesEnd=n,i!==null&&(o._easingFunction=i),u>0&&(o._delayTime=u),o._yoyo=e,r?this.start():this},start:function(){if(this.game!==null&&this._object!==null){this._manager.add(this),this.onStart.dispatch(this._object),this.isRunning=!0,this._onStartCallbackFired=!1,this._startTime=this.game.time.now+this._delayTime;for(var n in this._valuesEnd){if(this._valuesEnd[n]instanceof Array){if(this._valuesEnd[n].length===0)continue;this._valuesEnd[n]=[this._object[n]].concat(this._valuesEnd[n])}this._valuesStart[n]=this._object[n],this._valuesStart[n]instanceof Array==!1&&(this._valuesStart[n]*=1),this._valuesStartRepeat[n]=this._valuesStart[n]||0}return this}},stop:function(){return this.isRunning=!1,this._manager.remove(this),this},delay:function(n){return this._delayTime=n,this},repeat:function(n){return this._repeat=n,this},yoyo:function(n){return this._yoyo=n,this},easing:function(n){return this._easingFunction=n,this},interpolation:function(n){return this._interpolationFunction=n,this},chain:function(){return this._chainedTweens=arguments,this},loop:function(){return this._lastChild.chain(this),this},onStartCallback:function(n){return this._onStartCallback=n,this},onUpdateCallback:function(n){return this._onUpdateCallback=n,this},onCompleteCallback:function(n){return this._onCompleteCallback=n,this},pause:function(){this._paused=!0,this._pausedTime=this.game.time.now},resume:function(){this._paused=!1,this._startTime+=this.game.time.now-this._pausedTime},update:function(n){var t,r,u,f,i,o,e,s;if(this.pendingDelete)return!1;if(this._paused||n<this._startTime||n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback!==null&&this._onStartCallback.call(this._object),this._onStartCallbackFired=!0),r=(n-this._startTime)/this._duration,r=r>1?1:r,u=this._easingFunction(r);for(t in this._valuesEnd)f=this._valuesStart[t]||0,i=this._valuesEnd[t],i instanceof Array?this._object[t]=this._interpolationFunction(i,u):(typeof i=="string"&&(i=f+parseFloat(i,10)),typeof i=="number"&&(this._object[t]=f+(i-f)*u));if(this._onUpdateCallback!==null&&this._onUpdateCallback.call(this._object,u),r==1){if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(t in this._valuesStartRepeat)typeof this._valuesEnd[t]=="string"&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t],10)),this._yoyo&&(o=this._valuesStartRepeat[t],this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=o,this._reversed=!this._reversed),this._valuesStart[t]=this._valuesStartRepeat[t];return this._startTime=n+this._delayTime,this.onComplete.dispatch(this._object),this._onCompleteCallback!==null&&this._onCompleteCallback.call(this._object),!0}for(this.onComplete.dispatch(this._object),this._onCompleteCallback!==null&&this._onCompleteCallback.call(this._object),e=0,s=this._chainedTweens.length;e<s;e++)this._chainedTweens[e].start(n);return!1}return!0}},n.Easing={Linear:{None:function(n){return n}},Quadratic:{In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}},Cubic:{In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}},Quartic:{In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}},Quintic:{In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}},Sinusoidal:{In:function(n){return 1-Math.cos(n*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return.5*(1-Math.cos(Math.PI*n))}},Exponential:{In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}},Circular:{In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}},Elastic:{In:function(n){var i,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,i=r/4):i=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(n-=1))*Math.sin((n-i)*2*Math.PI/r)))},Out:function(n){var i,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,i=r/4):i=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*n)*Math.sin((n-i)*2*Math.PI/r)+1)},InOut:function(n){var i,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,i=r/4):i=r*Math.asin(1/t)/(2*Math.PI),(n*=2)<1)?-.5*t*Math.pow(2,10*(n-=1))*Math.sin((n-i)*2*Math.PI/r):t*Math.pow(2,-10*(n-=1))*Math.sin((n-i)*2*Math.PI/r)*.5+1}},Back:{In:function(n){var t=1.70158;return n*n*((t+1)*n-t)},Out:function(n){var t=1.70158;return--n*n*((t+1)*n+t)+1},InOut:function(n){var t=1.70158*1.525;return(n*=2)<1?.5*n*n*((t+1)*n-t):.5*((n-=2)*n*((t+1)*n+t)+2)}},Bounce:{In:function(t){return 1-n.Easing.Bounce.Out(1-t)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(t){return t<.5?n.Easing.Bounce.In(t*2)*.5:n.Easing.Bounce.Out(t*2-1)*.5+.5}}},n.Time=function(n){this.game=n,this._started=0,this._timeLastSecond=0,this._pauseStarted=0,this.physicsElapsed=0,this.time=0,this.pausedTime=0,this.now=0,this.elapsed=0,this.fps=0,this.fpsMin=1e3,this.fpsMax=0,this.msMin=1e3,this.msMax=0,this.frames=0,this.pauseDuration=0,this.timeToCall=0,this.lastTime=0,this.game.onPause.add(this.gamePaused,this),this.game.onResume.add(this.gameResumed,this),this._justResumed=!1},n.Time.prototype={totalElapsedSeconds:function(){return(this.now-this._started)*.001},update:function(n){this.now=n,this._justResumed&&(this.time=this.now,this._justResumed=!1),this.timeToCall=this.game.math.max(0,16-(n-this.lastTime)),this.elapsed=this.now-this.time,this.msMin=this.game.math.min(this.msMin,this.elapsed),this.msMax=this.game.math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1e3&&(this.fps=Math.round(this.frames*1e3/(this.now-this._timeLastSecond)),this.fpsMin=this.game.math.min(this.fpsMin,this.fps),this.fpsMax=this.game.math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0),this.time=this.now,this.lastTime=n+this.timeToCall,this.physicsElapsed=this.elapsed/1e3,this.physicsElapsed>1&&(this.physicsElapsed=1),this.game.paused&&(this.pausedTime=this.now-this._pauseStarted)},gamePaused:function(){this._pauseStarted=this.now},gameResumed:function(){this.time=Date.now(),this.pauseDuration=this.pausedTime,this._justResumed=!0},elapsedSince:function(n){return this.now-n},elapsedSecondsSince:function(n){return(this.now-n)*.001},reset:function(){this._started=this.now}},n.AnimationManager=function(n){this.sprite=n,this.game=n.game,this.currentFrame=null,this.updateIfVisible=!0,this.isLoaded=!1,this._frameData=null,this._anims={},this._outputFrames=[]},n.AnimationManager.prototype={loadFrameData:function(n){this._frameData=n,this.frame=0,this.isLoaded=!0},add:function(i,r,u,f,e){if(this._frameData==null){console.warn("No FrameData available for Phaser.Animation "+i);return}return u=u||60,typeof f=="undefined"&&(f=!1),typeof e=="undefined"&&(e=r&&typeof r[0]=="number"?!0:!1),this.sprite.events.onAnimationStart==null&&(this.sprite.events.onAnimationStart=new n.Signal,this.sprite.events.onAnimationComplete=new n.Signal,this.sprite.events.onAnimationLoop=new n.Signal),this._outputFrames.length=0,this._frameData.getFrameIndexes(r,e,this._outputFrames),this._anims[i]=new n.Animation(this.game,this.sprite,i,this._frameData,this._outputFrames,u,f),this.currentAnim=this._anims[i],this.currentFrame=this.currentAnim.currentFrame,this.sprite.setTexture(t.TextureCache[this.currentFrame.uuid]),this._anims[i]},validateFrames:function(n,t){typeof t=="undefined"&&(t=!0);for(var i=0;i<n.length;i++)if(t==!0){if(n[i]>this._frameData.total)return!1}else if(this._frameData.checkFrameName(n[i])==!1)return!1;return!0},play:function(n,t,i,r){if(this._anims[n])if(this.currentAnim==this._anims[n]){if(this.currentAnim.isPlaying==!1)return this.currentAnim.paused=!1,this.currentAnim.play(t,i,r)}else return this.currentAnim=this._anims[n],this.currentAnim.paused=!1,this.currentAnim.play(t,i,r)},stop:function(n,t){typeof t=="undefined"&&(t=!1),typeof n=="string"?this._anims[n]&&(this.currentAnim=this._anims[n],this.currentAnim.stop(t)):this.currentAnim&&this.currentAnim.stop(t)},update:function(){return this.updateIfVisible&&this.sprite.visible==!1?!1:this.currentAnim&&this.currentAnim.update()==!0?(this.currentFrame=this.currentAnim.currentFrame,this.sprite.currentFrame=this.currentFrame,!0):!1},refreshFrame:function(){this.sprite.currentFrame=this.currentFrame,this.sprite.setTexture(t.TextureCache[this.currentFrame.uuid])},destroy:function(){this._anims={},this._frameData=null,this._frameIndex=0,this.currentAnim=null,this.currentFrame=null}},Object.defineProperty(n.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}}),Object.defineProperty(n.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData?this._frameData.total:-1}}),Object.defineProperty(n.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(n){this.currentAnim.paused=n}}),Object.defineProperty(n.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this._frameIndex},set:function(n){typeof n=="number"&&this._frameData&&this._frameData.getFrame(n)!==null&&(this.currentFrame=this._frameData.getFrame(n),this._frameIndex=n,this.sprite.currentFrame=this.currentFrame,this.sprite.setTexture(t.TextureCache[this.currentFrame.uuid]))}}),Object.defineProperty(n.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},set:function(n){typeof n=="string"&&this._frameData&&this._frameData.getFrameByName(n)!==null?(this.currentFrame=this._frameData.getFrameByName(n),this._frameIndex=this.currentFrame.index,this.sprite.currentFrame=this.currentFrame,this.sprite.setTexture(t.TextureCache[this.currentFrame.uuid])):console.warn("Cannot set frameName: "+n)}}),n.Animation=function(n,t,i,r,u,f,e){this.game=n,this._parent=t,this._frameData=r,this.name=i,this._frames=[],this._frames=this._frames.concat(u),this.delay=1e3/f,this.looped=e,this.killOnComplete=!1,this.isFinished=!1,this.isPlaying=!1,this.isPaused=!1,this._pauseStartTime=0,this._frameIndex=0,this._frameDiff=0,this._frameSkip=1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex])},n.Animation.prototype={play:function(n,i,r){return typeof n=="number"&&(this.delay=1e3/n),typeof i=="boolean"&&(this.looped=i),typeof r!="undefined"&&(this.killOnComplete=r),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this._timeLastFrame=this.game.time.now,this._timeNextFrame=this.game.time.now+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setTexture(t.TextureCache[this.currentFrame.uuid]),this._parent.events&&this._parent.events.onAnimationStart.dispatch(this._parent,this),this},restart:function(){this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this._timeLastFrame=this.game.time.now,this._timeNextFrame=this.game.time.now+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex])},stop:function(n){typeof n=="undefined"&&(n=!1),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,n&&(this.currentFrame=this._frameData.getFrame(this._frames[0]))},update:function(){return this.isPaused?!1:this.isPlaying==!0&&this.game.time.now>=this._timeNextFrame?(this._frameSkip=1,this._frameDiff=this.game.time.now-this._timeNextFrame,this._timeLastFrame=this.game.time.now,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.now+(this.delay-this._frameDiff),this._frameIndex+=this._frameSkip,this._frameIndex>=this._frames.length?this.looped?(this._frameIndex%=this._frames.length,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&this._parent.setTexture(t.TextureCache[this.currentFrame.uuid]),this._parent.events.onAnimationLoop.dispatch(this._parent,this)):this.onComplete():(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setTexture(t.TextureCache[this.currentFrame.uuid])),!0):!1},destroy:function(){this.game=null,this._parent=null,this._frames=null,this._frameData=null,this.currentFrame=null,this.isPlaying=!1},onComplete:function(){this.isPlaying=!1,this.isFinished=!0,this.paused=!1,this._parent.events&&this._parent.events.onAnimationComplete.dispatch(this._parent,this),this.killOnComplete&&this._parent.kill()}},Object.defineProperty(n.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(n){this.isPaused=n,n?this._pauseStartTime=this.game.time.now:this.isPlaying&&(this._timeNextFrame=this.game.time.now+this.delay)}}),Object.defineProperty(n.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}}),Object.defineProperty(n.Animation.prototype,"frame",{get:function(){return this.currentFrame!==null?this.currentFrame.index:this._frameIndex},set:function(n){this.currentFrame=this._frameData.getFrame(n),this.currentFrame!==null&&(this._frameIndex=n,this._parent.setTexture(t.TextureCache[this.currentFrame.uuid]))}}),n.Animation.generateFrameNames=function(t,i,r,u,f){var s,o,e;if(typeof u=="undefined"&&(u=""),s=[],o="",i<r)for(e=i;e<=r;e++)o=typeof f=="number"?n.Utils.pad(e.toString(),f,"0",1):e.toString(),o=t+o+u,s.push(o);else for(e=i;e>=r;e--)o=typeof f=="number"?n.Utils.pad(e.toString(),f,"0",1):e.toString(),o=t+o+u,s.push(o);return s},n.Frame=function(t,i,r,u,f,e,o){this.index=t,this.x=i,this.y=r,this.width=u,this.height=f,this.name=e,this.uuid=o,this.centerX=Math.floor(u/2),this.centerY=Math.floor(f/2),this.distance=n.Math.distance(0,0,u,f),this.rotated=!1,this.rotationDirection="cw",this.trimmed=!1,this.sourceSizeW=u,this.sourceSizeH=f,this.spriteSourceSizeX=0,this.spriteSourceSizeY=0,this.spriteSourceSizeW=0,this.spriteSourceSizeH=0},n.Frame.prototype={setTrim:function(n,t,i,r,u,f,e){this.trimmed=n,n&&(this.width=t,this.height=i,this.sourceSizeW=t,this.sourceSizeH=i,this.centerX=Math.floor(t/2),this.centerY=Math.floor(i/2),this.spriteSourceSizeX=r,this.spriteSourceSizeY=u,this.spriteSourceSizeW=f,this.spriteSourceSizeH=e)}},n.FrameData=function(){this._frames=[],this._frameNames=[]},n.FrameData.prototype={addFrame:function(n){return n.index=this._frames.length,this._frames.push(n),n.name!==""&&(this._frameNames[n.name]=n.index),n},getFrame:function(n){return this._frames.length>n?this._frames[n]:null},getFrameByName:function(n){return typeof this._frameNames[n]=="number"?this._frames[this._frameNames[n]]:null},checkFrameName:function(n){return this._frameNames[n]==null?!1:!0},getFrameRange:function(n,t,i){typeof i=="undefined"&&(i=[]);for(var r=n;r<=t;r++)i.push(this._frames[r]);return i},getFrames:function(n,t,i){var r,u;if(typeof t=="undefined"&&(t=!0),typeof i=="undefined"&&(i=[]),typeof n=="undefined"||n.length==0)for(r=0;r<this._frames.length;r++)i.push(this._frames[r]);else for(r=0,u=n.length;r<u;r++)t?i.push(this.getFrame(n[r])):i.push(this.getFrameByName(n[r]));return i},getFrameIndexes:function(n,t,i){var r,u;if(typeof t=="undefined"&&(t=!0),typeof i=="undefined"&&(i=[]),typeof n=="undefined"||n.length==0)for(r=0,u=this._frames.length;r<u;r++)i.push(this._frames[r].index);else for(r=0,u=n.length;r<u;r++)t?i.push(n[r]):this.getFrameByName(n[r])&&i.push(this.getFrameByName(n[r]).index);return i}},Object.defineProperty(n.FrameData.prototype,"total",{get:function(){return this._frames.length}}),n.AnimationParser={spriteSheet:function(i,r,u,f,e){var l=i.cache.getImage(r),o,s,c,y;if(l==null)return null;o=l.width,s=l.height,u<=0&&(u=Math.floor(-o/Math.min(-1,u))),f<=0&&(f=Math.floor(-s/Math.min(-1,f)));var w=Math.round(o/u),b=Math.round(s/f),a=w*b;if(e!==-1&&(a=e),o==0||s==0||o<u||s<f||a===0)return console.warn("Phaser.AnimationParser.spriteSheet: width/height zero or width/height < given frameWidth/frameHeight"),null;var p=new n.FrameData,h=0,v=0;for(c=0;c<a;c++)y=i.rnd.uuid(),p.addFrame(new n.Frame(c,h,v,u,f,"",y)),t.TextureCache[y]=new t.Texture(t.BaseTextureCache[r],{x:h,y:v,width:u,height:f}),h+=u,h===o&&(h=0,v+=f);return p},JSONData:function(i,r,u){var s,e,h,f,o;if(!r.frames){console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"),console.log(r);return}for(s=new n.FrameData,e=r.frames,f=0;f<e.length;f++)o=i.rnd.uuid(),h=s.addFrame(new n.Frame(f,e[f].frame.x,e[f].frame.y,e[f].frame.w,e[f].frame.h,e[f].filename,o)),t.TextureCache[o]=new t.Texture(t.BaseTextureCache[u],{x:e[f].frame.x,y:e[f].frame.y,width:e[f].frame.w,height:e[f].frame.h}),e[f].trimmed&&(h.setTrim(e[f].trimmed,e[f].sourceSize.w,e[f].sourceSize.h,e[f].spriteSourceSize.x,e[f].spriteSourceSize.y,e[f].spriteSourceSize.w,e[f].spriteSourceSize.h),t.TextureCache[o].trimmed=!0,t.TextureCache[o].trim.x=e[f].spriteSourceSize.x,t.TextureCache[o].trim.y=e[f].spriteSourceSize.y);return s},JSONDataHash:function(i,r,u){var f,o;if(!r.frames){console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"),console.log(r);return}var s=new n.FrameData,e=r.frames,h,c=0;for(f in e)o=i.rnd.uuid(),h=s.addFrame(new n.Frame(c,e[f].frame.x,e[f].frame.y,e[f].frame.w,e[f].frame.h,f,o)),t.TextureCache[o]=new t.Texture(t.BaseTextureCache[u],{x:e[f].frame.x,y:e[f].frame.y,width:e[f].frame.w,height:e[f].frame.h}),e[f].trimmed&&(h.setTrim(e[f].trimmed,e[f].sourceSize.w,e[f].sourceSize.h,e[f].spriteSourceSize.x,e[f].spriteSourceSize.y,e[f].spriteSourceSize.w,e[f].spriteSourceSize.h),t.TextureCache[o].trimmed=!0,t.TextureCache[o].trim.x=e[f].spriteSourceSize.x,t.TextureCache[o].trim.y=e[f].spriteSourceSize.y),c++;return s},XMLData:function(i,r,u){var a,v,k,e,f,y,p,c,l,o,s,w,b,h;if(!r.getElementsByTagName("TextureAtlas")){console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag");return}for(a=new n.FrameData,v=r.getElementsByTagName("SubTexture"),h=0;h<v.length;h++)e=i.rnd.uuid(),f=v[h].attributes,name=f.name.nodeValue,y=parseInt(f.x.nodeValue),p=parseInt(f.y.nodeValue),c=parseInt(f.width.nodeValue),l=parseInt(f.height.nodeValue),o=null,s=null,f.frameX&&(o=Math.abs(parseInt(f.frameX.nodeValue)),s=Math.abs(parseInt(f.frameY.nodeValue)),w=parseInt(f.frameWidth.nodeValue),b=parseInt(f.frameHeight.nodeValue)),k=a.addFrame(new n.Frame(h,y,p,c,l,name,e)),t.TextureCache[e]=new t.Texture(t.BaseTextureCache[u],{x:y,y:p,width:c,height:l}),(o!==null||s!==null)&&(k.setTrim(!0,c,l,o,s,w,b),t.TextureCache[e].realSize={x:o,y:s,w:w,h:b},t.TextureCache[e].trimmed=!0,t.TextureCache[e].trim.x=o,t.TextureCache[e].trim.y=s);return a}},n.Cache=function(t){this.game=t,this._canvases={},this._images={},this._textures={},this._sounds={},this._text={},this._tilemaps={},this._tilesets={},this.addDefaultImage(),this.onSoundUnlock=new n.Signal},n.Cache.prototype={addCanvas:function(n,t,i){this._canvases[n]={canvas:t,context:i}},addRenderTexture:function(t,i){var r=new n.Frame(0,0,0,i.width,i.height,"","");this._textures[t]={texture:i,frame:r}},addSpriteSheet:function(i,r,u,f,e,o){this._images[i]={url:r,data:u,spriteSheet:!0,frameWidth:f,frameHeight:e},t.BaseTextureCache[i]=new t.BaseTexture(u),t.TextureCache[i]=new t.Texture(t.BaseTextureCache[i]),this._images[i].frameData=n.AnimationParser.spriteSheet(this.game,i,f,e,o)},addTileset:function(i,r,u,f,e,o,s,h){this._tilesets[i]={url:r,data:u,tileWidth:f,tileHeight:e,tileMargin:s,tileSpacing:h},t.BaseTextureCache[i]=new t.BaseTexture(u),t.TextureCache[i]=new t.Texture(t.BaseTextureCache[i]),this._tilesets[i].tileData=n.TilemapParser.tileset(this.game,i,f,e,o,s,h)},addTilemap:function(t,i,r,u){this._tilemaps[t]={url:i,data:r,format:u},this._tilemaps[t].layers=n.TilemapParser.parse(this.game,r,u)},addTextureAtlas:function(i,r,u,f,e){this._images[i]={url:r,data:u,spriteSheet:!0},t.BaseTextureCache[i]=new t.BaseTexture(u),t.TextureCache[i]=new t.Texture(t.BaseTextureCache[i]),e==n.Loader.TEXTURE_ATLAS_JSON_ARRAY?this._images[i].frameData=n.AnimationParser.JSONData(this.game,f,i):e==n.Loader.TEXTURE_ATLAS_JSON_HASH?this._images[i].frameData=n.AnimationParser.JSONDataHash(this.game,f,i):e==n.Loader.TEXTURE_ATLAS_XML_STARLING&&(this._images[i].frameData=n.AnimationParser.XMLData(this.game,f,i))},addBitmapFont:function(i,r,u,f){this._images[i]={url:r,data:u,spriteSheet:!0},t.BaseTextureCache[i]=new t.BaseTexture(u),t.TextureCache[i]=new t.Texture(t.BaseTextureCache[i]),n.LoaderParser.bitmapFont(this.game,f,i)},addDefaultImage:function(){var i=new Image;i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==",this._images.__default={url:null,data:i,spriteSheet:!1},this._images.__default.frame=new n.Frame(0,0,0,32,32,"",""),t.BaseTextureCache.__default=new t.BaseTexture(i),t.TextureCache.__default=new t.Texture(t.BaseTextureCache.__default)},addText:function(n,t,i){this._text[n]={url:t,data:i}},addImage:function(i,r,u){this._images[i]={url:r,data:u,spriteSheet:!1},this._images[i].frame=new n.Frame(0,0,0,u.width,u.height,i,this.game.rnd.uuid()),t.BaseTextureCache[i]=new t.BaseTexture(u),t.TextureCache[i]=new t.Texture(t.BaseTextureCache[i])},addSound:function(n,t,i,r,u){r=r||!0,u=u||!1;var e=this.game.sound.touchLocked,f=!1;u&&(f=!0),this._sounds[n]={url:t,data:i,isDecoding:!1,decoded:f,webAudio:r,audioTag:u}},reloadSound:function(n){var t=this;this._sounds[n]&&(this._sounds[n].data.src=this._sounds[n].url,this._sounds[n].data.addEventListener("canplaythrough",function(){return t.reloadSoundComplete(n)},!1),this._sounds[n].data.load())},reloadSoundComplete:function(n){this._sounds[n]&&(this._sounds[n].locked=!1,this.onSoundUnlock.dispatch(n))},updateSound:function(n,t,i){this._sounds[n]&&(this._sounds[n][t]=i)},decodedSound:function(n,t){this._sounds[n].data=t,this._sounds[n].decoded=!0,this._sounds[n].isDecoding=!1},getCanvas:function(n){return this._canvases[n]?this._canvases[n].canvas:null},checkImageKey:function(n){return this._images[n]?!0:!1},getImage:function(n){return this._images[n]?this._images[n].data:null},getTilesetImage:function(n){return this._tilesets[n]?this._tilesets[n].data:null},getTileset:function(n){return this._tilesets[n]?this._tilesets[n].tileData:null},getTilemapData:function(n){return this._tilemaps[n]?this._tilemaps[n]:null},getFrameData:function(n){return this._images[n]&&this._images[n].frameData?this._images[n].frameData:null},getFrameByIndex:function(n,t){return this._images[n]&&this._images[n].frameData?this._images[n].frameData.getFrame(t):null},getFrameByName:function(n,t){return this._images[n]&&this._images[n].frameData?this._images[n].frameData.getFrameByName(t):null},getFrame:function(n){return this._images[n]&&this._images[n].spriteSheet==!1?this._images[n].frame:null},getTextureFrame:function(n){return this._textures[n]?this._textures[n].frame:null},getTexture:function(n){return this._textures[n]?this._textures[n]:null},getSound:function(n){return this._sounds[n]?this._sounds[n]:null},getSoundData:function(n){return this._sounds[n]?this._sounds[n].data:null},isSoundDecoded:function(n){if(this._sounds[n])return this._sounds[n].decoded},isSoundReady:function(n){return this._sounds[n]&&this._sounds[n].decoded&&this.game.sound.touchLocked==!1},isSpriteSheet:function(n){return this._images[n]?this._images[n].spriteSheet:!1},getText:function(n){return this._text[n]?this._text[n].data:null},getKeys:function(n){var i=[],t;for(t in n)t!=="__default"&&i.push(t);return i},getImageKeys:function(){return this.getKeys(this._images)},getSoundKeys:function(){return this.getKeys(this._sounds)},getTextKeys:function(){return this.getKeys(this._text)},removeCanvas:function(n){delete this._canvases[n]},removeImage:function(n){delete this._images[n]},removeSound:function(n){delete this._sounds[n]},removeText:function(n){delete this._text[n]},destroy:function(){var n;for(n in this._canvases)delete this._canvases[n.key];for(n in this._images)delete this._images[n.key];for(n in this._sounds)delete this._sounds[n.key];for(n in this._text)delete this._text[n.key]}},n.Loader=function(t){this.game=t,this._keys=[],this._fileList={},this._progressChunk=0,this._xhr=new XMLHttpRequest,this.queueSize=0,this.isLoading=!1,this.hasLoaded=!1,this.progress=0,this.preloadSprite=null,this.crossOrigin="",this.baseURL="",this.onFileComplete=new n.Signal,this.onFileError=new n.Signal,this.onLoadStart=new n.Signal,this.onLoadComplete=new n.Signal},n.Loader.TEXTURE_ATLAS_JSON_ARRAY=0,n.Loader.TEXTURE_ATLAS_JSON_HASH=1,n.Loader.TEXTURE_ATLAS_XML_STARLING=2,n.Loader.prototype={setPreloadSprite:function(t,i){i=i||0,this.preloadSprite={sprite:t,direction:i,width:t.width,height:t.height,crop:null},this.preloadSprite.crop=i==0?new n.Rectangle(0,0,1,t.height):new n.Rectangle(0,0,t.width,1),t.crop=this.preloadSprite.crop,t.cropEnabled=!0},checkKeyExists:function(n){return this._fileList[n]?!0:!1},reset:function(){this.preloadSprite=null,this.queueSize=0,this.isLoading=!1},addToFileList:function(n,t,i,r){var f={type:n,key:t,url:i,data:null,error:!1,loaded:!1},u;if(typeof r!="undefined")for(u in r)f[u]=r[u];this._fileList[t]=f,this._keys.push(t),this.queueSize++},image:function(n,t,i){return typeof i=="undefined"&&(i=!1),(i||this.checkKeyExists(n)==!1)&&this.addToFileList("image",n,t),this},text:function(n,t,i){return typeof i=="undefined"&&(i=!1),(i||this.checkKeyExists(n)==!1)&&this.addToFileList("text",n,t),this},spritesheet:function(n,t,i,r,u){return typeof u=="undefined"&&(u=-1),this.checkKeyExists(n)===!1&&this.addToFileList("spritesheet",n,t,{frameWidth:i,frameHeight:r,frameMax:u}),this},tileset:function(n,t,i,r,u,f,e){return typeof u=="undefined"&&(u=-1),typeof f=="undefined"&&(f=0),typeof e=="undefined"&&(e=0),this.checkKeyExists(n)===!1&&this.addToFileList("tileset",n,t,{tileWidth:i,tileHeight:r,tileMax:u,tileMargin:f,tileSpacing:e}),this},audio:function(n,t,i){return typeof i=="undefined"&&(i=!0),this.checkKeyExists(n)===!1&&this.addToFileList("audio",n,t,{buffer:null,autoDecode:i}),this},tilemap:function(t,i,r,u){if(typeof i=="undefined"&&(i=null),typeof r=="undefined"&&(r=null),typeof u=="undefined"&&(u=n.Tilemap.CSV),i==null&&r==null)return console.warn("Phaser.Loader.tilemap - Both mapDataURL and mapData are null. One must be set."),this;if(this.checkKeyExists(t)===!1)if(i)this.addToFileList("tilemap",t,i,{format:u});else{switch(u){case n.Tilemap.TILED_JSON:typeof r=="string"&&(r=JSON.parse(r))}this.game.cache.addTilemap(t,null,r,u)}return this},bitmapFont:function(n,t,i,r){var u,f;if(typeof i=="undefined"&&(i=null),typeof r=="undefined"&&(r=null),this.checkKeyExists(n)===!1)if(i)this.addToFileList("bitmapfont",n,t,{xmlURL:i});else if(typeof r=="string"){try{window.DOMParser?(f=new DOMParser,u=f.parseFromString(r,"text/xml")):(u=new ActiveXObject("Microsoft.XMLDOM"),u.async="false",u.loadXML(r))}catch(e){u=undefined}if(u&&u.documentElement&&!u.getElementsByTagName("parsererror").length)this.addToFileList("bitmapfont",n,t,{xmlURL:null,xmlData:u});else throw new Error("Phaser.Loader. Invalid Bitmap Font XML given");}return this},atlasJSONArray:function(t,i,r,u){return this.atlas(t,i,r,u,n.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(t,i,r,u){return this.atlas(t,i,r,u,n.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(t,i,r,u){return this.atlas(t,i,r,u,n.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(t,i,r,u,f){var e,o;if(typeof r=="undefined"&&(r=null),typeof u=="undefined"&&(u=null),typeof f=="undefined"&&(f=n.Loader.TEXTURE_ATLAS_JSON_ARRAY),this.checkKeyExists(t)===!1)if(r)this.addToFileList("textureatlas",t,i,{atlasURL:r,format:f});else{switch(f){case n.Loader.TEXTURE_ATLAS_JSON_ARRAY:typeof u=="string"&&(u=JSON.parse(u));break;case n.Loader.TEXTURE_ATLAS_XML_STARLING:if(typeof u=="string"){try{window.DOMParser?(o=new DOMParser,e=o.parseFromString(u,"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(u))}catch(s){e=undefined}if(e&&e.documentElement&&!e.getElementsByTagName("parsererror").length)u=e;else throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");}}this.addToFileList("textureatlas",t,i,{atlasURL:null,atlasData:u,format:f})}return this},removeFile:function(n){delete this._fileList[n]},removeAll:function(){this._fileList={}},start:function(){this.isLoading||(this.progress=0,this.hasLoaded=!1,this.isLoading=!0,this.onLoadStart.dispatch(this.queueSize),this._keys.length>0?(this._progressChunk=100/this._keys.length,this.loadFile()):(this.progress=100,this.hasLoaded=!0,this.onLoadComplete.dispatch()))},loadFile:function(){var t=this._fileList[this._keys.shift()],i=this;switch(t.type){case"image":case"spritesheet":case"textureatlas":case"bitmapfont":case"tileset":t.data=new Image,t.data.name=t.key,t.data.onload=function(){return i.fileComplete(t.key)},t.data.onerror=function(){return i.fileError(t.key)},t.data.crossOrigin=this.crossOrigin,t.data.src=this.baseURL+t.url;break;case"audio":t.url=this.getAudioURL(t.url),t.url!==null?this.game.sound.usingWebAudio?(this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="arraybuffer",this._xhr.onload=function(){return i.fileComplete(t.key)},this._xhr.onerror=function(){return i.fileError(t.key)},this._xhr.send()):this.game.sound.usingAudioTag&&(this.game.sound.touchLocked?(t.data=new Audio,t.data.name=t.key,t.data.preload="auto",t.data.src=this.baseURL+t.url,this.fileComplete(t.key)):(t.data=new Audio,t.data.name=t.key,t.data.onerror=function(){return i.fileError(t.key)},t.data.preload="auto",t.data.src=this.baseURL+t.url,t.data.addEventListener("canplaythrough",n.GAMES[this.game.id].load.fileComplete(t.key),!1),t.data.load())):this.fileError(t.key);break;case"tilemap":this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="text",t.format==n.Tilemap.TILED_JSON?this._xhr.onload=function(){return i.jsonLoadComplete(t.key)}:t.format==n.Tilemap.CSV&&(this._xhr.onload=function(){return i.csvLoadComplete(t.key)}),this._xhr.onerror=function(){return i.dataLoadError(t.key)},this._xhr.send();break;case"text":this._xhr.open("GET",this.baseURL+t.url,!0),this._xhr.responseType="text",this._xhr.onload=function(){return i.fileComplete(t.key)},this._xhr.onerror=function(){return i.fileError(t.key)},this._xhr.send()}},getAudioURL:function(n){for(var t,i=0;i<n.length;i++)if(t=n[i].toLowerCase(),t=t.substr((Math.max(0,t.lastIndexOf("."))||Infinity)+1),this.game.device.canPlayAudio(t))return n[i];return null},fileError:function(n){this._fileList[n].loaded=!0,this._fileList[n].error=!0,this.onFileError.dispatch(n),console.warn("Phaser.Loader error loading file: "+n+" from URL "+this._fileList[n].url),this.nextFile(n,!1)},fileComplete:function(t){var f,t;if(!this._fileList[t]){console.warn("Phaser.Loader fileComplete invalid key "+t);return}this._fileList[t].loaded=!0;var i=this._fileList[t],u=!0,r=this;switch(i.type){case"image":this.game.cache.addImage(i.key,i.url,i.data);break;case"spritesheet":this.game.cache.addSpriteSheet(i.key,i.url,i.data,i.frameWidth,i.frameHeight,i.frameMax);break;case"tileset":this.game.cache.addTileset(i.key,i.url,i.data,i.tileWidth,i.tileHeight,i.tileMax,i.tileMargin,i.tileSpacing);break;case"textureatlas":i.atlasURL==null?this.game.cache.addTextureAtlas(i.key,i.url,i.data,i.atlasData,i.format):(u=!1,this._xhr.open("GET",this.baseURL+i.atlasURL,!0),this._xhr.responseType="text",i.format==n.Loader.TEXTURE_ATLAS_JSON_ARRAY||i.format==n.Loader.TEXTURE_ATLAS_JSON_HASH?this._xhr.onload=function(){return r.jsonLoadComplete(i.key)}:i.format==n.Loader.TEXTURE_ATLAS_XML_STARLING&&(this._xhr.onload=function(){return r.xmlLoadComplete(i.key)}),this._xhr.onerror=function(){return r.dataLoadError(i.key)},this._xhr.send());break;case"bitmapfont":i.xmlURL==null?this.game.cache.addBitmapFont(i.key,i.url,i.data,i.xmlData):(u=!1,this._xhr.open("GET",this.baseURL+i.xmlURL,!0),this._xhr.responseType="text",this._xhr.onload=function(){return r.xmlLoadComplete(i.key)},this._xhr.onerror=function(){return r.dataLoadError(i.key)},this._xhr.send());break;case"audio":this.game.sound.usingWebAudio?(i.data=this._xhr.response,this.game.cache.addSound(i.key,i.url,i.data,!0,!1),i.autoDecode&&(this.game.cache.updateSound(t,"isDecoding",!0),f=this,t=i.key,this.game.sound.context.decodeAudioData(i.data,function(n){n&&f.game.cache.decodedSound(t,n)}))):(i.data.removeEventListener("canplaythrough",n.GAMES[this.game.id].load.fileComplete),this.game.cache.addSound(i.key,i.url,i.data,!1,!0));break;case"text":i.data=this._xhr.responseText,this.game.cache.addText(i.key,i.url,i.data)}u&&this.nextFile(t,!0)},jsonLoadComplete:function(n){var i=JSON.parse(this._xhr.responseText),t=this._fileList[n];t.type=="tilemap"?this.game.cache.addTilemap(t.key,t.url,i,t.format):this.game.cache.addTextureAtlas(t.key,t.url,t.data,i,t.format),this.nextFile(n,!0)},csvLoadComplete:function(n){var i=this._xhr.responseText,t=this._fileList[n];this.game.cache.addTilemap(t.key,t.url,i,t.format),this.nextFile(n,!0)},dataLoadError:function(n){var t=this._fileList[n];t.error=!0,console.warn("Phaser.Loader dataLoadError: "+n),this.nextFile(n,!0)},xmlLoadComplete:function(n){var r=this._xhr.responseText,t,u,i;try{window.DOMParser?(u=new DOMParser,t=u.parseFromString(r,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(r))}catch(f){t=undefined}if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)throw new Error("Phaser.Loader. Invalid XML given");i=this._fileList[n],i.type=="bitmapfont"?this.game.cache.addBitmapFont(i.key,i.url,i.data,t):i.type=="textureatlas"&&this.game.cache.addTextureAtlas(i.key,i.url,i.data,t,i.format),this.nextFile(n,!0)},nextFile:function(n,t){this.progress=Math.round(this.progress+this._progressChunk),this.progress>100&&(this.progress=100),this.preloadSprite!==null&&(this.preloadSprite.direction==0?this.preloadSprite.crop.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.crop.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite.crop=this.preloadSprite.crop),this.onFileComplete.dispatch(this.progress,n,t,this.queueSize-this._keys.length,this.queueSize),this._keys.length>0?this.loadFile():(this.hasLoaded=!0,this.isLoading=!1,this.removeAll(),this.onLoadComplete.dispatch())}},n.LoaderParser={bitmapFont:function(n,i,r){var f,u,s,h,o;if(!i.getElementsByTagName("font")){console.warn("Phaser.LoaderParser.bitmapFont: Invalid XML given, missing <font> tag");return}var c=t.TextureCache[r],e={},l=i.getElementsByTagName("info")[0],a=i.getElementsByTagName("common")[0];for(e.font=l.attributes.getNamedItem("face").nodeValue,e.size=parseInt(l.attributes.getNamedItem("size").nodeValue,10),e.lineHeight=parseInt(a.attributes.getNamedItem("lineHeight").nodeValue,10),e.chars={},f=i.getElementsByTagName("char"),u=0;u<f.length;u++)s=parseInt(f[u].attributes.getNamedItem("id").nodeValue,10),h={x:parseInt(f[u].attributes.getNamedItem("x").nodeValue,10),y:parseInt(f[u].attributes.getNamedItem("y").nodeValue,10),width:parseInt(f[u].attributes.getNamedItem("width").nodeValue,10),height:parseInt(f[u].attributes.getNamedItem("height").nodeValue,10)},t.TextureCache[s]=new t.Texture(c,h),e.chars[s]={xOffset:parseInt(f[u].attributes.getNamedItem("xoffset").nodeValue,10),yOffset:parseInt(f[u].attributes.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(f[u].attributes.getNamedItem("xadvance").nodeValue,10),kerning:{},texture:new t.Texture(c,h)};for(o=i.getElementsByTagName("kerning"),u=0;u<o.length;u++){var v=parseInt(o[u].attributes.getNamedItem("first").nodeValue,10),y=parseInt(o[u].attributes.getNamedItem("second").nodeValue,10),p=parseInt(o[u].attributes.getNamedItem("amount").nodeValue,10);e.chars[y].kerning[v]=p}t.BitmapText.fonts[e.font]=e}},n.Sound=function(t,i,r,u){r=r||1,typeof u=="undefined"&&(u=!1),this.game=t,this.name=i,this.key=i,this.loop=u,this._volume=r,this.markers={},this.context=null,this._buffer=null,this._muted=!1,this.autoplay=!1,this.totalDuration=0,this.startTime=0,this.currentTime=0,this.duration=0,this.stopTime=0,this.paused=!1,this.pausedPosition=0,this.pausedTime=0,this.isPlaying=!1,this.currentMarker="",this.pendingPlayback=!1,this.override=!1,this.usingWebAudio=this.game.sound.usingWebAudio,this.usingAudioTag=this.game.sound.usingAudioTag,this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,this.gainNode=typeof this.context.createGain=="undefined"?this.context.createGainNode():this.context.createGain(),this.gainNode.gain.value=r*this.game.sound.volume,this.gainNode.connect(this.masterGainNode)):this.game.cache.getSound(i)&&this.game.cache.isSoundReady(i)?(this._sound=this.game.cache.getSoundData(i),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this),this.onDecoded=new n.Signal,this.onPlay=new n.Signal,this.onPause=new n.Signal,this.onResume=new n.Signal,this.onLoop=new n.Signal,this.onStop=new n.Signal,this.onMute=new n.Signal,this.onMarkerComplete=new n.Signal},n.Sound.prototype={soundHasUnlocked:function(n){n==this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(n,t,i,r,u){r=r||1,typeof u=="undefined"&&(u=!1),this.markers[n]={name:n,start:t,stop:t+i,volume:r,duration:i,durationMS:i*1e3,loop:u}},removeMarker:function(n){delete this.markers[n]},update:function(){this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.now-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),this.currentMarker==""?(this.currentTime=0,this.startTime=this.game.time.now):this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop():this.loop?(this.onLoop.dispatch(this),this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))},play:function(n,t,i,r,u){if(n=n||"",t=t||0,i=i||1,typeof r=="undefined"&&(r=!1),typeof u=="undefined"&&(u=!0),this.isPlaying!=!0||u!=!1||this.override!=!1){if(this.isPlaying&&this.override&&(this.usingWebAudio?typeof this._sound.stop=="undefined"?this._sound.noteOff(0):this._sound.stop(0):this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0)),this.currentMarker=n,n!=="")if(this.markers[n])this.position=this.markers[n].start,this.volume=this.markers[n].volume,this.loop=this.markers[n].loop,this.duration=this.markers[n].duration,this.durationMS=this.markers[n].durationMS,this._tempMarker=n,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop;else{console.warn("Phaser.Sound.play: audio marker "+n+" doesn't exist");return}else this.position=t,this.volume=i,this.loop=r,this.duration=0,this.durationMS=0,this._tempMarker=n,this._tempPosition=t,this._tempVolume=i,this._tempLoop=r;this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._buffer==null&&(this._buffer=this.game.cache.getSoundData(this.key)),this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this._sound.connect(this.gainNode),this.totalDuration=this._sound.buffer.duration,this.duration==0&&(this.duration=this.totalDuration,this.durationMS=this.totalDuration*1e3),this.loop&&n==""&&(this._sound.loop=!0),typeof this._sound.start=="undefined"?this._sound.noteGrainOn(0,this.position,this.duration):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.now,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).isDecoding==!1&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&this._sound.readyState==4?(this._sound.play(),this.totalDuration=this._sound.duration,this.duration==0&&(this.duration=this.totalDuration,this.durationMS=this.totalDuration*1e3),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._sound.volume=this._muted?0:this._volume,this.isPlaying=!0,this.startTime=this.game.time.now,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0}},restart:function(n,t,i,r){n=n||"",t=t||0,i=i||1,typeof r=="undefined"&&(r=!1),this.play(n,t,i,r,!0)},pause:function(){this.isPlaying&&this._sound&&(this.stop(),this.isPlaying=!1,this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.now,this.onPause.dispatch(this))},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var n=this.position+this.pausedPosition/1e3;this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this._sound.connect(this.gainNode),typeof this._sound.start=="undefined"?this._sound.noteGrainOn(0,n,this.duration):this._sound.start(0,n,this.duration)}else this._sound.play();this.isPlaying=!0,this.paused=!1,this.startTime+=this.game.time.now-this.pausedTime,this.onResume.dispatch(this)}},stop:function(){this.isPlaying&&this._sound&&(this.usingWebAudio?typeof this._sound.stop=="undefined"?this._sound.noteOff(0):this._sound.stop(0):this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0)),this.isPlaying=!1;var n=this.currentMarker;this.currentMarker="",this.onStop.dispatch(this,n)}},Object.defineProperty(n.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}}),Object.defineProperty(n.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}}),Object.defineProperty(n.Sound.prototype,"mute",{get:function(){return this._muted},set:function(n){n=n||null,n?(this._muted=!0,this.usingWebAudio?(this._muteVolume=this.gainNode.gain.value,this.gainNode.gain.value=0):this.usingAudioTag&&this._sound&&(this._muteVolume=this._sound.volume,this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this)}}),Object.defineProperty(n.Sound.prototype,"volume",{get:function(){return this._volume},set:function(n){this.usingWebAudio?(this._volume=n,this.gainNode.gain.value=n):this.usingAudioTag&&this._sound&&n>=0&&n<=1&&(this._volume=n,this._sound.volume=n)}}),n.SoundManager=function(t){this.game=t,this.onSoundDecode=new n.Signal,this._muted=!1,this._unlockSource=null,this._volume=1,this._sounds=[],this.context=null,this.usingWebAudio=!0,this.usingAudioTag=!1,this.noAudio=!1,this.touchLocked=!1,this.channels=32},n.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&this.game.device.webAudio==!1&&(this.channels=1),this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?(this.game.input.touch.callbackContext=this,this.game.input.touch.touchStartCallback=this.unlock,this.game.input.mouse.callbackContext=this,this.game.input.mouse.mouseDownCallback=this.unlock,this.touchLocked=!0):this.touchLocked=!1,window.PhaserGlobal){if(window.PhaserGlobal.disableAudio==!0){this.usingWebAudio=!1,this.noAudio=!0;return}if(window.PhaserGlobal.disableWebAudio==!0){this.usingWebAudio=!1,this.usingAudioTag=!0,this.noAudio=!1;return}}window.AudioContext?this.context=new window.AudioContext:window.webkitAudioContext?this.context=new window.webkitAudioContext:window.Audio?(this.usingWebAudio=!1,this.usingAudioTag=!0):(this.usingWebAudio=!1,this.noAudio=!0),this.context!==null&&(this.masterGain=typeof this.context.createGain=="undefined"?this.context.createGainNode():this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination))},unlock:function(){if(this.touchLocked!=!1)if(this.game.device.webAudio==!1||window.PhaserGlobal&&window.PhaserGlobal.disableWebAudio==!0)this.touchLocked=!1,this._unlockSource=null,this.game.input.touch.callbackContext=null,this.game.input.touch.touchStartCallback=null,this.game.input.mouse.callbackContext=null,this.game.input.mouse.mouseDownCallback=null;else{var n=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=n,this._unlockSource.connect(this.context.destination),this._unlockSource.noteOn(0)}},stopAll:function(){for(var n=0;n<this._sounds.length;n++)this._sounds[n]&&this._sounds[n].stop()},pauseAll:function(){for(var n=0;n<this._sounds.length;n++)this._sounds[n]&&this._sounds[n].pause()},resumeAll:function(){for(var n=0;n<this._sounds.length;n++)this._sounds[n]&&this._sounds[n].resume()},decode:function(n,t){var i,r;t=t||null,i=this.game.cache.getSoundData(n),i&&this.game.cache.isSoundDecoded(n)===!1&&(this.game.cache.updateSound(n,"isDecoding",!0),r=this,this.context.decodeAudioData(i,function(i){r.game.cache.decodedSound(n,i),t&&r.onSoundDecode.dispatch(t)}))},update:function(){this.touchLocked&&this.game.device.webAudio&&this._unlockSource!==null&&(this._unlockSource.playbackState===this._unlockSource.PLAYING_STATE||this._unlockSource.playbackState===this._unlockSource.FINISHED_STATE)&&(this.touchLocked=!1,this._unlockSource=null,this.game.input.touch.callbackContext=null,this.game.input.touch.touchStartCallback=null);for(var n=0;n<this._sounds.length;n++)this._sounds[n].update()},add:function(t,i,r){i=i||1,typeof r=="undefined"&&(r=!1);var u=new n.Sound(this.game,t,i,r);return this._sounds.push(u),u}},Object.defineProperty(n.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(n){var t;if(n=n||null,n){if(this._muted)return;for(this._muted=!0,this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0),t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!0)}else{if(this._muted==!1)return;for(this._muted=!1,this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume),t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].mute=!1)}}}),Object.defineProperty(n.SoundManager.prototype,"volume",{get:function(){return this.usingWebAudio?this.masterGain.gain.value:this._volume},set:function(n){n=this.game.math.clamp(n,1,0),this._volume=n,this.usingWebAudio&&(this.masterGain.gain.value=n);for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&(this._sounds[t].volume=this._sounds[t].volume*n)}}),n.Utils.Debug=function(n){this.game=n,this.context=n.context,this.font="14px Courier",this.lineHeight=16,this.renderShadow=!0,this.currentX=0,this.currentY=0,this.currentAlpha=1},n.Utils.Debug.prototype={start:function(n,t,i){this.context!=null&&(typeof n!="number"&&(n=0),typeof t!="number"&&(t=0),i=i||"rgb(255,255,255)",this.currentX=n,this.currentY=t,this.currentColor=i,this.currentAlpha=this.context.globalAlpha,this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.fillStyle=i,this.context.font=this.font,this.context.globalAlpha=1)},stop:function(){this.context.restore(),this.context.globalAlpha=this.currentAlpha},line:function(n,t,i){this.context!=null&&(t=t||null,i=i||null,t!==null&&(this.currentX=t),i!==null&&(this.currentY=i),this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(n,this.currentX+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(n,this.currentX,this.currentY),this.currentY+=this.lineHeight)},renderQuadTree:function(n,t){var r,i;if(t=t||"rgba(255,0,0,0.3)",this.start(),r=n.bounds,n.nodes.length===0)for(this.context.strokeStyle=t,this.context.strokeRect(r.x,r.y,r.width,r.height),this.renderText(n.ID+" / "+n.objects.length,r.x+4,r.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)",i=0;i<n.objects.length;i++)this.context.strokeRect(n.objects[i].x,n.objects[i].y,n.objects[i].width,n.objects[i].height);else for(i=0;i<n.nodes.length;i++)this.renderQuadTree(n.nodes[i]);this.stop()},renderSpriteCorners:function(n,t,i,r){this.context!=null&&(t=t||!1,i=i||!1,r=r||"rgb(255,255,255)",this.start(0,0,r),i&&(this.context.beginPath(),this.context.strokeStyle="rgba(0, 255, 0, 0.7)",this.context.strokeRect(n.bounds.x,n.bounds.y,n.bounds.width,n.bounds.height),this.context.closePath(),this.context.stroke()),this.context.beginPath(),this.context.moveTo(n.topLeft.x,n.topLeft.y),this.context.lineTo(n.topRight.x,n.topRight.y),this.context.lineTo(n.bottomRight.x,n.bottomRight.y),this.context.lineTo(n.bottomLeft.x,n.bottomLeft.y),this.context.closePath(),this.context.strokeStyle="rgba(255, 0, 255, 0.7)",this.context.stroke(),this.renderPoint(n.offset),this.renderPoint(n.center),this.renderPoint(n.topLeft),this.renderPoint(n.topRight),this.renderPoint(n.bottomLeft),this.renderPoint(n.bottomRight),t&&(this.currentColor=r,this.line("x: "+Math.floor(n.topLeft.x)+" y: "+Math.floor(n.topLeft.y),n.topLeft.x,n.topLeft.y),this.line("x: "+Math.floor(n.topRight.x)+" y: "+Math.floor(n.topRight.y),n.topRight.x,n.topRight.y),this.line("x: "+Math.floor(n.bottomLeft.x)+" y: "+Math.floor(n.bottomLeft.y),n.bottomLeft.x,n.bottomLeft.y),this.line("x: "+Math.floor(n.bottomRight.x)+" y: "+Math.floor(n.bottomRight.y),n.bottomRight.x,n.bottomRight.y)),this.stop())},renderSoundInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255,255,255)",this.start(t,i,r),this.line("Sound: "+n.key+" Locked: "+n.game.sound.touchLocked),this.line("Is Ready?: "+this.game.cache.isSoundReady(n.key)+" Pending Playback: "+n.pendingPlayback),this.line("Decoded: "+n.isDecoded+" Decoding: "+n.isDecoding),this.line("Total Duration: "+n.totalDuration+" Playing: "+n.isPlaying),this.line("Time: "+n.currentTime),this.line("Volume: "+n.volume+" Muted: "+n.mute),this.line("WebAudio: "+n.usingWebAudio+" Audio: "+n.usingAudioTag),n.currentMarker!==""&&(this.line("Marker: "+n.currentMarker+" Duration: "+n.duration),this.line("Start: "+n.markers[n.currentMarker].start+" Stop: "+n.markers[n.currentMarker].stop),this.line("Position: "+n.position)),this.stop())},renderCameraInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255,255,255)",this.start(t,i,r),this.line("Camera ("+n.width+" x "+n.height+")"),this.line("X: "+n.x+" Y: "+n.y),this.line("Bounds x: "+n.bounds.x+" Y: "+n.bounds.y+" w: "+n.bounds.width+" h: "+n.bounds.height),this.line("View x: "+n.view.x+" Y: "+n.view.y+" w: "+n.view.width+" h: "+n.view.height),this.stop())},renderPointer:function(n,t,i,r,u){this.context!=null&&n!=null&&(typeof t=="undefined"&&(t=!1),i=i||"rgba(0,255,0,0.5)",r=r||"rgba(255,0,0,0.5)",u=u||"rgb(255,255,255)",t!=!0||n.isUp!=!0)&&(this.start(n.x,n.y-100,u),this.context.beginPath(),this.context.arc(n.x,n.y,n.circle.radius,0,Math.PI*2),this.context.fillStyle=n.active?i:r,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(n.positionDown.x,n.positionDown.y),this.context.lineTo(n.position.x,n.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+n.id+" Active: "+n.active),this.line("World X: "+n.worldX+" World Y: "+n.worldY),this.line("Screen X: "+n.x+" Screen Y: "+n.y),this.line("Duration: "+n.duration+" ms"),this.stop())},renderSpriteInputInfo:function(n,t,i,r){r=r||"rgb(255,255,255)",this.start(t,i,r),this.line("Sprite Input: ("+n.width+" x "+n.height+")"),this.line("x: "+n.input.pointerX().toFixed(1)+" y: "+n.input.pointerY().toFixed(1)),this.line("over: "+n.input.pointerOver()+" duration: "+n.input.overDuration().toFixed(0)),this.line("down: "+n.input.pointerDown()+" duration: "+n.input.downDuration().toFixed(0)),this.line("just over: "+n.input.justOver()+" just out: "+n.input.justOut()),this.stop()},renderSpriteCollision:function(n,t,i,r){r=r||"rgb(255,255,255)",this.start(t,i,r),this.line("Sprite Collision: ("+n.width+" x "+n.height+")"),this.line("left: "+n.body.touching.left),this.line("right: "+n.body.touching.right),this.line("up: "+n.body.touching.up),this.line("down: "+n.body.touching.down),this.line("velocity.x: "+n.body.velocity.x),this.line("velocity.y: "+n.body.velocity.y),this.stop()},renderInputInfo:function(n,t,i){this.context!=null&&(i=i||"rgb(255,255,0)",this.start(n,t,i),this.line("Input"),this.line("X: "+this.game.input.x+" Y: "+this.game.input.y),this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY),this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1)),this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY),this.stop())},renderSpriteInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255, 255, 255)",this.start(t,i,r),this.line("Sprite:  ("+n.width+" x "+n.height+") anchor: "+n.anchor.x+" x "+n.anchor.y),this.line("x: "+n.x.toFixed(1)+" y: "+n.y.toFixed(1)),this.line("angle: "+n.angle.toFixed(1)+" rotation: "+n.rotation.toFixed(1)),this.line("visible: "+n.visible+" in camera: "+n.inCamera),this.line("body x: "+n.body.x.toFixed(1)+" y: "+n.body.y.toFixed(1)),this.line("deltaX: "+n.body.deltaX()),this.line("deltaY: "+n.body.deltaY()),this.stop())},renderWorldTransformInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255, 255, 255)",this.start(t,i,r),this.line("World Transform"),this.line("skewX:  "+n.worldTransform[3]),this.line("skewY:  "+n.worldTransform[1]),this.line("scaleX: "+n.worldTransform[0]),this.line("scaleY: "+n.worldTransform[4]),this.line("transX: "+n.worldTransform[2]),this.line("transY: "+n.worldTransform[5]),this.stop())},renderLocalTransformInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255, 255, 255)",this.start(t,i,r),this.line("Local Transform"),this.line("skewX:  "+n.localTransform[3]),this.line("skewY:  "+n.localTransform[1]),this.line("scaleX: "+n.localTransform[0]),this.line("scaleY: "+n.localTransform[4]),this.line("transX: "+n.localTransform[2]),this.line("transY: "+n.localTransform[5]),this.stop())},renderSpriteCoords:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255, 255, 255)",this.start(t,i,r),n.name&&this.line(n.name),this.line("x: "+n.x),this.line("y: "+n.y),this.line("pos x: "+n.position.x),this.line("pos y: "+n.position.y),this.line("local x: "+n.localTransform[2]),this.line("local y: "+n.localTransform[5]),this.line("t x: "+n.worldTransform[2]),this.line("t y: "+n.worldTransform[5]),this.line("world x: "+n.world.x),this.line("world y: "+n.world.y),this.stop())},renderGroupInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255, 255, 255)",this.start(t,i,r),this.line("Group (size: "+n.length+")"),this.line("x: "+n.x),this.line("y: "+n.y),this.stop())},renderPointInfo:function(n,t,i,r){this.context!=null&&(r=r||"rgb(255, 255, 255)",this.start(t,i,r),this.line("px: "+n.x.toFixed(1)+" py: "+n.y.toFixed(1)),this.stop())},renderSpriteBody:function(n,t){this.context!=null&&(t=t||"rgba(255,0,255, 0.3)",this.start(0,0,t),this.context.fillStyle=t,this.context.fillRect(n.body.screenX,n.body.screenY,n.body.width,n.body.height),this.stop())},renderSpriteBounds:function(n,t,i){this.context!=null&&(t=t||"rgb(255,0,255)",typeof i=="undefined"&&(i=!1),this.start(0,0,t),i?(this.context.fillStyle=t,this.context.fillRect(n.bounds.x,n.bounds.y,n.bounds.width,n.bounds.height)):(this.context.strokeStyle=t,this.context.strokeRect(n.bounds.x,n.bounds.y,n.bounds.width,n.bounds.height),this.context.stroke()),this.stop())},renderPixel:function(n,t,i){this.context!=null&&(i=i||"rgba(0,255,0,1)",this.start(),this.context.fillStyle=i,this.context.fillRect(n,t,2,2),this.stop())},renderPoint:function(n,t){this.context!=null&&(t=t||"rgba(0,255,0,1)",this.start(),this.context.fillStyle=t,this.context.fillRect(n.x,n.y,4,4),this.stop())},renderRectangle:function(n,t){this.context!=null&&(t=t||"rgba(0,255,0,0.3)",this.start(),this.context.fillStyle=t,this.context.fillRect(n.x,n.y,n.width,n.height),this.stop())},renderCircle:function(n,t){this.context!=null&&(t=t||"rgba(0,255,0,0.3)",this.start(),this.context.beginPath(),this.context.fillStyle=t,this.context.arc(n.x,n.y,n.radius,0,Math.PI*2,!1),this.context.fill(),this.context.closePath(),this.stop())},renderText:function(n,t,i,r,u){this.context!=null&&(r=r||"rgb(255,255,255)",u=u||"16px Courier",this.start(),this.context.font=u,this.context.fillStyle=r,this.context.fillText(n,t,i),this.stop())},dumpLinkedList:function(t){var r=20,u="\n"+n.Utils.pad("Node",r)+"|"+n.Utils.pad("Next",r)+"|"+n.Utils.pad("Previous",r)+"|"+n.Utils.pad("First",r)+"|"+n.Utils.pad("Last",r),i,h;console.log(u),u=n.Utils.pad("----------",r)+"|"+n.Utils.pad("----------",r)+"|"+n.Utils.pad("----------",r)+"|"+n.Utils.pad("----------",r)+"|"+n.Utils.pad("----------",r),console.log(u),i=t,h=i.last.next,i=i.first;do{var c=i.sprite.name||"*",f="-",e="-",o="-",s="-";i.next&&(f=i.next.sprite.name),i.prev&&(e=i.prev.sprite.name),i.first&&(o=i.first.sprite.name),i.last&&(s=i.last.sprite.name),typeof f=="undefined"&&(f="-"),typeof e=="undefined"&&(e="-"),typeof o=="undefined"&&(o="-"),typeof s=="undefined"&&(s="-"),u=n.Utils.pad(c,r)+"|"+n.Utils.pad(f,r)+"|"+n.Utils.pad(e,r)+"|"+n.Utils.pad(o,r)+"|"+n.Utils.pad(s,r),console.log(u),i=i.next}while(i!=h)}},n.Color={getColor32:function(n,t,i,r){return n<<24|t<<16|i<<8|r},getColor:function(n,t,i){return n<<16|t<<8|i},hexToRGB:function(n){var t=n.charAt(0)=="#"?n.substring(1,7):n;t.length==3&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2));var i=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),u=parseInt(t.substring(4,6),16);return i<<16|r<<8|u},getColorInfo:function(t){var i=n.Color.getRGB(t),r=n.Color.RGBtoHSV(t),u=n.Color.RGBtoHexstring(t)+"\n";return u=u.concat("Alpha: "+i.alpha+" Red: "+i.red+" Green: "+i.green+" Blue: "+i.blue)+"\n",u.concat("Hue: "+r.hue+" Saturation: "+r.saturation+" Lightnes: "+r.lightness)},RGBtoHexstring:function(t){var i=n.Color.getRGB(t);return"0x"+n.Color.colorToHexstring(i.alpha)+n.Color.colorToHexstring(i.red)+n.Color.colorToHexstring(i.green)+n.Color.colorToHexstring(i.blue)},RGBtoWebstring:function(t){var i=n.Color.getRGB(t);return"#"+n.Color.colorToHexstring(i.red)+n.Color.colorToHexstring(i.green)+n.Color.colorToHexstring(i.blue)},colorToHexstring:function(n){var t="0123456789ABCDEF",i=n%16,r=(n-i)/16;return t.charAt(r)+t.charAt(i)},interpolateColor:function(t,i,r,u,f){typeof f=="undefined"&&(f=255);var e=n.Color.getRGB(t),o=n.Color.getRGB(i),s=(o.red-e.red)*u/r+e.red,h=(o.green-e.green)*u/r+e.green,c=(o.blue-e.blue)*u/r+e.blue;return n.Color.getColor32(f,s,h,c)},interpolateColorWithRGB:function(t,i,r,u,f,e){var o=n.Color.getRGB(t),s=(i-o.red)*e/f+o.red,h=(r-o.green)*e/f+o.green,c=(u-o.blue)*e/f+o.blue;return n.Color.getColor(s,h,c)},interpolateRGB:function(t,i,r,u,f,e,o,s){var h=(u-t)*s/o+t,c=(f-i)*s/o+i,l=(e-r)*s/o+r;return n.Color.getColor(h,c,l)},getRandomColor:function(t,i,r){if((typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=255),typeof r=="undefined"&&(r=255),i>255)||t>i)return n.Color.getColor(255,255,255);var u=t+Math.round(Math.random()*(i-t)),f=t+Math.round(Math.random()*(i-t)),e=t+Math.round(Math.random()*(i-t));return n.Color.getColor32(r,u,f,e)},getRGB:function(n){return{alpha:n>>>24,red:n>>16&255,green:n>>8&255,blue:n&255}},getWebRGB:function(n){var t=(n>>>24)/255,i=n>>16&255,r=n>>8&255,u=n&255;return"rgba("+i.toString()+","+r.toString()+","+u.toString()+","+t.toString()+")"},getAlpha:function(n){return n>>>24},getAlphaFloat:function(n){return(n>>>24)/255},getRed:function(n){return n>>16&255},getGreen:function(n){return n>>8&255},getBlue:function(n){return n&255}},n.Physics={},n.Physics.Arcade=function(t){this.game=t,this.gravity=new n.Point,this.bounds=new n.Rectangle(0,0,t.world.width,t.world.height),this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=4,this.quadTree=new n.QuadTree(this,this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTreeID=0,this._bounds1=new n.Rectangle,this._bounds2=new n.Rectangle,this._overlap=0,this._maxOverlap=0,this._velocity1=0,this._velocity2=0,this._newVelocity1=0,this._newVelocity2=0,this._average=0,this._mapData=[],this._mapTiles=0,this._result=!1,this._total=0,this._angle=0,this._dx=0,this._dy=0},n.Physics.Arcade.prototype={updateMotion:function(n){this._velocityDelta=(this.computeVelocity(0,n,n.angularVelocity,n.angularAcceleration,n.angularDrag,n.maxAngular)-n.angularVelocity)/2,n.angularVelocity+=this._velocityDelta,n.rotation+=n.angularVelocity*this.game.time.physicsElapsed,n.angularVelocity+=this._velocityDelta,this._velocityDelta=(this.computeVelocity(1,n,n.velocity.x,n.acceleration.x,n.drag.x,n.maxVelocity.x)-n.velocity.x)/2,n.velocity.x+=this._velocityDelta,n.x+=n.velocity.x*this.game.time.physicsElapsed,n.velocity.x+=this._velocityDelta,this._velocityDelta=(this.computeVelocity(2,n,n.velocity.y,n.acceleration.y,n.drag.y,n.maxVelocity.y)-n.velocity.y)/2,n.velocity.y+=this._velocityDelta,n.y+=n.velocity.y*this.game.time.physicsElapsed,n.velocity.y+=this._velocityDelta},computeVelocity:function(n,t,i,r,u,f){return f=f||1e4,n==1&&t.allowGravity?i+=this.gravity.x+t.gravity.x:n==2&&t.allowGravity&&(i+=this.gravity.y+t.gravity.y),r!==0?i+=r*this.game.time.physicsElapsed:u!==0&&(this._drag=u*this.game.time.physicsElapsed,i-this._drag>0?i-=this._drag:i+this._drag<0?i+=this._drag:i=0),i>f?i=f:i<-f&&(i=-f),i},preUpdate:function(){this.quadTree.clear(),this.quadTreeID=0,this.quadTree=new n.QuadTree(this,this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels)},postUpdate:function(){this.quadTree.clear()},overlap:function(t,i){return t&&i&&t.exists&&i.exists?n.Rectangle.intersects(t.body,i.body):!1},collide:function(t,i,r,u,f){return r=r||null,u=u||null,f=f||r,this._result=!1,this._total=0,t&&i&&t.exists&&i.exists&&(t.type==n.SPRITE?i.type==n.SPRITE?this.collideSpriteVsSprite(t,i,r,u,f):i.type==n.GROUP||i.type==n.EMITTER?this.collideSpriteVsGroup(t,i,r,u,f):i.type==n.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(t,i,r,u,f):t.type==n.GROUP?i.type==n.SPRITE?this.collideSpriteVsGroup(i,t,r,u,f):i.type==n.GROUP||i.type==n.EMITTER?this.collideGroupVsGroup(t,i,r,u,f):i.type==n.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(t,i,r,u,f):t.type==n.TILEMAPLAYER?i.type==n.SPRITE?this.collideSpriteVsTilemapLayer(i,t,r,u,f):(i.type==n.GROUP||i.type==n.EMITTER)&&this.collideGroupVsTilemapLayer(i,t,r,u,f):t.type==n.EMITTER&&(i.type==n.SPRITE?this.collideSpriteVsGroup(i,t,r,u,f):i.type==n.GROUP||i.type==n.EMITTER?this.collideGroupVsGroup(t,i,r,u,f):i.type==n.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(t,i,r,u,f))),this._total>0},collideSpriteVsTilemapLayer:function(n,t,i,r,u){if(this._mapData=t.getTiles(n.body.x,n.body.y,n.body.width,n.body.height,!0),this._mapData.length!=0)for(var f=0;f<this._mapData.length;f++)this.separateTile(n.body,this._mapData[f])&&(r?r.call(u,n,this._mapData[f])&&(this._total++,i&&i.call(u,n,this._mapData[f])):(this._total++,i&&i.call(u,n,this._mapData[f])))},collideGroupVsTilemapLayer:function(n,t,i,r,u){if(n.length!=0&&n.length!=0&&n._container.first._iNext){var f=n._container.first._iNext;do f.exists&&this.collideSpriteVsTilemapLayer(f,t,i,r,u),f=f._iNext;while(f!=n._container.last._iNext)}},collideSpriteVsSprite:function(n,t,i,r,u){this.separate(n.body,t.body),this._result&&(r?r.call(u,n,t)&&(this._total++,i&&i.call(u,n,t)):(this._total++,i&&i.call(u,n,t)))},collideSpriteVsGroup:function(n,t,i,r,u){if(t.length!=0){this._potentials=this.quadTree.retrieve(n);for(var f=0,e=this._potentials.length;f<e;f++)this._potentials[f].sprite.group==t&&(this.separate(n.body,this._potentials[f]),this._result&&r&&(this._result=r.call(u,n,this._potentials[f].sprite)),this._result&&(this._total++,i&&i.call(u,n,this._potentials[f].sprite)))}},collideGroupVsGroup:function(n,t,i,r,u){if(n.length!=0&&t.length!=0&&n._container.first._iNext){var f=n._container.first._iNext;do f.exists&&this.collideSpriteVsGroup(f,t,i,r,u),f=f._iNext;while(f!=n._container.last._iNext)}},separate:function(n,t){this._result=this.separateX(n,t)||this.separateY(n,t)},separateX:function(t,i){return t.immovable&&i.immovable?!1:(this._overlap=0,n.Rectangle.intersects(t,i)&&(this._maxOverlap=t.deltaAbsX()+i.deltaAbsX()+this.OVERLAP_BIAS,t.deltaX()==0&&i.deltaX()==0?(t.embedded=!0,i.embedded=!0):t.deltaX()>i.deltaX()?(this._overlap=t.x+t.width-i.x,this._overlap>this._maxOverlap||t.allowCollision.right==!1||i.allowCollision.left==!1?this._overlap=0:(t.touching.right=!0,i.touching.left=!0)):t.deltaX()<i.deltaX()&&(this._overlap=t.x-i.width-i.x,-this._overlap>this._maxOverlap||t.allowCollision.left==!1||i.allowCollision.right==!1?this._overlap=0:(t.touching.left=!0,i.touching.right=!0)),this._overlap!=0))?(t.overlapX=this._overlap,i.overlapX=this._overlap,t.customSeparateX||i.customSeparateX)?!0:(this._velocity1=t.velocity.x,this._velocity2=i.velocity.x,t.immovable||i.immovable?t.immovable?i.immovable||(i.x+=this._overlap,i.velocity.x=this._velocity1-this._velocity2*i.bounce.x):(t.x=t.x-this._overlap,t.velocity.x=this._velocity2-this._velocity1*t.bounce.x):(this._overlap*=.5,t.x=t.x-this._overlap,i.x+=this._overlap,this._newVelocity1=Math.sqrt(this._velocity2*this._velocity2*i.mass/t.mass)*(this._velocity2>0?1:-1),this._newVelocity2=Math.sqrt(this._velocity1*this._velocity1*t.mass/i.mass)*(this._velocity1>0?1:-1),this._average=(this._newVelocity1+this._newVelocity2)*.5,this._newVelocity1-=this._average,this._newVelocity2-=this._average,t.velocity.x=this._average+this._newVelocity1*t.bounce.x,i.velocity.x=this._average+this._newVelocity2*i.bounce.x),!0):!1},separateY:function(t,i){return t.immovable&&i.immovable?!1:(this._overlap=0,n.Rectangle.intersects(t,i)&&(this._maxOverlap=t.deltaAbsY()+i.deltaAbsY()+this.OVERLAP_BIAS,t.deltaY()==0&&i.deltaY()==0?(t.embedded=!0,i.embedded=!0):t.deltaY()>i.deltaY()?(this._overlap=t.y+t.height-i.y,this._overlap>this._maxOverlap||t.allowCollision.down==!1||i.allowCollision.up==!1?this._overlap=0:(t.touching.down=!0,i.touching.up=!0)):t.deltaY()<i.deltaY()&&(this._overlap=t.y-i.height-i.y,-this._overlap>this._maxOverlap||t.allowCollision.up==!1||i.allowCollision.down==!1?this._overlap=0:(t.touching.up=!0,i.touching.down=!0)),this._overlap!=0))?(t.overlapY=this._overlap,i.overlapY=this._overlap,t.customSeparateY||i.customSeparateY)?!0:(this._velocity1=t.velocity.y,this._velocity2=i.velocity.y,t.immovable||i.immovable?t.immovable?i.immovable||(i.y+=this._overlap,i.velocity.y=this._velocity1-this._velocity2*i.bounce.y,t.sprite.active&&t.moves&&t.deltaY()<i.deltaY()&&(i.x+=t.x-t.lastX)):(t.y=t.y-this._overlap,t.velocity.y=this._velocity2-this._velocity1*t.bounce.y,i.active&&i.moves&&t.deltaY()>i.deltaY()&&(t.x+=i.x-i.lastX)):(this._overlap*=.5,t.y=t.y-this._overlap,i.y+=this._overlap,this._newVelocity1=Math.sqrt(this._velocity2*this._velocity2*i.mass/t.mass)*(this._velocity2>0?1:-1),this._newVelocity2=Math.sqrt(this._velocity1*this._velocity1*t.mass/i.mass)*(this._velocity1>0?1:-1),this._average=(this._newVelocity1+this._newVelocity2)*.5,this._newVelocity1-=this._average,this._newVelocity2-=this._average,t.velocity.y=this._average+this._newVelocity1*t.bounce.y,i.velocity.y=this._average+this._newVelocity2*i.bounce.y),!0):!1},separateTile:function(n,t){this._result=this.separateTileX(n,t,!0)||this.separateTileY(n,t,!0)},separateTileX:function(t,i,r){return t.immovable||t.deltaX()==0||n.Rectangle.intersects(t.hullX,i)==!1?!1:(this._overlap=0,t.deltaX()<0?(this._overlap=i.right-t.hullX.x,t.allowCollision.left==!1||i.tile.collideRight==!1?this._overlap=0:t.touching.left=!0):(this._overlap=t.hullX.right-i.x,t.allowCollision.right==!1||i.tile.collideLeft==!1?this._overlap=0:t.touching.right=!0),this._overlap!=0?(r&&(t.x=t.deltaX()<0?t.x+this._overlap:t.x-this._overlap,t.velocity.x=t.bounce.x==0?0:-t.velocity.x*t.bounce.x,t.updateHulls()),!0):!1)},separateTileY:function(t,i,r){return t.immovable||t.deltaY()==0||n.Rectangle.intersects(t.hullY,i)==!1?!1:(this._overlap=0,t.deltaY()<0?(this._overlap=i.bottom-t.hullY.y,t.allowCollision.up==!1||i.tile.collideDown==!1?this._overlap=0:t.touching.up=!0):(this._overlap=t.hullY.bottom-i.y,t.allowCollision.down==!1||i.tile.collideUp==!1?this._overlap=0:t.touching.down=!0),this._overlap!=0?(r&&(t.y=t.deltaY()<0?t.y+this._overlap:t.y-this._overlap,t.velocity.y=t.bounce.y==0?0:-t.velocity.y*t.bounce.y,t.updateHulls()),!0):!1)},moveToObject:function(n,t,i,r){return typeof i=="undefined"&&(i=60),typeof r=="undefined"&&(r=0),this._angle=Math.atan2(t.y-n.y,t.x-n.x),r>0&&(i=this.distanceBetween(n,t)/(r/1e3)),n.body.velocity.x=Math.cos(this._angle)*i,n.body.velocity.y=Math.sin(this._angle)*i,this._angle},moveToPointer:function(n,t,i,r){return typeof t=="undefined"&&(t=60),i=i||this.game.input.activePointer,typeof r=="undefined"&&(r=0),this._angle=this.angleToPointer(n,i),r>0&&(t=this.distanceToPointer(n,i)/(r/1e3)),n.body.velocity.x=Math.cos(this._angle)*t,n.body.velocity.y=Math.sin(this._angle)*t,this._angle},moveToXY:function(n,t,i,r,u){return typeof r=="undefined"&&(r=60),typeof u=="undefined"&&(u=0),this._angle=Math.atan2(i-n.y,t-n.x),u>0&&(r=this.distanceToXY(n,t,i)/(u/1e3)),n.body.velocity.x=Math.cos(this._angle)*r,n.body.velocity.y=Math.sin(this._angle)*r,this._angle},velocityFromAngle:function(t,i,r){return typeof i=="undefined"&&(i=60),r=r||new n.Point,r.setTo(Math.cos(this.game.math.degToRad(t))*i,Math.sin(this.game.math.degToRad(t))*i)},velocityFromRotation:function(t,i,r){return typeof i=="undefined"&&(i=60),r=r||new n.Point,r.setTo(Math.cos(t)*i,Math.sin(t)*i)},accelerationFromRotation:function(t,i,r){return typeof i=="undefined"&&(i=60),r=r||new n.Point,r.setTo(Math.cos(t)*i,Math.sin(t)*i)},accelerateToObject:function(n,t,i,r,u){return typeof i=="undefined"&&(i=60),typeof r=="undefined"&&(r=1e3),typeof u=="undefined"&&(u=1e3),this._angle=this.angleBetween(n,t),n.body.acceleration.setTo(Math.cos(this._angle)*i,Math.sin(this._angle)*i),n.body.maxVelocity.setTo(r,u),this._angle},accelerateToPointer:function(n,t,i,r,u){return typeof i=="undefined"&&(i=60),typeof t=="undefined"&&(t=this.game.input.activePointer),typeof r=="undefined"&&(r=1e3),typeof u=="undefined"&&(u=1e3),this._angle=this.angleToPointer(n,t),n.body.acceleration.setTo(Math.cos(this._angle)*i,Math.sin(this._angle)*i),n.body.maxVelocity.setTo(r,u),this._angle},accelerateToXY:function(n,t,i,r,u,f){return typeof r=="undefined"&&(r=60),typeof u=="undefined"&&(u=1e3),typeof f=="undefined"&&(f=1e3),this._angle=this.angleToXY(n,t,i),n.body.acceleration.setTo(Math.cos(this._angle)*r,Math.sin(this._angle)*r),n.body.maxVelocity.setTo(u,f),this._angle},distanceBetween:function(n,t){return this._dx=n.x-t.x,this._dy=n.y-t.y,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},distanceToXY:function(n,t,i){return this._dx=n.x-t,this._dy=n.y-i,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},distanceToPointer:function(n,t){return t=t||this.game.input.activePointer,this._dx=n.x-t.x,this._dy=n.y-t.y,Math.sqrt(this._dx*this._dx+this._dy*this._dy)},angleBetween:function(n,t){return this._dx=t.x-n.x,this._dy=t.y-n.y,Math.atan2(this._dy,this._dx)},angleToXY:function(n,t,i){return this._dx=t-n.x,this._dy=i-n.y,Math.atan2(this._dy,this._dx)},angleToPointer:function(n,t){return t=t||this.game.input.activePointer,this._dx=t.worldX-n.x,this._dy=t.worldY-n.y,Math.atan2(this._dy,this._dx)}},n.Physics.Arcade.Body=function(t){this.sprite=t,this.game=t.game,this.offset=new n.Point,this.x=t.x,this.y=t.y,this.preX=t.x,this.preY=t.y,this.preRotation=t.angle,this.screenX=t.x,this.screenY=t.y,this.sourceWidth=t.currentFrame.sourceSizeW,this.sourceHeight=t.currentFrame.sourceSizeH,this.width=t.currentFrame.sourceSizeW,this.height=t.currentFrame.sourceSizeH,this.halfWidth=Math.floor(t.currentFrame.sourceSizeW/2),this.halfHeight=Math.floor(t.currentFrame.sourceSizeH/2),this.center=new n.Point(this.x+this.halfWidth,this.y+this.halfHeight),this._sx=t.scale.x,this._sy=t.scale.y,this.velocity=new n.Point,this.acceleration=new n.Point,this.drag=new n.Point,this.gravity=new n.Point,this.bounce=new n.Point,this.maxVelocity=new n.Point(1e4,1e4),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.skipQuadTree=!1,this.quadTreeIDs=[],this.quadTreeIndex=-1,this.allowCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.facing=n.NONE,this.immovable=!1,this.moves=!0,this.rotation=0,this.allowRotation=!0,this.allowGravity=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.hullX=new n.Rectangle,this.hullY=new n.Rectangle,this.embedded=!1,this.collideWorldBounds=!1},n.Physics.Arcade.Body.prototype={updateBounds:function(n,t,i,r){(i!=this._sx||r!=this._sy)&&(this.width=this.sourceWidth*i,this.height=this.sourceHeight*r,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this._sx=i,this._sy=r,this.center.setTo(this.x+this.halfWidth,this.y+this.halfHeight))},preUpdate:function(){this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.embedded=!1,this.screenX=this.sprite.worldTransform[2]-this.sprite.anchor.x*this.width+this.offset.x,this.screenY=this.sprite.worldTransform[5]-this.sprite.anchor.y*this.height+this.offset.y,this.preX=this.sprite.world.x-this.sprite.anchor.x*this.width+this.offset.x,this.preY=this.sprite.world.y-this.sprite.anchor.y*this.height+this.offset.y,this.preRotation=this.sprite.angle,this.x=this.preX,this.y=this.preY,this.rotation=this.preRotation,this.moves&&(this.game.physics.updateMotion(this),this.collideWorldBounds&&this.checkWorldBounds(),this.updateHulls()),this.skipQuadTree==!1&&this.allowCollision.none==!1&&this.sprite.visible&&this.sprite.alive&&(this.quadTreeIDs=[],this.quadTreeIndex=-1,this.game.physics.quadTree.insert(this))},postUpdate:function(){this.deltaX()<0?this.facing=n.LEFT:this.deltaX()>0&&(this.facing=n.RIGHT),this.deltaY()<0?this.facing=n.UP:this.deltaY()>0&&(this.facing=n.DOWN),(this.deltaX()!==0||this.deltaY()!==0)&&(this.sprite.x+=this.deltaX(),this.sprite.y+=this.deltaY(),this.center.setTo(this.x+this.halfWidth,this.y+this.halfHeight)),this.allowRotation&&(this.sprite.angle+=this.deltaZ())},updateHulls:function(){this.hullX.setTo(this.x,this.preY,this.width,this.height),this.hullY.setTo(this.preX,this.y,this.width,this.height)},checkWorldBounds:function(){this.x<this.game.world.bounds.x?(this.x=this.game.world.bounds.x,this.velocity.x*=-this.bounce.x):this.right>this.game.world.bounds.right&&(this.x=this.game.world.bounds.right-this.width,this.velocity.x*=-this.bounce.x),this.y<this.game.world.bounds.y?(this.y=this.game.world.bounds.y,this.velocity.y*=-this.bounce.y):this.bottom>this.game.world.bounds.bottom&&(this.y=this.game.world.bounds.bottom-this.height,this.velocity.y*=-this.bounce.y)},setSize:function(n,t,i,r){i=i||this.offset.x,r=r||this.offset.y,this.sourceWidth=n,this.sourceHeight=t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(i,r),this.center.setTo(this.x+this.halfWidth,this.y+this.halfHeight)},reset:function(){this.velocity.setTo(0,0),this.acceleration.setTo(0,0),this.angularVelocity=0,this.angularAcceleration=0,this.preX=this.sprite.world.x-this.sprite.anchor.x*this.width+this.offset.x,this.preY=this.sprite.world.y-this.sprite.anchor.y*this.height+this.offset.y,this.preRotation=this.sprite.angle,this.x=this.preX,this.y=this.preY,this.rotation=this.preRotation,this.center.setTo(this.x+this.halfWidth,this.y+this.halfHeight)},deltaAbsX:function(){return this.deltaX()>0?this.deltaX():-this.deltaX()},deltaAbsY:function(){return this.deltaY()>0?this.deltaY():-this.deltaY()},deltaX:function(){return this.x-this.preX},deltaY:function(){return this.y-this.preY},deltaZ:function(){return this.rotation-this.preRotation}},Object.defineProperty(n.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.y+this.height},set:function(n){this.height=n<=this.y?0:this.y-n}}),Object.defineProperty(n.Physics.Arcade.Body.prototype,"right",{get:function(){return this.x+this.width},set:function(n){this.width=n<=this.x?0:this.x+n}}),n.Particles=function(){this.emitters={},this.ID=0},n.Particles.prototype={add:function(n){return this.emitters[n.name]=n,n},remove:function(n){delete this.emitters[n.name]},update:function(){for(var n in this.emitters)this.emitters[n].exists&&this.emitters[n].update()}},n.Particles.Arcade={},n.Particles.Arcade.Emitter=function(t,i,r,u){this.maxParticles=u||50,n.Group.call(this,t),this.name="emitter"+this.game.particles.ID++,this.type=n.EMITTER,this.x=0,this.y=0,this.width=1,this.height=1,this.minParticleSpeed=new n.Point(-100,-100),this.maxParticleSpeed=new n.Point(100,100),this.minParticleScale=1,this.maxParticleScale=1,this.minRotation=-360,this.maxRotation=360,this.gravity=2,this.particleClass=null,this.particleDrag=new n.Point,this.angularDrag=0,this.frequency=100,this.lifespan=2e3,this.bounce=new n.Point,this._quantity=0,this._timer=0,this._counter=0,this._explode=!0,this.on=!1,this.exists=!0,this.emitX=i,this.emitY=r},n.Particles.Arcade.Emitter.prototype=Object.create(n.Group.prototype),n.Particles.Arcade.Emitter.prototype.constructor=n.Particles.Arcade.Emitter,n.Particles.Arcade.Emitter.prototype.update=function(){if(this.on)if(this._explode){this._counter=0;do this.emitParticle(),this._counter++;while(this._counter<this._quantity);this.on=!1}else this.game.time.now>=this._timer&&(this.emitParticle(),this._counter++,this._quantity>0&&this._counter>=this._quantity&&(this.on=!1),this._timer=this.game.time.now+this.frequency)},n.Particles.Arcade.Emitter.prototype.makeParticles=function(t,i,r,u,f){typeof i=="undefined"&&(i=0),r=r||this.maxParticles,u=u||0,typeof f=="undefined"&&(f=!1);for(var e,o=0,s=t,h=0;o<r;)this.particleClass==null&&(typeof t=="object"&&(s=this.game.rnd.pick(t)),typeof i=="object"&&(h=this.game.rnd.pick(i)),e=new n.Sprite(this.game,0,0,s,h)),u>0?(e.body.allowCollision.any=!0,e.body.allowCollision.none=!1):e.body.allowCollision.none=!0,e.body.collideWorldBounds=f,e.exists=!1,e.visible=!1,e.anchor.setTo(.5,.5),this.add(e),o++;return this},n.Particles.Arcade.Emitter.prototype.kill=function(){this.on=!1,this.alive=!1,this.exists=!1},n.Particles.Arcade.Emitter.prototype.revive=function(){this.alive=!0,this.exists=!0},n.Particles.Arcade.Emitter.prototype.start=function(n,t,i,r){typeof n!="boolean"&&(n=!0),t=t||0,i=i||250,r=r||0,this.revive(),this.visible=!0,this.on=!0,this._explode=n,this.lifespan=t,this.frequency=i,n?this._quantity=r:this._quantity+=r,this._counter=0,this._timer=this.game.time.now+i},n.Particles.Arcade.Emitter.prototype.emitParticle=function(){var n=this.getFirstExists(!1),t;n!=null&&(this.width>1||this.height>1?n.reset(this.game.rnd.integerInRange(this.left,this.right),this.game.rnd.integerInRange(this.top,this.bottom)):n.reset(this.emitX,this.emitY),n.lifespan=this.lifespan,n.body.bounce.setTo(this.bounce.x,this.bounce.y),n.body.velocity.x=this.minParticleSpeed.x!=this.maxParticleSpeed.x?this.game.rnd.integerInRange(this.minParticleSpeed.x,this.maxParticleSpeed.x):this.minParticleSpeed.x,n.body.velocity.y=this.minParticleSpeed.y!=this.maxParticleSpeed.y?this.game.rnd.integerInRange(this.minParticleSpeed.y,this.maxParticleSpeed.y):this.minParticleSpeed.y,n.body.gravity.y=this.gravity,n.body.angularVelocity=this.minRotation!=this.maxRotation?this.game.rnd.integerInRange(this.minRotation,this.maxRotation):this.minRotation,(this.minParticleScale!==1||this.maxParticleScale!==1)&&(t=this.game.rnd.realInRange(this.minParticleScale,this.maxParticleScale),n.scale.setTo(t,t)),n.body.drag.x=this.particleDrag.x,n.body.drag.y=this.particleDrag.y,n.body.angularDrag=this.angularDrag)},n.Particles.Arcade.Emitter.prototype.setSize=function(n,t){this.width=n,this.height=t},n.Particles.Arcade.Emitter.prototype.setXSpeed=function(n,t){n=n||0,t=t||0,this.minParticleSpeed.x=n,this.maxParticleSpeed.x=t},n.Particles.Arcade.Emitter.prototype.setYSpeed=function(n,t){n=n||0,t=t||0,this.minParticleSpeed.y=n,this.maxParticleSpeed.y=t},n.Particles.Arcade.Emitter.prototype.setRotation=function(n,t){n=n||0,t=t||0,this.minRotation=n,this.maxRotation=t},n.Particles.Arcade.Emitter.prototype.at=function(n){this.emitX=n.center.x,this.emitY=n.center.y},Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"alpha",{get:function(){return this._container.alpha},set:function(n){this._container.alpha=n}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"visible",{get:function(){return this._container.visible},set:function(n){this._container.visible=n}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(n){this.emitX=n}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(n){this.emitY=n}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"left",{get:function(){return Math.floor(this.x-this.width/2)}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.width/2)}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.height/2)}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.height/2)}}),n.Tile=function(n,t,i,r,u,f){this.tileset=n,this.index=t,this.width=u,this.height=f,this.x=i,this.y=r,this.mass=1,this.collideNone=!0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.separateX=!0,this.separateY=!0,this.collisionCallback=null,this.collisionCallbackContext=this},n.Tile.prototype={setCollisionCallback:function(n,t){this.collisionCallbackContext=t,this.collisionCallback=n},destroy:function(){this.tileset=null},setCollision:function(n,t,i,r){this.collideLeft=n,this.collideRight=t,this.collideUp=i,this.collideDown=r,this.collideNone=n||t||i||r?!1:!0},resetCollision:function(){this.collideNone=!0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1}},Object.defineProperty(n.Tile.prototype,"bottom",{get:function(){return this.y+this.height}}),Object.defineProperty(n.Tile.prototype,"right",{get:function(){return this.x+this.width}}),n.Tilemap=function(n,t){this.game=n,this.layers,typeof t=="string"?(this.key=t,this.layers=n.cache.getTilemapData(t).layers,this.calculateIndexes()):this.layers=[],this.currentLayer=0,this.debugMap=[],this.dirty=!1,this._results=[],this._tempA=0,this._tempB=0},n.Tilemap.CSV=0,n.Tilemap.TILED_JSON=1,n.Tilemap.prototype={create:function(t,i,r){for(var e=[],f,u=0;u<r;u++)for(e[u]=[],f=0;f<i;f++)e[u][f]=0;this.currentLayer=this.layers.push({name:t,width:i,height:r,alpha:1,visible:!0,tileMargin:0,tileSpacing:0,format:n.Tilemap.CSV,data:e,indexes:[]}),this.dirty=!0},calculateIndexes:function(){for(var t,i,r,n=0;n<this.layers.length;n++)for(this.layers[n].indexes=[],t=0;t<this.layers[n].height;t++)for(i=0;i<this.layers[n].width;i++)r=this.layers[n].data[t][i],this.layers[n].indexes.indexOf(r)===-1&&this.layers[n].indexes.push(r)},setLayer:function(n){this.layers[n]&&(this.currentLayer=n)},putTile:function(n,t,i,r){typeof r=="undefined"&&(r=this.currentLayer),t>=0&&t<this.layers[this.currentLayer].width&&i>=0&&i<this.layers[this.currentLayer].height&&(this.layers[this.currentLayer].data[i][t]=n),this.dirty=!0},getTile:function(n,t,i){return typeof i=="undefined"&&(i=this.currentLayer),n>=0&&n<this.layers[this.currentLayer].width&&t>=0&&t<this.layers[this.currentLayer].height?this.layers[this.currentLayer].data[t][n]:void 0},getTileWorldXY:function(n,t,i,r,u){return typeof u=="undefined"&&(u=this.currentLayer),n=this.game.math.snapToFloor(n,i)/i,t=this.game.math.snapToFloor(t,r)/r,n>=0&&n<this.layers[this.currentLayer].width&&t>=0&&t<this.layers[this.currentLayer].height?this.layers[this.currentLayer].data[t][n]:void 0},putTileWorldXY:function(n,t,i,r,u){t=this.game.math.snapToFloor(t,r)/r,i=this.game.math.snapToFloor(i,u)/u,t>=0&&t<this.layers[this.currentLayer].width&&i>=0&&i<this.layers[this.currentLayer].height&&(this.layers[this.currentLayer].data[i][t]=n),this.dirty=!0},copy:function(n,t,i,r,u){var f,e;if(typeof u=="undefined"&&(u=this.currentLayer),!this.layers[u]){this._results.length=0;return}for(typeof n=="undefined"&&(n=0),typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=this.layers[u].width),typeof r=="undefined"&&(r=this.layers[u].height),n<0&&(n=0),t<0&&(t=0),i>this.layers[u].width&&(i=this.layers[u].width),r>this.layers[u].height&&(r=this.layers[u].height),this._results.length=0,this._results.push({x:n,y:t,width:i,height:r,layer:u}),f=t;f<t+r;f++)for(e=n;e<n+i;e++)this._results.push({x:e,y:f,index:this.layers[u].data[f][e]});return this._results},paste:function(n,t,i,r){var f,e,u;if(typeof n=="undefined"&&(n=0),typeof t=="undefined"&&(t=0),typeof r=="undefined"&&(r=this.currentLayer),i&&!(i.length<2)){for(f=i[1].x-n,e=i[1].y-t,u=1;u<i.length;u++)this.layers[r].data[e+i[u].y][f+i[u].x]=i[u].index;this.dirty=!0}},swap:function(n,t,i,r,u,f,e){(this.copy(i,r,u,f,e),this._results.length<2)||(this._tempA=n,this._tempB=t,this._results.forEach(this.swapHandler,this),this.paste(i,r,this._results))},swapHandler:function(n,t){n.index===this._tempA?this._results[t].index=this._tempB:n.index===this._tempB&&(this._results[t].index=this._tempA)},forEach:function(n,t,i,r,u,f,e){(this.copy(i,r,u,f,e),this._results.length<2)||(this._results.forEach(n,t),this.paste(i,r,this._results))},replace:function(n,t,i,r,u,f,e){if(this.copy(i,r,u,f,e),!(this._results.length<2)){for(var o=1;o<this._results.length;o++)this._results[o].index===n&&(this._results[o].index=t);this.paste(i,r,this._results)}},random:function(n,t,i,r,u){var f,e,s,o;if(typeof u=="undefined"&&(u=this.currentLayer),this.copy(n,t,i,r,u),!(this._results.length<2)){for(f=[],e=1;e<this._results.length;e++)s=this._results[e].index,f.indexOf(s)===-1&&f.push(s);for(o=1;o<this._results.length;o++)this._results[o].index=this.game.rnd.pick(f);this.paste(n,t,this._results)}},shuffle:function(t,i,r,u,f){if(typeof f=="undefined"&&(f=this.currentLayer),this.copy(t,i,r,u,f),!(this._results.length<2)){var e=this._results.shift();n.Utils.shuffle(this._results),this._results.unshift(e),this.paste(t,i,this._results)}},fill:function(n,t,i,r,u,f){if(this.copy(t,i,r,u,f),!(this._results.length<2)){for(var e=1;e<this._results.length;e++)this._results[e].index=n;this.paste(t,i,this._results)}},removeAllLayers:function(){this.layers.length=0,this.currentLayer=0},dump:function(){for(var r="",i=[""],t,n=0;n<this.layers[this.currentLayer].height;n++){for(t=0;t<this.layers[this.currentLayer].width;t++)r+="%c  ",this.layers[this.currentLayer].data[n][t]>1?this.debugMap[this.layers[this.currentLayer].data[n][t]]?i.push("background: "+this.debugMap[this.layers[this.currentLayer].data[n][t]]):i.push("background: #ffffff"):i.push("background: rgb(0, 0, 0)");r+="\n"}i[0]=r,console.log.apply(console,i)},destroy:function(){this.removeAllLayers(),this.game=null}},n.TilemapLayer=function(i,r,u,f,e,o,s,h){this.game=i,this.canvas=n.Canvas.create(f,e),this.context=this.canvas.getContext("2d"),this.baseTexture=new t.BaseTexture(this.canvas),this.texture=new t.Texture(this.baseTexture),this.textureFrame=new n.Frame(0,0,0,f,e,"tilemaplayer",i.rnd.uuid()),n.Sprite.call(this,this.game,r,u,this.texture,this.textureFrame),this.type=n.TILEMAPLAYER,this.fixedToCamera=!0,this.tileset=null,this.tileWidth=0,this.tileHeight=0,this.tileMargin=0,this.tileSpacing=0,this.widthInPixels=0,this.heightInPixels=0,this.renderWidth=f,this.renderHeight=e,this._ga=1,this._dx=0,this._dy=0,this._dw=0,this._dh=0,this._tx=0,this._ty=0,this._results=[],this._tw=0,this._th=0,this._tl=0,this._maxX=0,this._maxY=0,this._startX=0,this._startY=0,this.tilemap=null,this.layer=null,this.index=0,this._x=0,this._y=0,this._prevX=0,this._prevY=0,this.dirty=!0,(o instanceof n.Tileset||typeof o=="string")&&this.updateTileset(o),s instanceof n.Tilemap&&this.updateMapData(s,h)},n.TilemapLayer.prototype=Object.create(n.Sprite.prototype),n.TilemapLayer.prototype=n.Utils.extend(!0,n.TilemapLayer.prototype,n.Sprite.prototype,t.Sprite.prototype),n.TilemapLayer.prototype.constructor=n.TilemapLayer,n.TilemapLayer.prototype.update=function(){this.scrollX=this.game.camera.x,this.scrollY=this.game.camera.y,this.render()},n.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.widthInPixels,this.heightInPixels)},n.TilemapLayer.prototype.updateTileset=function(t){if(t instanceof n.Tileset)this.tileset=t;else if(typeof t=="string")this.tileset=this.game.cache.getTileset("tiles");else return;this.tileWidth=this.tileset.tileWidth,this.tileHeight=this.tileset.tileHeight,this.tileMargin=this.tileset.tileMargin,this.tileSpacing=this.tileset.tileSpacing,this.updateMax()},n.TilemapLayer.prototype.updateMapData=function(t,i){typeof i=="undefined"&&(i=0),t instanceof n.Tilemap&&(this.tilemap=t,this.layer=this.tilemap.layers[i],this.index=i,this.updateMax(),this.tilemap.dirty=!0)},n.TilemapLayer.prototype.getTileX=function(n){var t=this.tileWidth*this.scale.x;return this.game.math.snapToFloor(n,t)/t},n.TilemapLayer.prototype.getTileY=function(n){var t=this.tileHeight*this.scale.y;return this.game.math.snapToFloor(n,t)/t},n.TilemapLayer.prototype.getTileXY=function(n,t,i){return i.x=this.getTileX(n),i.y=this.getTileY(t),i},n.TilemapLayer.prototype.getTiles=function(n,t,i,r,u){var o,s,f,e;if(this.tilemap!==null){typeof u=="undefined"&&(u=!1),n<0&&(n=0),t<0&&(t=0),i>this.widthInPixels&&(i=this.widthInPixels),r>this.heightInPixels&&(r=this.heightInPixels),o=this.tileWidth*this.scale.x,s=this.tileHeight*this.scale.y,this._tx=this.game.math.snapToFloor(n,o)/o,this._ty=this.game.math.snapToFloor(t,s)/s,this._tw=(this.game.math.snapToCeil(i,o)+o)/o,this._th=(this.game.math.snapToCeil(r,s)+s)/s,this._results=[];var a=0,h=null,c=0,l=0;for(f=this._ty;f<this._ty+this._th;f++)for(e=this._tx;e<this._tx+this._tw;e++)this.layer.data[f]&&this.layer.data[f][e]&&(a=this.layer.data[f][e]-1,h=this.tileset.getTile(a),c=h.width*this.scale.x,l=h.height*this.scale.y,(u==!1||u&&h.collideNone==!1)&&this._results.push({x:e*c,right:e*c+c,y:f*l,bottom:f*l+l,width:c,height:l,tx:e,ty:f,tile:h}));return this._results}},n.TilemapLayer.prototype.updateMax=function(){this._maxX=this.game.math.ceil(this.canvas.width/this.tileWidth)+1,this._maxY=this.game.math.ceil(this.canvas.height/this.tileHeight)+1,this.layer&&(this._maxX>this.layer.width&&(this._maxX=this.layer.width),this._maxY>this.layer.height&&(this._maxY=this.layer.height),this.widthInPixels=this.layer.width*this.tileWidth,this.heightInPixels=this.layer.height*this.tileHeight),this.dirty=!0},n.TilemapLayer.prototype.render=function(){var i,r,u;if(this.tilemap&&this.tilemap.dirty&&(this.dirty=!0),this.dirty&&this.tileset&&this.tilemap&&this.visible){for(this._prevX=this._dx,this._prevY=this._dy,this._dx=-(this._x-this._startX*this.tileWidth),this._dy=-(this._y-this._startY*this.tileHeight),this._tx=this._dx,this._ty=this._dy,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),i=this._startY;i<this._startY+this._maxY;i++){for(this._column=this.layer.data[i],r=this._startX;r<this._startX+this._maxX;r++)u=this.tileset.tiles[this._column[r]-1],u&&this.context.drawImage(this.tileset.image,u.x,u.y,this.tileWidth,this.tileHeight,Math.floor(this._tx),Math.floor(this._ty),this.tileWidth,this.tileHeight),this._tx+=this.tileWidth;this._tx=this._dx,this._ty+=this.tileHeight}return this.game.renderType==n.WEBGL&&t.texturesToUpdate.push(this.baseTexture),this.dirty=!1,this.tilemap.dirty&&(this.tilemap.dirty=!1),!0}},n.TilemapLayer.prototype.deltaAbsX=function(){return this.deltaX()>0?this.deltaX():-this.deltaX()},n.TilemapLayer.prototype.deltaAbsY=function(){return this.deltaY()>0?this.deltaY():-this.deltaY()},n.TilemapLayer.prototype.deltaX=function(){return this._dx-this._prevX},n.TilemapLayer.prototype.deltaY=function(){return this._dy-this._prevY},Object.defineProperty(n.TilemapLayer.prototype,"scrollX",{get:function(){return this._x},set:function(n){n!==this._x&&n>=0&&this.layer&&(this._x=n,this._x>this.widthInPixels-this.renderWidth&&(this._x=this.widthInPixels-this.renderWidth),this._startX=this.game.math.floor(this._x/this.tileWidth),this._startX<0&&(this._startX=0),this._startX+this._maxX>this.layer.width&&(this._startX=this.layer.width-this._maxX),this.dirty=!0)}}),Object.defineProperty(n.TilemapLayer.prototype,"scrollY",{get:function(){return this._y},set:function(n){n!==this._y&&n>=0&&this.layer&&(this._y=n,this._y>this.heightInPixels-this.renderHeight&&(this._y=this.heightInPixels-this.renderHeight),this._startY=this.game.math.floor(this._y/this.tileHeight),this._startY<0&&(this._startY=0),this._startY+this._maxY>this.layer.height&&(this._startY=this.layer.height-this._maxY),this.dirty=!0)}}),n.TilemapParser={tileset:function(t,i,r,u,f,e,o){var c=t.cache.getTilesetImage(i),s,h,a;if(c==null)return null;s=c.width,h=c.height,r<=0&&(r=Math.floor(-s/Math.min(-1,r))),u<=0&&(u=Math.floor(-h/Math.min(-1,u)));var w=Math.round(s/r),b=Math.round(h/u),v=w*b;if(f!==-1&&(v=f),s==0||h==0||s<r||h<u||v===0)return console.warn("Phaser.TilemapParser.tileSet: width/height zero or width/height < given tileWidth/tileHeight"),null;var l=e,p=e,y=new n.Tileset(c,i,r,u,e,o);for(a=0;a<v;a++)y.addTile(new n.Tile(y,a,l,p,r,u)),l+=r+o,l===s&&(l=e,p+=u+o);return y},parse:function(t,i,r){return r===n.Tilemap.CSV?this.parseCSV(i):r===n.Tilemap.TILED_JSON?this.parseTiledJSON(i):void 0},parseCSV:function(n){var t,r,i;n=n.trim();var u=[],f=n.split("\n"),o=f.length,e=0;for(t=0;t<f.length;t++){for(u[t]=[],r=f[t].split(","),i=0;i<r.length;i++)u[t][i]=parseInt(r[i]);e==0&&(e=r.length)}return[{name:"csv",width:e,height:o,alpha:1,visible:!0,indexes:[],tileMargin:0,tileSpacing:0,data:u}]},parseTiledJSON:function(n){for(var f=[],r,t=0;t<n.layers.length;t++)if(n.layers[t].data){var e={name:n.layers[t].name,width:n.layers[t].width,height:n.layers[t].height,alpha:n.layers[t].opacity,visible:n.layers[t].visible,indexes:[],tileMargin:n.tilesets[0].margin,tileSpacing:n.tilesets[0].spacing},o=[],i=0,u;for(r=0;r<n.layers[t].data.length;r++)i==0&&(u=[]),u.push(n.layers[t].data[r]),i++,i==n.layers[t].width&&(o.push(u),i=0);e.data=o,f.push(e)}return f}},n.Tileset=function(n,t,i,r,u,f){typeof u=="undefined"&&(u=0),typeof f=="undefined"&&(f=0),this.key=t,this.image=n,this.tileWidth=i,this.tileHeight=r,this.margin=u,this.spacing=f,this.tiles=[]},n.Tileset.prototype={addTile:function(n){return this.tiles.push(n),n},getTile:function(n){return this.tiles[n]?this.tiles[n]:null},setSpacing:function(n,t){this.tileMargin=n,this.tileSpacing=t},canCollide:function(n){return this.tiles[n]?this.tiles[n].collideNone:null},checkTileIndex:function(n){return this.tiles[n]},setCollisionRange:function(n,t,i,r,u,f){if(this.tiles[n]&&this.tiles[t]&&n<t)for(var e=n;e<=t;e++)this.tiles[e].setCollision(i,r,u,f)},setCollision:function(n,t,i,r,u){this.tiles[n]&&this.tiles[n].setCollision(t,i,r,u)}},Object.defineProperty(n.Tileset.prototype,"total",{get:function(){return this.tiles.length}}),t.CanvasRenderer.prototype.renderDisplayObject=function(n){var i,r=this.context,e,u,o,f;r.globalCompositeOperation="source-over",e=n.last._iNext,n=n.first;do{if(i=n.worldTransform,!n.visible){n=n.last._iNext;continue}if(!n.renderable||n.alpha==0){n=n._iNext;continue}n instanceof t.Sprite?(u=n.texture.frame,u&&(r.globalAlpha=n.worldAlpha,n.texture.trimmed?r.setTransform(i[0],i[3],i[1],i[4],i[2]+n.texture.trim.x,i[5]+n.texture.trim.y):r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),r.drawImage(n.texture.baseTexture.source,u.x,u.y,u.width,u.height,n.anchor.x*-u.width,n.anchor.y*-u.height,u.width,u.height))):n instanceof t.Strip?(r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),this.renderStrip(n)):n instanceof t.TilingSprite?(r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),this.renderTilingSprite(n)):n instanceof t.CustomRenderable?n.renderCanvas(this):n instanceof t.Graphics?(r.setTransform(i[0],i[3],i[1],i[4],i[2],i[5]),t.CanvasGraphics.renderGraphics(n,r)):n instanceof t.FilterBlock&&(n.open?(r.save(),o=n.mask.alpha,f=n.mask.worldTransform,r.setTransform(f[0],f[3],f[1],f[4],f[2],f[5]),n.mask.worldAlpha=.5,r.worldAlpha=0,t.CanvasGraphics.renderGraphicsMask(n.mask,r),r.clip(),n.mask.worldAlpha=o):r.restore()),n=n._iNext}while(n!=e)},t.WebGLBatch.prototype.update=function(){for(var rt=this.gl,u,d,g,nt,tt,o,s,h,c,n,l,a,v,y,f,e,w=0,i=this.head,p;i;){if(i.vcount===t.visibleCount){if(d=i.texture.frame.width,g=i.texture.frame.height,nt=i.anchor.x,tt=i.anchor.y,o=d*(1-nt),s=d*-nt,h=g*(1-tt),c=g*-tt,n=w*8,u=i.worldTransform,l=u[0],a=u[3],v=u[1],y=u[4],f=u[2],e=u[5],i.texture.trimmed&&(f+=i.texture.trim.x,e+=i.texture.trim.y),this.verticies[n+0]=l*s+v*c+f,this.verticies[n+1]=y*c+a*s+e,this.verticies[n+2]=l*o+v*c+f,this.verticies[n+3]=y*c+a*o+e,this.verticies[n+4]=l*o+v*h+f,this.verticies[n+5]=y*h+a*o+e,this.verticies[n+6]=l*s+v*h+f,this.verticies[n+7]=y*h+a*s+e,i.updateFrame||i.texture.updateFrame){this.dirtyUVS=!0;var it=i.texture,r=it.frame,b=it.baseTexture.width,k=it.baseTexture.height;this.uvs[n+0]=r.x/b,this.uvs[n+1]=r.y/k,this.uvs[n+2]=(r.x+r.width)/b,this.uvs[n+3]=r.y/k,this.uvs[n+4]=(r.x+r.width)/b,this.uvs[n+5]=(r.y+r.height)/k,this.uvs[n+6]=r.x/b,this.uvs[n+7]=(r.y+r.height)/k,i.updateFrame=!1}i.cacheAlpha!=i.worldAlpha&&(i.cacheAlpha=i.worldAlpha,p=w*4,this.colors[p]=this.colors[p+1]=this.colors[p+2]=this.colors[p+3]=i.worldAlpha,this.dirtyColors=!0)}else n=w*8,this.verticies[n+0]=0,this.verticies[n+1]=0,this.verticies[n+2]=0,this.verticies[n+3]=0,this.verticies[n+4]=0,this.verticies[n+5]=0,this.verticies[n+6]=0,this.verticies[n+7]=0;w++,i=i.__next}},n});
//# sourceMappingURL=phaser.min.js.map